{"version":3,"sources":["models/AttributeType.js","models/types/index.js","helpers.js","models/Edge.js","components/util.js","models/NodeBase.js","utils/typeUtils.js","models/nodes/ToneNode.js","performance/index.js","models/nodes/Neural.js","models/nodes/SoundFont.js","models/nodes/MapperNode.js","models/nodes/IntervalNode.js","threeUtil/Stats.js","threeUtil/Base.js","models/nodes/ThreeNode.js","models/nodes/Geometries.js","models/nodes/MaterialNode.js","models/nodes/Logic.js","models/nodes/MeshNode.js","models/nodes/Midi.js","models/nodes/UtilNodes.js","models/nodes/Vector2D.js","models/nodes/Vector3D.js","models/nodes/Dom.js","models/nodes/String.js","models/nodes/Music.js","models/nodes/MathNodes.js","models/nodes/GPGPU.js","models/nodes/Code.js","models/nodes/primitives.js","models/nodes/index.js","boot.js","components/NodeInputListItem.js","components/NodeInputList.js","components/NodeOutputListItem.js","components/NodeOutputList.js","utils/vector.js","components/Node.js","models/Graph.js","components/SVGComponent.js","components/Spline.js","components/AllEdges.js","components/NodeGraph.js","vendor/JsonTree/js/helpers/util.js","vendor/JsonTree/js/themes/base16/rjv-themes.js","vendor/JsonTree/js/themes/styleConstants.js","vendor/JsonTree/js/themes/getStyle.js","vendor/JsonTree/js/components/DataTypes/DataTypeLabel.js","vendor/JsonTree/js/components/DataTypes/Boolean.js","vendor/JsonTree/js/components/DataTypes/Date.js","vendor/JsonTree/js/components/DataTypes/Float.js","vendor/JsonTree/js/helpers/dispatcher.js","vendor/JsonTree/js/stores/ObjectAttributes.js","vendor/JsonTree/js/components/DataTypes/Function.js","vendor/JsonTree/js/components/DataTypes/Nan.js","vendor/JsonTree/js/components/DataTypes/Null.js","vendor/JsonTree/js/components/DataTypes/Integer.js","vendor/JsonTree/js/components/DataTypes/Regexp.js","vendor/JsonTree/js/components/DataTypes/String.js","vendor/JsonTree/js/components/DataTypes/Undefined.js","vendor/JsonTree/js/helpers/parseInput.js","vendor/JsonTree/js/helpers/stringifyVariable.js","vendor/JsonTree/js/components/icons.js","vendor/JsonTree/js/components/VariableEditor.js","vendor/JsonTree/js/components/CopyToClipboard.js","vendor/JsonTree/js/components/VariableMeta.js","vendor/JsonTree/js/components/ObjectName.js","vendor/JsonTree/js/components/ToggleIcons.js","vendor/JsonTree/js/components/ArrayGroup.js","vendor/JsonTree/js/components/DataTypes/Object.js","vendor/JsonTree/js/components/JsonViewer.js","vendor/JsonTree/js/components/ObjectKeyModal/ObjectKeyModal.js","vendor/JsonTree/js/components/ObjectKeyModal/AddKeyRequest.js","vendor/JsonTree/js/components/ValidationFailure.js","vendor/JsonTree/js/index.js","components/AttributePane/InfoPopup.js","components/AttributePane/index.js","components/SearchBar.js","components/FileUpload.js","components/SaveDialog.js","components/NodeSearcher.js","components/ExampleSearch.js","docgen.js","components/Toolbar.js","components/dialogs/LoadPrompt.js","components/Zoomer.js","App.js","redux/ducks/graph.js","utils/array.js","redux/rootReducer.js","redux/rootStore.js","serviceWorker.js","index.js"],"names":["defaultMetadata","required","TypeImpl","data","desc","d","description","aliased","name","typeDescription","meta","metadata","isA","t","id","isPrimitive","type","isUndescribedPrimitive","isComplex","hasHelpInfo","this","schema","defaultValue","parse","serialize","TypeBuilder","v","validate","Error","typeRegistry","attr","parser","serializer","val","des","Symbol","registerType","window","Types","primitiveSerializer","number","withType","havingDefault","withParser","parseInt","withSerializer","build","JSON","stringify","String","a","Boolean","Date","toISOString","undefined","withSchema","x","y","z","uuid","replace","c","r","Math","random","toString","Edge","from","to","fromPort","toPort","_notifyCount","notifyListener","outDataFor","inDataFor","change","notify","fromId","toId","j","nodes","find","n","outOffset","index","$eOutL","$eTop","$eHeight","$eInL","signatureFor","clazz","maxLen","style","argT","inKeys","join","returnT","outKeys","length","substring","color","NodeBase","attrs","props","nodeId","title","inputs","outputs","outputCache","live","listeners","_unPushed","_process","keys","force","process","forward","omitBy","k","isEqual","onAddToGraph","willBecomeLive","willBeRemoved","beforeConnectOut","edge","afterConnectOut","beforeConnectIn","afterConnectIn","beforeDisconnectOut","afterDisconnectOut","beforeDisconnectIn","afterDisconnectIn","requireForOutput","addInput","input","push","initialValue","_onInputChange","_notifyLive","sKeys","constructor","iKeys","map","i","concat","every","includes","forAllConnectedInputs","handler","uniq","domId","addOutput","out","removeInput","onRemove","filter","firstInput","forKey","removeOutput","output","oldProps","Object","forEach","_force","willReceiveProps","notifyOutputs","onInputChange","registerListener","listener","key","removeListener","newProps","prevProps","manual","ofKeyChanges","asList","Array","isArray","changes","pick","e","notifyAllOutputs","inKeyAt","outKeyAt","connectedInputKeys","connectedOutputKeys","defName","nameFrom","value","state","hasVal","changeables","p","changeableProps","s","changeableState","o","otherChangeables","outs","displayableOutputs","Inputs","Internals","Other","Outputs","get","stateSchema","onChange","inputSchema","cloneDeep","pushToState","stateKey","exclude","setPath","partial","allKeys","accept","set","signature","stateS","fromPairs","serialized","console","error","getRegistryName","initializeState","defaultState","defaultProps","displayName","startCase","registryName","node","serial","load","_inKeys","_inKeyIdxMap","_outKeys","_outKeyIdxMap","_displayInKeys","shortNames","_displayOutKeys","json","NodeRegistry","arrayOf","any","Piano","require","URL_BASE","TT","AudioNode","object","Config","Synth","Panner","Gain","FeedbackDelay","Note","string","Call","ContextDestinationNode","Tone","context","destination","ConnectNode","logConnect","connect","disconnect","AudioMasterNode","_connectedTo","toMaster","ToContextDestinationNode","PannerNode","panner","pan","VolumeNode","volume","Volume","CompressorNode","compressor","Compressor","threshold","ratio","ReverbNode","reverb","Freeverb","dampening","time","roomSize","FeedbackDelayNode","feedbackDelay","delayTime","feedback","AudioDelayNode","delay","createDelay","AudioGainNode","gain","createGain","AttackReleaseNode","synth","note","duration","triggerAttackRelease","Draw","schedule","triggerAttack","draw","call","PlayerNode","_loaded","_player","Player","_makePlayer","url","startsWith","_checkStarted","autostart","_setPlayerAttrs","start","player","loop","boolean","SetNoteNode","setNote","voices","ArpeggiateNode","_out","pattern","Pattern","notes","Transport","on","_manageLoop","values","interval","humanize","probability","TimeLoopNode","count","Loop","_recreateLoop","dispose","playbackRate","iterations","Infinity","mute","SynthNode","defaultSynth","_recreateSynth","oscillator","envelope","fwdSignals","defaultEnv","DuoSynthNode","attack","release","releaseCurve","filterEnvelope","baseFrequency","octaves","decay","synthOpts","harmonicity","voice0","voice1","vibratoRate","vibratoAmount","DuoSynth","frequency","PianoNode","loaded","piano","velocities","then","TransportTimeNode","_notifyOut","setTimeout","bpm","StartTransportNode","transport","_stopTime","stop","f","fromName","__proto__","toName","log","DENSITY_BIN_RANGES","MIDI_EVENT_ON","MIDI_EVENT_OFF","EVENT_RANGES","EVENT_SIZE","eventOffset","eventRange","minValue","calculateEventSize","pentatonic","Performance","velocityMapListener","midiListener","toneListener","activeVelocities","Map","activeNotes","forgetBias","tf","pitchHistArray","noteDensityBucket","stepsPerSecond","currentTime","startTime","currentVelocity","currentLoopId","lastSample","initialized","modelReady","stopped","fetch","response","manifest","loadWeights","vars","lstmKernel1","lstmBias1","lstmKernel2","lstmBias2","lstmKernel3","lstmBias3","fcB","fcW","resetRnn","resetRnnRepeatedly","refreshConditioning","setTempo","sps","cleanup","intervalId","clearTimeout","generationInterval","noteDensityEncoding","as1D","pitchHistogram","buffer","pitchHistogramTotal","reduce","prev","toTensor","shape","h","now","performance","generateStep","getConditioning","conditioning","getOutputs","lstm1","lstm2","lstm3","innerOuts","eventInput","toFloat","as2D","logits","matMul","add","sampledOutput","asScalar","_c","_h","loopId","playOutput","dataSync","delta","max","offset","eventType","maxValue","noteNum","floor","Frequency","activeNoteEndTimeSec","timeSec","delete","ceil","HistType","ToneData","MidiData","PerformanceRNNNode","started","_map","_midiMap","action","normalizedVelocity","toneOut","_getSynths","play","midiData","midiOut","_getMidiDevices","device","send","compact","_startModel","_compareHistograms","hist","other","_histForPerformance","split","density","scale","toneData","velocity","keyUp","toMidi","warn","keyDown","triggerRelease","ToneTypes","SoundFont","SoundFontNode","_options","sustain","_setFont","instrument","inst","opts","SoundFontPlayerNode","_playMap","listening","_playToneData","sf","freq","toNote","_playMidiData","midi","_time","event","_connectMidiIn","midiDevice","soundFont","listenToMidi","NTypes","MapperNode","IntervalNode","_clearSubscription","subscriptionId","clearInterval","_resetCount","_startInterval","setInterval","Stats","mode","container","document","createElement","addPanel","panel","appendChild","dom","showPanel","children","display","cssText","addEventListener","preventDefault","beginTime","prevTime","frames","fpsPanel","Panel","msPanel","self","memory","memPanel","REVISION","begin","end","update","usedJSHeapSize","jsHeapSizeLimit","domElement","setMode","fg","bg","min","round","PR","devicePixelRatio","WIDTH","HEIGHT","TEXT_X","TEXT_Y","GRAPH_X","GRAPH_Y","GRAPH_WIDTH","GRAPH_HEIGHT","canvas","width","height","getContext","font","textBaseline","fillStyle","fillRect","fillText","globalAlpha","drawImage","uniforms","u_resolution","Vector2","u_mouse","u_time","Base","showStats","afterLoad","orthoCam","OrthographicCamera","innerWidth","innerHeight","reset","fog","scene","Scene","body","renderer","removeChild","removeEventListener","resize","composer","EffectComposer","_makeRenderer","stencilBuffer","depthTexture","visibility","renderPass","RenderPass","camera","addPass","initialise","setPixelRatio","aspect","updateProjectionMatrix","_listenForWindowChanges","_startRendering","startRaw","OrbitControls","animationId","clock","Clock","render","getDelta","Signals","STOP","requestAnimationFrame","cancelAnimationFrame","stats","throttle","target","setSize","antialias","WebGLRenderer","alpha","setClearColor","autoClear","loadingManager","LoadingManager","assets","FogExp2","PerspectiveCamera","position","left","top","callback","setupStats","renderToScreen","gui","g","b","Color","ThreeNode","base","added","_start","child","lookAt","Vector3","rendered","pass","Object3D","newColor","getClearColor","background","ThreeColor","newAlpha","getClearAlpha","setClearAlpha","fx","clearColor","clearAlpha","AmbientLightNode","light","AmbientLight","DirectionalLightNode","DirectionalLight","copy","hex","rgbToHex","rgb","GlitchPassNode","textureLoader","TextureLoader","onProgress","item","total","texture","magFilter","minFilter","NearestFilter","_render","glitch","threeN","glitchPass","EffectPass","chromaticAberrationPass","aberration","ChromaticAberrationEffect","GlitchEffect","perturbationMap","chromaticAberrationOffset","Vec2","VignettePassNode","effect","VignetteEffect","eskil","darkness","uni","newVal","opacity","ScanlinePassNode","ScanlineEffect","DotScreenPassNode","colorAverageEffect","ColorAverageEffect","DotScreenEffect","blendFunction","angle","PI","blendMode","NoisePassNode","NoiseEffect","TorusKnotGeometryNode","_setGeo","radius","tube","tubularSegments","radialSegments","q","geometry","TorusKnotBufferGeometry","parameters","PlaneGeometryNode","PlaneBufferGeometry","BoxGeometryNode","depth","BoxBufferGeometry","SphereGeometryNode","widthSegments","heightSegments","SphereBufferGeometry","LambertMaterialNode","material","MeshLambertMaterial","transparent","wireframe","ShaderMaterialNode","_setMaterial","ShaderMaterial","vertexShader","fragmentShader","needsUpdate","vertex","fragment","EqualsNode","result","AndNode","memo","OrNode","NotNode","in","SwitchNode","not","else","MeshNode","mesh","Mesh","rotation","mat","geo","Vec3","MidiOutNode","available","loadAll","navigator","requestMIDIAccess","_setMidi","MidiInNode","InfoLog","anything","JSONParse","ExtractNode","SetNode","_val","path","StephenWolfram","currentState","rule","transitions","toBin8","initialState","lIdx","rIdx","num","bin","unshift","reverse","CollectNode","capacity","shift","JoinNode","array","separator","RegexReplace","regex","parsed","match","re","RegExp","replacement","ArrayFillNode","fillWith","CountSourceNode","_count","ZipNode","zipped","arg1","arg2","arg3","arg4","Vector2D","Vector3D","DomNode","inserted","_ensureExist","domNode","setAttribute","_tryInsert","root","getElementById","scalable","insertBefore","text","innerText","html","innerHTML","PlusNode","right","Interval","Scale","flexWrap","names","marginRight","marginBottom","Chord","ScaleNode","tonic","intervals","ChordNode","KeyTriadsNode","Key","TransposeNode","transpose","ChromaNode","chroma","DivideNode","dividend","divisor","int","SumNode","numbers","ProductNode","IntToIntMathNode","fn","apply","Program","GPGPUProgramNode","_varNames","updateProgram","up","variableNames","program","outputShape","userCode","RunGPGPUProgramNode","_inputQ","_result","_compileAndRun","slice","compileAndRun","JSCodeNode","_argsCode","arg5","make","Function","return","_t","date","allNodes","NodeInputListItem","hover","onMouseUp","stopPropagation","onMouseOver","setState","onMouseOut","filled","modifier","className","Component","NodeInputList","onCompleteConnector","items","connected","React","NodeOutputListItem","onMouseDown","onStart","NodeOutputList","positionOffset","onStartConnector","addVec","v1","v2","subVec","units","down","unitVec","dir","scaleVec","zero","MoveBufferPx","Node","_onDelete","onDelete","nis","handleDragStart","metaKey","shiftKey","dragStart","clientX","clientY","onNodeStart","handleDragStop","onNodeStop","handleDrag","onNodeMove","forceUpdate","_selectNode","resetHighlights","onNodeSelect","_deselectNode","removeHighlight","resetOtherHighlights","onNodeDeselect","handleClick","abs","selected","handleClickOutside","infoShowing","ignore","visible","pos","disabled","sel","nodeClass","handle","onStop","onDrag","onClick","onDoubleClick","displayInKeys","displayOutKeys","group","combo","label","global","onKeyDown","getInfoShowing","op","graph","infoOpen","getPos","nodePos","selector","createSelector","onClickOutside","HotkeysTarget","Graph","edges","_nodesById","nodeWithId","nodeWithIdF","addNode","setNodes","updatePositions","nodeIds","nodePositions","mapValues","removeNode","removeEdge","addEdge","duplicate","ids","newNodes","uniqBy","flatten","fIdx","indexOf","tIdx","nodesInSpace","frm","file","fileReader","FileReader","onload","readAsText","SVGComponent","Spline","selSet","setInfoOpen","_setListener","listeningOnEdge","_onNotify","el","animate","stroke","strokeWidth","handleRemove","highlighted","dist","distance","selfEdge","pathString","bezierCurve","cls","ref","cp1x","cp1y","cp2x","cp2y","sqrt","_selSet","_setInfoOpen","selectInfoOpen","selectPositions","paneId","positions","dragging","source","onRemoveConnector","scaleInverse","mousePos","creatingSpline","mid","centerP","outIdx","src","outKeyIndex","inIdx","inKeyIndex","NodeGraph","dragOffsets","moving","deselectNodes","timeoutId","deltaY","canvasDragEnd","metaDown","onKeyUp","onScroll","zoom","txFn","zooms","zoomIn","zoomOut","fromCenter","sign","onWinResize","onMouseMove","selectCount","_debouncedSetMouse","_getSelected","onNodeStartMove","onNodeStopMove","updates","_setPosFromGraph","lastUpdateTime","thresh","timeThresh","lastData","updatePos","outputIndex","inIndex","fromNode","toNode","fromAttr","toAttr","onCreateEdge","handleRemoveConnector","onDeleteEdge","idx","_onNodeChange","omit","onDeleteNode","onNodeSelectionChange","_overlaps","r1","r2","bottom","_nodesIntersecting","box","getBoundingClientRect","_setIntersects","union","subtract","selBox","selBound","sId","_onCanvasDrag","canvasDragStart","altKey","setPan","newPan","deltaX","backgroundPosition","_onStartCanvasDrag","_onEndCanvasDrag","_rootStyle","transform","_selectionBoxStyle","selCoord","_onCopy","_selectAll","_pan","_panR","_panL","_panD","_panU","cancel","size","backgroundSize","selStyle","onWheel","zoomReset","showCopy","select","selectedS","selectView","view","_zIn","_zOut","_zReset","_setPan","_updatePos","toObj","toType","obj","toLowerCase","getType","isNaN","defTheme","scheme","base00","base01","base02","base03","base04","base05","base06","base07","base08","base09","base0A","base0B","base0C","base0D","base0E","base0F","white","black","globalFontFamily","globalCursor","indentBlockWidth","braceFontWeight","braceCursor","ellipsisFontSize","ellipsisLineHeight","ellipsisCursor","keyMargin","keyLetterSpacing","keyFontStyle","keyBorderRadius","keyColonWeight","keyVerticalAlign","keyOpacity","keyOpacityHover","keyValPaddingTop","keyValPaddingBottom","keyValPaddingRight","keyValBorderLeft","keyValBorderHover","keyValPaddingHover","pushedContentMarginLeft","variableValuePaddingRight","nullFontSize","nullFontWeight","nullPadding","nullBorderRadius","dataTypeFontSize","dataTypeMarginRight","datatypeOpacity","objectSizeBorderRadius","objectSizeFontStyle","objectSizeMargin","clipboardCursor","clipboardCheckMarginLeft","metaDataPadding","arrayGroupMetaPadding","iconContainerWidth","tooltipPadding","editInputHeight","editInputMinWidth","editInputBorderRadius","editInputPadding","editInputMarginRight","editInputFontFamily","iconCursor","iconFontSize","iconPaddingRight","dateValueMarginLeft","iconMarginRight","detectedRowPaddingTop","addKeyCoverBackground","addKeyCoverPosition","addKeyCoverPositionPx","addKeyModalWidth","addKeyModalMargin","addKeyModalPadding","addKeyModalRadius","getDefaultThemeStyling","theme","colors","backgroundColor","ellipsisColor","braceColor","expandedIcon","collapsedIcon","keyColor","arrayKeyColor","objectSize","copyToClipboard","copyToClipboardCheck","objectBorder","dataTypes","float","function","integer","nan","null","regexp","editVariable","editIcon","cancelIcon","removeIcon","addIcon","checkIcon","border","addKeyModal","labelColor","validationFailure","iconColor","fontColor","colorMap","fontFamily","constants","cursor","ellipsis","fontSize","lineHeight","brace","fontWeight","colon","margin","verticalAlign","objectKeyVal","component","variable_style","paddingTop","paddingRight","paddingBottom","borderLeft","paddingLeft","padding","keyValPadding","_","styles","marginLeft","variableValue","letterSpacing","fontStyle","borderRadius","whiteSpace","tooltip","removeVarIcon","addVarIcon","editVarIcon","minHeight","minWidth","marginTop","overflow","boxSizing","getStyle","createStyling","defaultBase16","args","type_name","displayDataTypes","Theme","PureComponent","toLocaleTimeString","weekday","year","month","day","hour","minute","dispatcher","Dispatcher","attributeStore","objects","rjvId","default_value","handleAction","emit","updated_src","updateSrc","request","namespace","new_value","variable_removed","existing_value","deepCopy","walk","splice","copy_namespace","EventEmitter","register","bind","toggleCollapsed","collapsed","AttributeStore","getFunctionDisplay","collapseStringsAfterLength","parseInput","trim","formatResponse","parseFloat","NaN","string_value","DEFAULT_COLOR","CircleMinus","rest","getIconStyle","viewBox","fill","preserveAspectRatio","CirclePlus","SquareMinus","svgStyle","SquarePlus","ArrowRight","ArrowDown","Clippy","RemoveCircle","AddCircle","Add","Edit","CheckCircle","VariableEditor","renderKey","variable","getEditIcon","prepopInput","onEdit","stringifiedValue","stringifyVariable","detected","editMode","editValue","parsedInput","getRemoveIcon","dispatch","getValue","getEditInput","alignItems","inputRef","focus","ctrlKey","submitEdit","placeholder","submit_detected","getDetectedInput","renameKey","editOnHotkey","singleIndent","indentWidth","onSelect","overrideStyle","location","copiedTimer","handleCopy","clickCallback","clipboardValue","execCommand","copied","getClippyIcon","hidden","getObjectSize","displayObjectSize","getAddAttribute","key_name","getRemoveObject","onAdd","enableClipboard","getObjectName","parent_type","jsvRoot","display_name","ExpandedIcon","iconStyle","CollapsedIcon","newExpanded","expanded","groupArraysAfterLength","object_padding_left","array_group_padding_left","groups","getExpandedIcon","index_offset","DEPTH_INCREMENT","SINGLE_INDENT","RjvObject","getObjectContent","renderObjectContents","getEllipsis","getObjectMetaData","getBraceEnd","attrType","object_type","variables","rejectMatching","elements","sortKeys","sort","JsonVariable","hasOwnProperty","ObjectComponent","JsonObject","ArrayGroup","getState","IconComponent","getBraceStart","nextProps","prevState","shouldCollapse","polyfill","closeModal","submit","isValid","valid","spellCheck","onKeyPress","ObjectAttributes","active","message","ReactJsonView","getListeners","resetState","addKeyRequest","on_edit_payload","existing_src","editKeyRequest","validationMessage","prevSrc","prevName","prevTheme","newPartialState","validateState","validatedState","theme_keys","isTheme","hoverCloseDelay","hoverOpenDelay","interactionKind","PopoverInteractionKind","HOVER","popoverClassName","transitionDuration","anchor","contentDesc","content","AttributePane","fullDocs","_updateListener","_helpInfo","InfoPopup","CLICK","_docInfo","_changeables","list","spacer","truncate","len","_description","_signature","_toggleDocs","_onResize","MultiTypeEditor","_isComplex","_onEdit","_getEdit","complex","flex","renderItem","modifiers","query","noResults","itemListRenderer","filteredItems","ulRef","itemsParentRef","searcher","FuzzySearch","itemsPredicate","search","itemListPredicate","resetOnSelect","itemRenderer","FileUpload","openFileInput","fileInput","click","_onFile","onFile","SaveDialog","_onChange","_onInputKeyUp","_onSave","saveFile","initial","handleClose","isOpen","icon","onClose","Classes","DIALOG_BODY","autoFocus","INPUT","DIALOG_FOOTER","DIALOG_FOOTER_ACTIONS","intent","Intent","PRIMARY","_name","all","examples","inputProps","loadExample","insertNode","toggleVis","graphVisible","toggleDebug","exportJSON","loadJSON","toggleInfo","toolSection","leftAlign","minimal","large","href","rightAlign","_showHotKeys","dispatchEvent","KeyboardEvent","which","keyCode","bubbles","justifyContent","canOutsideClickClose","setScale","_setScale","stepSize","labelStepSize","labelRenderer","showTrackFill","welcomeGraph","defaultNodePos","App","nodeIndex","mostRecentNode","_mousePos","_insertPos","searchOpen","saveOpen","searchingNodes","searchingExamples","promptLoad","_onMouseMove","me","_setGraph","readme","showNode","_onSearch","_searchExamples","_exportJSON","exportObj","exportName","dataStr","encodeURIComponent","remove","downloadObj","_closeSave","_loadJSON","fileUpload","_onFileUpload","fromFile","_loadGraph","_reload","_loadExample","_toggleDebug","_addNode","_onNodeSelect","_node","_closeSearch","_showSave","_showNodeSearch","_toggleGraph","_loadUrl","example","exJson","serialization","_nextNode","_prevNode","_toggleInfo","_closePrompt","_manualInsert","showWelcome","exId","decodeURIComponent","hide","debug","inPane","onItemSelect","NodeSearcher","ExampleSearch","LoadPrompt","setHotkeysDialogProps","globalHotkeysGroup","AppWithHK","selectedSlice","createSlice","reducers","payload","infoOpenSlice","range","increments","fixed","cur","toFixed","defView","viewSlice","nodePosSlice","actions","combineReducers","reducer","rootReducer","store","configureStore","hostname","serviceWorker","ready","registration","unregister","Eternal","default","ReactDOM"],"mappings":"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","file":"static/js/main.981fa75c.chunk.js","sourcesContent":["// @flow\n\nimport type { Node } from 'react';\ntype TypeMetadata = { required: boolean };\n// eslint-disable-next-line no-use-before-define\nexport type TypeMap = { [string]: TypeImpl };\ntype EnumSchema = { [string]: string };\ntype AttributeSchema = TypeMap | EnumSchema;\n// this is facetious, but we need something like it\ntype TypeType = 'primitive' | 'enum' | 'complex';\n\nconst defaultMetadata: TypeMetadata = { required: false };\n\nexport interface AttributeType {\n  /**\n   * Runtime unique id. Maybe we should just use name.\n   */\n  id: Symbol;\n  /**\n   * name of this type. as convention, use all lowercase for primitives and PascalCase for complex\n   */\n  name: string;\n\n  typeDescription: Node;\n\n  /**\n   * We are overloading this type concept for the moment and putting the attribute description in this field.\n   * Usually done through {@link TypeImpl.desc} in an attribute type schema.\n   */\n  description: ?Node;\n  /**\n   * the attribute schema that describes this type. null for primitives\n   */\n  schema: ?AttributeSchema;\n\n  /**\n   * Bag for random type configuration\n   */\n  metadata: TypeMetadata;\n\n  /**\n   * The type of this type. A questionable abstraction, but convenient to support enums\n   */\n  type: TypeType;\n\n  defaultValue: any;\n\n  parse: any => any;\n  serialize: ?(any) => any;\n}\n\nexport class TypeImpl implements AttributeType {\n  id: Symbol;\n  name: string;\n  description: ?Node;\n  typeDescription: Node;\n  schema: ?AttributeSchema;\n  metadata: TypeMetadata;\n  type: TypeType;\n  defaultValue: any;\n  parse: any => any;\n  serialize: ?(any) => any;\n\n  constructor(data: AttributeType) {\n    this.id = data.id;\n    this.name = data.name;\n    this.schema = data.schema;\n    this.metadata = data.metadata;\n    this.type = data.type;\n    this.defaultValue = data.defaultValue;\n    this.description = data.description;\n    this.parse = data.parse;\n    this.typeDescription = data.typeDescription;\n    this.serialize = data.serialize;\n  }\n\n  /**\n   * Describe this type. See note about how desc is being overloaded as attribute.\n   * @param d - description of this attribute\n   * @returns {TypeImpl} - A new instance of this type, with the description\n   */\n  desc = (d: Node): TypeImpl => new TypeImpl({ ...this, description: d });\n  aliased = (name: string, typeDescription?: Node): TypeImpl =>\n    typeDescription\n      ? new TypeImpl({ ...this, name, typeDescription })\n      : new TypeImpl({ ...this, name });\n  meta = (metadata: Object): TypeImpl => new TypeImpl({ ...this, metadata });\n  isA = (t: AttributeType) => t.id === this.id;\n  isPrimitive = (): boolean => this.type === 'primitive';\n  isUndescribedPrimitive = (): boolean => this.type === 'primitive' && !this.typeDescription;\n  isComplex = (): boolean => this.type === 'complex';\n\n  /**\n   * See comment about how type / desc is being overloaded above\n   */\n  hasHelpInfo = (): boolean => this.description !== this.typeDescription;\n}\n\nexport class TypeBuilder {\n  name: string;\n  schema: ?AttributeSchema;\n  metadata: TypeMetadata;\n  type: TypeType;\n  defaultValue: any;\n  description: ?Node;\n  typeDescription: Node;\n  serializer: ?(any) => any;\n  parse: any => any = v => v;\n\n  constructor(name: string) {\n    this.name = name;\n  }\n\n  withMetadata(metadata: TypeMetadata): TypeBuilder {\n    if (this.metadata) {\n      throw new Error(\n        \"you likely don't mean to replace the metadata you are building; use `withMetadataAttr`.\"\n      );\n    }\n    this.metadata = metadata;\n    return this;\n  }\n\n  withMetadataAttr(attr: $Shape<TypeMetadata>): TypeBuilder {\n    this.metadata = { ...this.metadata, ...attr };\n    return this;\n  }\n\n  withParser(parser: any => any): TypeBuilder {\n    this.parse = parser;\n    return this;\n  }\n\n  withSerializer(serializer: any => any): TypeBuilder {\n    this.serializer = serializer;\n    return this;\n  }\n\n  withType(type: TypeType): TypeBuilder {\n    this.type = type;\n    return this;\n  }\n\n  withSchema(schema: AttributeSchema): TypeBuilder {\n    this.schema = schema;\n    return this;\n  }\n\n  havingDefault(val: any): TypeBuilder {\n    this.defaultValue = val;\n    return this;\n  }\n\n  desc(des: Node): TypeBuilder {\n    this.typeDescription = des;\n    return this;\n  }\n\n  validate = () => {\n    const { name, schema, type } = this;\n    if (!name) throw new Error('need a name');\n    // we may want to just key on id and allow duplicate names\n    if (name in typeRegistry) throw new Error('already exists');\n    if (!type) throw new Error('need a type');\n    if (type === 'primitive') {\n      if (schema) throw new Error('primitives cannot have schemas');\n    } else {\n      // again, this type is a cop-out but practically useful\n      if (name !== 'object' && !schema) throw new Error('non primitives need a schema');\n      // may want to validate enum / complex schema shape\n    }\n  };\n\n  build(): TypeImpl {\n    this.validate();\n    const t = new TypeImpl({\n      id: Symbol(),\n      name: this.name,\n      schema: this.schema,\n      metadata: this.metadata || defaultMetadata,\n      type: this.type,\n      defaultValue: this.defaultValue,\n      description: this.description,\n      typeDescription: this.typeDescription,\n      parse: this.parse,\n      serialize: this.serializer,\n    });\n    registerType(t);\n    return t;\n  }\n}\n\nconst typeRegistry: TypeMap = {};\nwindow.Types = typeRegistry;\n\nfunction registerType(t: TypeImpl) {\n  typeRegistry[t.name] = t;\n}\n","// @flow\nimport React from 'react';\nimport { TypeBuilder } from 'models/AttributeType';\nimport type { TypeMap } from 'models/AttributeType';\n\nconst primitiveSerializer: any => any = v => v;\n// Primitives\nconst number = new TypeBuilder('number')\n  .withType('primitive')\n  .desc(\n    <span>\n      A basic <code>number</code> type\n    </span>\n  )\n  .havingDefault(0)\n  .withParser(v => (typeof v === 'string' ? parseInt(v) : v))\n  .withSerializer(primitiveSerializer)\n  .build();\n\nconst string = new TypeBuilder('string')\n  .withType('primitive')\n  .desc(\n    <span>\n      A basic <code>string</code> type\n    </span>\n  )\n  .havingDefault('')\n  .withParser(v => (typeof v === 'object' ? JSON.stringify(v) : String(v)))\n  .withSerializer(a => (typeof a === 'object' ? JSON.stringify(a) : String(a)))\n  .build();\n\nconst boolean = new TypeBuilder('boolean')\n  .withType('primitive')\n  .desc(\n    <span>\n      A basic <code>boolean</code> type\n    </span>\n  )\n  .havingDefault(false)\n  .withParser(Boolean)\n  .withSerializer(primitiveSerializer)\n  .build();\n\nconst date = new TypeBuilder('date')\n  .withType('primitive')\n  .desc(\n    <span>\n      A basic <code>date</code> type\n    </span>\n  )\n  .havingDefault(new Date())\n  .withSerializer(v => (v instanceof Date ? v.toISOString() : undefined))\n  .withParser(v => (typeof v === 'string' ? Date.parse(v) : v))\n  .build();\n\nconst any = new TypeBuilder('any')\n  .withType('primitive')\n  .desc('This can be anything')\n  .havingDefault(undefined)\n  .build();\n\nconst time = new TypeBuilder('time')\n  .withType('primitive')\n  .desc(\n    <>\n      <div>Time can be described in a number of ways:</div>\n      <ul>\n        <li>Numbers, which will be taken literally as the time (in seconds).</li>\n        <li>Notation, (\"4n\", \"8t\") describes time in BPM and time signature relative values.</li>\n        <li>\n          TransportTime, (\"4:3:2\") will also provide tempo and time signature relative times in the\n          form BARS:QUARTERS:SIXTEENTHS.\n        </li>\n        <li>Frequency, (\"8hz\") is converted to the length of the cycle in seconds.</li>\n        <li>\n          Now-Relative, (\"+1\") prefix any of the above with \"+\" and it will be interpreted as \"the\n          current time plus whatever expression follows\".\n        </li>\n        <li>\n          Expressions, (\"3:0 + 2 - (1m / 7)\") any of the above can also be combined into a\n          mathematical expression which will be evaluated to compute the desired time.\n        </li>\n        <li>\n          No Argument, for methods which accept time, no argument will be interpreted as \"now\" (i.e.\n          the currentTime).\n        </li>\n      </ul>\n    </>\n  )\n  .withSerializer(primitiveSerializer)\n  .havingDefault(0)\n  .build();\n\n// kinda bogus, but useful for now\nconst object = new TypeBuilder('object')\n  .withType('complex')\n  .desc('An object with arbitrary keys and values')\n  .havingDefault(undefined)\n  .withParser(v => (typeof v === 'string' ? JSON.parse(v) : v))\n  .build();\n\nconst Vec2 = new TypeBuilder('Vec2')\n  .withSchema(({ x: number, y: number }: TypeMap))\n  .withType('complex')\n  .desc(\n    <span>\n      A 2D Vector with keys <code>x</code> and <code>y</code>\n    </span>\n  )\n  .havingDefault({ x: 0, y: 0 })\n  .withSerializer(v => {\n    if (\n      typeof v === 'object' &&\n      typeof parseInt(v.x) === 'number' &&\n      typeof parseInt(v.y) === 'number'\n    ) {\n      return JSON.stringify({ x: v.x, y: v.y });\n    }\n    return undefined;\n  })\n  .withParser(v => (typeof v === 'string' ? JSON.parse(v) : v))\n  .build();\n\nconst Vec3 = new TypeBuilder('Vec3')\n  .withSchema(({ x: number, y: number, z: number }: TypeMap))\n  .withType('complex')\n  .desc(\n    <span>\n      A 3D Vector with keys <code>x</code>, <code>y</code>, and <code>z</code>\n    </span>\n  )\n  .havingDefault({ x: 0, y: 0, z: 0 })\n  .withSerializer(v => {\n    if (\n      typeof v === 'object' &&\n      typeof parseInt(v.x) === 'number' &&\n      typeof parseInt(v.y) === 'number' &&\n      typeof parseInt(v.z) === 'number'\n    ) {\n      return JSON.stringify({ x: v.x, y: v.y, z: v.z });\n    }\n    return undefined;\n  })\n  .withParser(v => (typeof v === 'string' ? JSON.parse(v) : v))\n  .build();\n\n/**\n * using {@link TypeBuilder.build} will register types in the global registry automatically\n */\n// noinspection JSUnusedGlobalSymbols\nexport { number, string, boolean, date, any, time, object, Vec2, Vec3 };\n","// @flow\n\nexport function uuid(): string {\n  // noinspection SpellCheckingInspection\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\n    let r = (Math.random() * 16) | 0;\n    return (c === 'x' ? r : (r & 0x3) | 0x8).toString(16);\n  });\n}\n\nexport function downloadObj(exportObj: Object, exportName: string) {\n  const dataStr = 'data:text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(exportObj));\n  const anchor = document.createElement('a');\n  anchor.setAttribute('href', dataStr);\n  anchor.setAttribute('download', exportName + '.json');\n  // $FlowIssue\n  document.body.appendChild(anchor);\n  anchor.click();\n  anchor.remove();\n}\n","// @flow\n\nimport { uuid } from 'helpers';\nimport type { AnyNode } from 'models/NodeBase';\n\nexport type EdgeSerialization = {\n  id: string,\n  fromId: string,\n  fromPort: string,\n  toId: string,\n  toPort: string,\n};\n\nexport default class Edge {\n  id: string;\n  from: AnyNode;\n  to: AnyNode;\n  fromPort: string;\n  toPort: string;\n  _notifyCount: number = 0;\n  notifyListener: ?() => void = null;\n\n  constructor(from: AnyNode, to: AnyNode, fromPort: string, toPort: string, id?: string) {\n    this.id = id || uuid();\n    this.from = from;\n    this.to = to;\n    this.fromPort = fromPort;\n    this.toPort = toPort;\n  }\n\n  outDataFor = (data: Object) => ({ [this.toPort]: data[this.fromPort] });\n  inDataFor = (change: Object) => change[this.toPort];\n\n  notify = () => {\n    this._notifyCount += 1;\n    this.notifyListener && this.notifyListener();\n  };\n\n  serialize: () => EdgeSerialization = () => {\n    return {\n      id: this.id,\n      fromId: this.from.id,\n      fromPort: this.fromPort,\n      toId: this.to.id,\n      toPort: this.toPort,\n    };\n  };\n\n  static load(j: EdgeSerialization, nodes: AnyNode[]) {\n    const from = nodes.find(n => n.id === j.fromId);\n    const to = nodes.find(n => n.id === j.toId);\n    if (!from || !to) {\n      throw new Error('could not load graph');\n    }\n    return new Edge(from, to, j.fromPort, j.toPort, j.id);\n  }\n}\n","// @flow\nimport React, { type Node } from 'react';\nimport type { Pos } from 'types';\nimport type { AnyNode } from 'models/NodeBase';\n\nwindow.$eTop = 51;\nwindow.$eHeight = 22;\nwindow.$eInL = 0;\nwindow.$eOutL = 198;\n\nexport function inOffset(x: number, y: number, index: number): Pos {\n  return { x: x + window.$eInL, y: y + window.$eTop + index * window.$eHeight };\n}\n\nexport function outOffset(x: number, y: number, index: number): Pos {\n  return { x: x + window.$eOutL, y: y + window.$eTop + index * window.$eHeight };\n}\n\nexport const signatureFor = (\n  clazz: Class<AnyNode>,\n  maxLen: number = 0,\n  style?: ?Object = null\n): Node => {\n  let argT = clazz.inKeys().join(', ');\n  let returnT = clazz.outKeys().join(', ');\n  if (maxLen) {\n    if (argT.length > maxLen - 3) {\n      argT = argT.substring(0, maxLen) + '...';\n    }\n    if (returnT.length > maxLen - 3) {\n      returnT = returnT.substring(0, maxLen) + '...';\n    }\n  }\n  return (\n    <div style={style}>\n      {`(${argT})`} <span style={{ color: 'rgba(200, 200, 200, 0.5)' }}>➜</span> {`(${returnT})`}\n    </div>\n  );\n};\n","/* eslint-disable no-use-before-define */\n// @flow\n\nimport { type Node } from 'react';\nimport { startCase, pick, omitBy, isEqual, get, set, cloneDeep, fromPairs, uniq } from 'lodash';\nimport Edge from 'models/Edge';\nimport { uuid } from 'helpers';\nimport { TypeImpl, type TypeMap } from 'models/AttributeType';\nimport { signatureFor } from 'components/util';\n\nexport default class NodeBase<Val: Object, In: ?Object, Out: ?Object> {\n  +id: string;\n\n  state: Val;\n  props: $Shape<In>;\n\n  inputs: Edge[] = [];\n  outputs: Edge[] = [];\n\n  // Private vars\n  outputCache = {};\n  live: boolean = false;\n  +listeners: { [string]: ChangeListener } = {};\n  title: ?string;\n  _unPushed: string[] = [];\n\n  static +displayName: ?string;\n  static +registryName: string;\n  static +description: ?Node;\n  static +isPrimitive: boolean = false;\n  static +defaultState: ?$Shape<Val>;\n  static +defaultProps: ?$Shape<In>;\n  static +schema: Schema = { input: {}, output: {}, state: {} };\n  static +shortNames: { [string]: string } = {};\n\n  constructor(attrs?: $Shape<Val>, props?: $Shape<In>, nodeId?: string, title?: ?string) {\n    this.id = nodeId || uuid();\n    this.title = title;\n    this.state = {\n      ...this.constructor.initializeState(),\n      ...this.constructor.defaultState,\n      ...attrs,\n    };\n    if (this.constructor.defaultProps) {\n      this.props = { ...this.constructor.defaultProps, ...props };\n    } else {\n      this.props = props || {};\n    }\n  }\n\n  _process: (string[], boolean) => Out = (keys, force) => {\n    const val = this.process(keys);\n    // TODO: think about mutating objects in output cache. should we deep copy or not allow mutations?\n    const forward = force ? val : omitBy(val, (v, k) => isEqual(v, this.outputCache[k]));\n    this.outputCache = { ...this.outputCache, ...val };\n    return forward;\n  };\n\n  /**\n   * Run this node over current state to compute an output\n   * @param keys a subset of outKeys which should be processed\n   */\n  process: (string[]) => Out = keys => {\n    throw new Error('unimplemented');\n  };\n\n  /**\n   * Called the first time this node is added to a graph\n   */\n  onAddToGraph = () => {};\n  /**\n   * This lifecycle hook is fired the first time this node is connected to all of its inputs.\n   * Later this should be changed to fire only after all required inputs are supplied.\n   */\n  willBecomeLive: () => void = () => {};\n\n  /**\n   * This lifecycle hook is fired before this node is removed from a graph. It is your chance to clean up any\n   * state that this node might have initialized.\n   */\n  willBeRemoved: () => void = () => {};\n\n  beforeConnectOut: Edge => void = edge => {};\n  afterConnectOut: Edge => void = edge => {};\n  beforeConnectIn: Edge => void = edge => {};\n  afterConnectIn: Edge => void = edge => {};\n\n  beforeDisconnectOut: Edge => void = edge => {};\n  afterDisconnectOut: Edge => void = edge => {};\n  beforeDisconnectIn: Edge => void = edge => {};\n  afterDisconnectIn: Edge => void = edge => {};\n\n  requireForOutput: () => boolean = () => true;\n\n  addInput: (input: Edge) => void = input => {\n    this.beforeConnectIn(input);\n    this.inputs.push(input);\n    if (input.from.requireForOutput()) {\n      const initialValue = input.from.process([input.toPort]);\n      this._onInputChange(input, input.outDataFor(initialValue), true);\n    } else {\n      this._unPushed.push(input.id);\n    }\n    this._notifyLive(input);\n    this.afterConnectIn(input);\n  };\n\n  // TODO change this to required inputs check\n  _notifyLive = (input: Edge) => {\n    if (!this.live) {\n      const sKeys = this.constructor.inKeys();\n      const iKeys = this.inputs.map(i => i.toPort).concat(input.toPort);\n      if (sKeys.every(k => iKeys.includes(k))) {\n        this.willBecomeLive();\n        this.live = true;\n      }\n    }\n  };\n\n  forAllConnectedInputs = (handler: (key: string, val: any) => void) =>\n    uniq(this.inputs.map(edge => edge.toPort)).map(k => handler(k, this.props && this.props[k]));\n\n  domId = () => `n-root-${this.id}`;\n\n  addOutput: (output: Edge) => void = out => {\n    this.beforeConnectOut(out);\n    this.outputs.push(out);\n    this.afterConnectOut(out);\n  };\n\n  removeInput: (Edge, onRemove?: () => void) => void = (input, onRemove) => {\n    this.beforeDisconnectIn(input);\n    this.inputs = this.inputs.filter(i => input.id !== i.id);\n    this.afterDisconnectIn(input);\n    onRemove && onRemove();\n  };\n\n  firstInput: string => ?AnyNode = forKey => {\n    const edge: ?Edge = this.inputs.find(i => i.toPort === forKey);\n    if (edge) {\n      // $FlowIssue - dunno\n      return edge.from;\n    }\n    return null;\n  };\n\n  removeOutput: (Edge, onRemove?: () => void) => void = (output, onRemove) => {\n    this.beforeDisconnectOut(output);\n    this.outputs = this.outputs.filter(i => output.id !== i.id);\n    this.afterDisconnectOut(output);\n    onRemove && onRemove();\n  };\n\n  _onInputChange: (edge: Edge, partialChange: $Shape<In>, boolean) => void = (\n    edge,\n    change,\n    force\n  ) => {\n    const oldProps = { ...this.props };\n    this.props = this.props || {};\n    // $FlowIgnore\n    change && Object.keys(change).forEach(k => (this.props[k] = change[k]));\n    let _force = force;\n    if (this._unPushed.includes(edge.id)) {\n      this._unPushed = this._unPushed.filter(id => id !== edge.id);\n      _force = true;\n    }\n    this.willReceiveProps(this.props, oldProps, false);\n    this.notifyOutputs(this.onInputChange(edge, change), _force);\n  };\n\n  registerListener: ChangeListener => string = listener => {\n    const key = uuid();\n    this.listeners[key] = listener;\n    return key;\n  };\n\n  removeListener: string => boolean = id => {\n    return delete this.listeners[id];\n  };\n\n  /**\n   * Handle input changes from an edge\n   * @param edge the edge that has notified this node of a change\n   * @param change the change payload for that edge\n   * @returns {Array} an array of output edges to propagate on\n   */\n  onInputChange: (edge: Edge, partialChange: $Shape<In>) => string[] = (edge, change) => {\n    return [];\n  };\n\n  /**\n   * Called before new prop changes are set. Note that manually overriding props will also fire this method.\n   * @param newProps\n   * @param prevProps\n   * @param manual whether or not the change was a manual change, as opposed to a connected change\n   */\n  willReceiveProps: (newProps: In, prefProps: In, boolean) => void = (\n    newProps,\n    prevProps,\n    manual\n  ) => {};\n\n  /**\n   * Notify some set of this node's output ports of changes\n   * @param ofKeyChanges the output port keys which will be notified\n   * @param force use this flag to force propagation updates, even if the value has not changed\n   */\n  notifyOutputs: (string | string[], force?: boolean) => void = (ofKeyChanges, force = false) => {\n    if (!this.requireForOutput()) {\n      return;\n    }\n    const asList = Array.isArray(ofKeyChanges) ? ofKeyChanges : [ofKeyChanges];\n    const val = this._process(asList, force);\n    const changes = pick(val, asList);\n    for (let listener in this.listeners) {\n      this.listeners[listener](this);\n    }\n    this.outputs\n      .filter(e => e.from.id === this.id && e.fromPort in changes)\n      .forEach(edge => {\n        edge.to._onInputChange(edge, edge.outDataFor(changes), force);\n        edge.notify();\n      });\n  };\n\n  notifyAllOutputs = (force?: boolean = false) => this.notifyOutputs(this.outKeys(), force);\n\n  inKeys = (): string[] => this.constructor.inKeys();\n  inKeyAt = (i: number): string => this.inKeys()[i];\n  outKeys = (): string[] => this.constructor.outKeys();\n  outKeyAt = (i: number): string => this.outKeys()[i];\n\n  connectedInputKeys = () => uniq(this.inputs.map(e => e.toPort));\n  connectedOutputKeys = () => uniq(this.outputs.map(e => e.fromPort));\n\n  name = () => {\n    let defName;\n    if (this.title) {\n      return this.title;\n    } else if (this.constructor.isPrimitive && uniq(this.outputs.map(e => e.toPort)).length === 1) {\n      defName = this.outputs[0].toPort;\n    } else {\n      defName = NodeBase.nameFrom(this.constructor);\n    }\n    if (window['$debug']) {\n      const { value } = this.state;\n      const hasVal = value || value === false || value === 0;\n      return this.constructor.isPrimitive ? (hasVal ? String(value) : defName) : defName;\n    } else {\n      return defName;\n    }\n  };\n\n  /**\n   * All the dynamic user-changeable attributes for this node.\n   * You probably shouldn't override this method, but instead use other\n   * methods / class attributes to include extras or exclude defaults\n   * @returns {[string]: Changeable[]} lists of all changeables for this node under a key category.\n   */\n  changeables: () => { [string]: Changeable[] } = () => {\n    let changeables = {};\n    const p = this.changeableProps();\n    const s = this.changeableState();\n    const o = this.otherChangeables();\n    const outs = this.displayableOutputs();\n    if (p.length > 0) changeables.Inputs = p;\n    if (s.length > 0) changeables.Internals = s;\n    if (o.length > 0) changeables.Other = o;\n    if (outs.length > 0) changeables.Outputs = outs;\n    // $FlowIssue - outputs, i kno TODO\n    return changeables;\n  };\n\n  displayableOutputs: () => Displayable[] = () => {\n    const schema = this.constructor.schema.output;\n    return Object.keys(schema).map(k => ({\n      title: k,\n      type: schema[k],\n      value: get(this.outputCache, k),\n    }));\n  };\n\n  changeableState: () => Changeable[] = () => {\n    const stateSchema = this.constructor.schema.state;\n    return Object.keys(stateSchema).map(k => ({\n      title: k,\n      type: stateSchema[k],\n      value: get(this.state, k),\n      onChange: val => {\n        if (this.state) {\n          this.state[k] = val;\n        } else {\n          // $FlowIssue\n          this.state = { [k]: val };\n        }\n        this.notifyAllOutputs();\n      },\n    }));\n  };\n\n  changeableProps: () => Changeable[] = () => {\n    const inputSchema = this.constructor.schema.input;\n    return Object.keys(inputSchema).map(k => ({\n      title: k,\n      type: inputSchema[k],\n      value: get(this.props, k),\n      onChange: val => {\n        const oldProps = this.props ? cloneDeep(this.props) : {};\n        if (this.props) {\n          this.props[k] = val;\n        } else {\n          this.props = { [k]: val };\n        }\n        // $FlowIssue\n        this.willReceiveProps(this.props, oldProps, true);\n        this.notifyAllOutputs();\n      },\n    }));\n  };\n\n  otherChangeables: () => Changeable[] = () => [];\n\n  pushToState = (\n    stateKey: string,\n    change: Object,\n    exclude: string[] = [],\n    setPath: ?string = null\n  ): string[] => {\n    const partial = this.state[stateKey];\n    if (!partial) {\n      return [];\n    }\n    const allKeys = Object.keys(change);\n    const keys = exclude.length > 0 ? allKeys.filter(k => !exclude.includes(k)) : allKeys;\n    if (keys.length === 0) return [];\n    keys.forEach(k => {\n      const accept = change[k] !== undefined;\n      if (k in partial && accept) {\n        if (typeof partial.set === 'function') {\n          partial.set(k, change[k]);\n        } else {\n          set(partial, setPath ? setPath : k, change[k]);\n        }\n      }\n    });\n    return keys;\n  };\n\n  // Probably should just require display name and not need this\n  static nameFrom(clazz: Class<AnyNode>) {\n    return clazz.displayName || startCase(clazz.name.replace(/node/i, ''));\n  }\n\n  static getRegistryName(): string {\n    return this.registryName || this.name;\n  }\n\n  signature = (maxLen: number = 0, style: ?Object = null) => {\n    // $FlowIgnore\n    return signatureFor(this.constructor, maxLen, style);\n  };\n\n  serialize: (x: number, y: number) => NodeSerialization<$Shape<Val>> = (x, y) => {\n    const stateS = this.constructor.schema.state;\n    const state = fromPairs(\n      Object.keys(this.state)\n        .map(k => {\n          const type: ?TypeImpl = get(stateS, k);\n          if (type && type.serialize) {\n            try {\n              const serialized = type.serialize(this.state[k]);\n              if (serialized !== undefined) {\n                return [k, serialized];\n              }\n            } catch (e) {\n              console.error('error parsing', this.state[k], type.name, e);\n            }\n          }\n          return null;\n        })\n        .filter(p => p)\n    );\n    const type = this.constructor.getRegistryName();\n    return { id: this.id, type, x, y, state, title: this.title };\n  };\n\n  static duplicate(node: AnyNode): AnyNode {\n    const serial = node.serialize(0, 0);\n    serial.id = '';\n    return NodeBase.load(serial);\n  }\n\n  static +_inKeys: string[];\n  static inKeys(): string[] {\n    if (this._inKeys) {\n      return this._inKeys;\n    }\n    (this: any)._inKeys = Object.keys(this.schema.input);\n    return this._inKeys;\n  }\n\n  static +_inKeyIdxMap: { [string]: number };\n  static inKeyIndex(key: string): number {\n    if (this._inKeyIdxMap) {\n      return this._inKeyIdxMap[key];\n    }\n    (this: any)._inKeyIdxMap = fromPairs(this.inKeys().map((k, i) => [k, i]));\n    return this._inKeyIdxMap[key];\n  }\n\n  static +_outKeys: string[];\n  static outKeys(): string[] {\n    if (this._outKeys) {\n      return this._outKeys;\n    }\n    (this: any)._outKeys = Object.keys(this.schema.output);\n    return this._outKeys;\n  }\n\n  static +_outKeyIdxMap: { [string]: number };\n  static outKeyIndex(key: string): number {\n    if (this._outKeyIdxMap) {\n      return this._outKeyIdxMap[key];\n    }\n    (this: any)._outKeyIdxMap = fromPairs(this.outKeys().map((k, i) => [k, i]));\n    return this._outKeyIdxMap[key];\n  }\n\n  static +_displayInKeys: string[];\n  static displayInKeys(): string[] {\n    if (this._displayInKeys) {\n      return this._displayInKeys;\n    }\n    (this: any)._displayInKeys = Object.keys(this.schema.input).map(k =>\n      this.shortNames[k] ? this.shortNames[k] : k\n    );\n    return this._displayInKeys;\n  }\n\n  static +_displayOutKeys: string[];\n  static displayOutKeys(): string[] {\n    if (this._displayOutKeys) {\n      return this._displayOutKeys;\n    }\n    (this: any)._displayOutKeys = Object.keys(this.schema.output).map(k =>\n      this.shortNames[k] ? this.shortNames[k] : k\n    );\n    return this._displayOutKeys;\n  }\n\n  static initializeState(): Object {\n    const state = {};\n    Object.keys(this.schema.state).forEach(k => {\n      state[k] = this.schema.state[k].defaultValue;\n    });\n    return state;\n  }\n\n  static load(json: NodeSerialization<$Shape<Val>>): AnyNode {\n    const clazz = window.NodeRegistry[json.type];\n    try {\n      const title = get(json, 'title');\n      return new clazz(json.state, {}, json.id, title);\n    } catch (e) {\n      console.error('cannot load node', json.type);\n      throw e;\n    }\n  }\n}\n\nexport type AnyNode = NodeBase<any, any, any>;\nexport type Schema = { input: TypeMap, output: TypeMap, state: TypeMap };\n// TODO - type these two\nexport type Displayable = { title: string, type: TypeImpl, value: any };\nexport type Changeable = Displayable & { onChange: (val: any) => void };\nexport type ChangeListener = AnyNode => void;\nexport type NodeSerialization<S> = {\n  id: string,\n  type: string,\n  x: number,\n  y: number,\n  state?: S,\n  title?: ?string,\n};\n","// @flow\nimport React from 'react';\nimport type { AttributeType } from 'models/AttributeType';\n\nexport const arrayOf = (type: AttributeType) =>\n  window.Types.any.aliased(\n    `${type.name}[]`,\n    <div>\n      <p>An array of {type.name}s</p>\n      <p>{type.typeDescription}</p>\n    </div>\n  );\n","// @flow\nimport React from 'react';\nimport { get } from 'lodash';\nimport Tone from 'tone';\nimport NodeBase from 'models/NodeBase';\nimport Edge from 'models/Edge';\nimport { arrayOf } from 'utils/typeUtils';\nconst Piano = require('tone-piano').Piano;\nconst Types = window.Types;\nconst URL_BASE = process.env.PUBLIC_URL || '';\n\n// Tone Types\nexport const TT = {\n  AudioNode: Types.object.aliased('AudioNode', 'Any kind of audio node'),\n  Config: Types.object.aliased('Config'),\n  Synth: Types.object.aliased('Synth', 'Any kind of synth'),\n  Panner: Types.object.aliased('Panner', 'An audio pan'),\n  Gain: Types.object.aliased('Gain', 'An audio gain'),\n  FeedbackDelay: Types.object.aliased('FeedbackDelay', 'A feedback delay'),\n  Note: Types.string.aliased(\n    'Note',\n    'Note encoding, can be something like A4, a midi index, or a raw frequency in Hz'\n  ),\n  Call: Types.any\n    .aliased('Call', 'Something that is callable')\n    .desc(\n      \"Certain nodes are designated 'callable', i.e. they are operator nodes. Sending a truthy call signal will invoke that node's handler over its parameters\"\n    ),\n};\n\nexport class ContextDestinationNode extends NodeBase<{}, {}, { node: Tone.AudioNode }> {\n  static +displayName = 'Context Destination';\n  static +registryName = 'ContextDestinationNode';\n  static description = <span>The current context destination</span>;\n  static schema = {\n    input: {},\n    output: { node: TT.AudioNode.desc('The current context destination node') },\n    state: {},\n  };\n\n  process = () => ({ node: Tone.context.destination });\n}\n\nexport class ConnectNode extends NodeBase<\n  {},\n  { from: Tone.AudioNode, to: Tone.AudioNode },\n  { from: Tone.AudioNode, to: Tone.AudioNode }\n> {\n  static +displayName = 'Connect';\n  static +registryName = 'ConnectNode';\n  static description = <span>Connect one audio node to another</span>;\n  static schema = {\n    input: {\n      from: TT.AudioNode.desc('Connect from any audio node'),\n      to: TT.AudioNode.desc('Connect to any audio node'),\n    },\n    output: {\n      from: TT.AudioNode.desc('The same node, connected'),\n      to: TT.AudioNode.desc('The same node, connected'),\n    },\n    state: {},\n  };\n\n  willBecomeLive = () => {\n    const { from, to } = this.props;\n    logConnect(from, to);\n    from.connect(to);\n  };\n\n  beforeDisconnectIn: Edge => void = edge => {\n    const name = edge.toPort;\n    if (name === 'from' || name === 'to') {\n      const { from, to } = this.props;\n      if (from && to) {\n        from.disconnect(to);\n      }\n    }\n  };\n\n  process = () => this.props;\n}\n\nexport class AudioMasterNode extends NodeBase<\n  {},\n  { node: Tone.AudioNode },\n  { out: Tone.AudioNode }\n> {\n  static +displayName = 'Audio Master';\n  static +registryName = 'AudioMasterNode';\n  static description = <span>Connect an audio node to the master audio output</span>;\n  static schema = {\n    input: {\n      node: TT.AudioNode.desc('Any Audio node to connect to the audio master output'),\n    },\n    output: { out: TT.AudioNode.desc('The same node, connected to the master output') },\n    state: {},\n  };\n  _connectedTo: string = '';\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if ('node' === edge.toPort && this._connectedTo !== edge.id) {\n      edge.inDataFor(change).toMaster();\n      return this.outKeys();\n    }\n    return [];\n  };\n\n  beforeDisconnectIn: Edge => void = edge => {\n    const name = edge.toPort;\n    if (name === 'node') {\n      const { node } = this.props;\n      if (node) {\n        node.disconnect();\n      }\n    }\n  };\n\n  process = () => ({ out: this.props.node });\n}\n\nexport class ToContextDestinationNode extends NodeBase<\n  {},\n  { node: Tone.AudioNode },\n  { out: Tone.AudioNode }\n> {\n  static +displayName = 'To Context Dest.';\n  static +registryName = 'ToContextDestinationNode';\n  static description = <span>Connect an audio node to audio context destination</span>;\n  static schema = {\n    input: {\n      node: TT.AudioNode.desc('Any Audio node to connect to the context destination'),\n    },\n    output: { out: TT.AudioNode.desc('The same node, connected to the context destination') },\n    state: {},\n  };\n  _connectedTo: string = '';\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if ('node' === edge.toPort && this._connectedTo !== edge.id) {\n      Tone.connect(edge.inDataFor(change), Tone.context.destination);\n      return this.outKeys();\n    }\n    return [];\n  };\n\n  beforeDisconnectIn: Edge => void = edge => {\n    const name = edge.toPort;\n    if (name === 'node') {\n      const { node } = this.props;\n      if (node) {\n        node.disconnect();\n      }\n    }\n  };\n\n  process = () => ({ out: this.props.node });\n}\n\nexport class PannerNode extends NodeBase<\n  { panner: Tone.Panner, _connectedTo: ?string },\n  { node: Tone.AudioNode, pan: number },\n  { out: Tone.Panner, node: Tone.AudioNode }\n> {\n  static +displayName = 'Audio Panner';\n  static +registryName = 'PannerNode';\n  static description = <span>An equal power Left/Right stereo Panner</span>;\n  static schema = {\n    input: {\n      node: TT.AudioNode.desc('The audio node to connect to this panner.'),\n      pan: Types.number.desc('The pan control. -1 = hard left, 1 = hard right'),\n    },\n    output: {\n      out: TT.Panner.desc('A node panned to the `pan` value'),\n      node: TT.AudioNode.desc('The node that was passed in, connected to the panner'),\n    },\n    state: { panner: TT.Config.desc('The panner config') },\n  };\n\n  onAddToGraph = () => {\n    this.state.panner = new Tone.Panner(0);\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    if (!prevProps || newProps.pan !== prevProps.pan) {\n      this.pushToState('panner', { pan: newProps.pan }, [], ['pan', 'value']);\n    }\n  };\n\n  /**\n   * TODO: With this pattern I am concerned that we are being too magical and should\n   * just include a connect(from, to) node for connections.\n   */\n  onInputChange = (edge: Edge, change: Object) => {\n    if ('node' === edge.toPort && this.state._connectedTo !== edge.id) {\n      logConnect(edge.inDataFor(change), this.state.panner);\n      edge.inDataFor(change).connect(this.state.panner);\n      return this.outKeys();\n    }\n    return [];\n  };\n\n  beforeDisconnectIn: Edge => void = edge => {\n    const name = edge.toPort;\n    if (name === 'node') {\n      const { node } = this.props;\n      if (node) {\n        node.disconnect();\n      }\n    }\n  };\n\n  process = () => ({ out: this.state.panner, node: this.props.node });\n}\n\nexport class VolumeNode extends NodeBase<\n  { volume: Tone.Volume, _connectedTo: ?string },\n  { node: Tone.AudioNode, volume: number },\n  { out: Tone.Volume, node: Tone.AudioNode }\n> {\n  static +displayName = 'Audio Volume';\n  static +registryName = 'VolumeNode';\n  static description = <span>A simple volume node, useful for creating a volume fader.</span>;\n  static schema = {\n    input: {\n      node: TT.AudioNode.desc('The audio node to connect to this Volume node.'),\n      volume: Types.number.desc('The volume, in decibels'),\n    },\n    output: {\n      out: Types.object.aliased('Volume').desc('The volume node'),\n      node: TT.AudioNode.desc('The node that was passed in, connected to this volume node'),\n    },\n    state: { volume: TT.Config.desc('The volume node') },\n  };\n  static defaultProps = { volume: 0 };\n\n  onAddToGraph = () => {\n    this.state.volume = new Tone.Volume();\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    ['volume'].forEach(k => {\n      if (!prevProps || newProps[k] !== prevProps[k]) {\n        this.pushToState('volume', { [k]: newProps[k] }, [], [k, 'value']);\n      }\n    });\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if ('node' === edge.toPort && this.state._connectedTo !== edge.id) {\n      logConnect(edge.inDataFor(change), this.state.volume);\n      edge.inDataFor(change).connect(this.state.volume);\n      return this.outKeys();\n    }\n    return [];\n  };\n\n  beforeDisconnectIn: Edge => void = edge => {\n    const name = edge.toPort;\n    if (name === 'node') {\n      const { node } = this.props;\n      if (node) {\n        node.disconnect();\n      }\n    }\n  };\n\n  process = () => ({ out: this.state.volume, node: this.props.node });\n}\n\nexport class CompressorNode extends NodeBase<\n  { compressor: Tone.Compressor, _connectedTo: ?string },\n  { node: Tone.AudioNode, threshold: number, ratio: number },\n  { out: Tone.Compressor, node: Tone.AudioNode }\n> {\n  static +displayName = 'Audio Compressor';\n  static +registryName = 'CompressorNode';\n  static description = (\n    <span>\n      A node which compresses signals from its origin. Compression reduces the volume of loud sounds\n      or amplifies quiet sounds by narrowing or \"compressing\" an audio signal's dynamic range.\n    </span>\n  );\n  static schema = {\n    input: {\n      node: TT.AudioNode.desc('The audio node to connect to this compressor.'),\n      threshold: Types.number.desc('The value above which the compression starts to be applied.'),\n      ratio: Types.number.desc('The gain reduction ratio'),\n    },\n    output: {\n      out: Types.object.aliased('Compressor').desc('The compressor node'),\n      node: TT.AudioNode.desc('The node that was passed in, connected to the compressor'),\n    },\n    state: { compressor: TT.Config.desc('The compressor') },\n  };\n\n  onAddToGraph = () => {\n    this.state.compressor = new Tone.Compressor();\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    ['threshold', 'ratio'].forEach(k => {\n      if (!prevProps || newProps[k] !== prevProps[k]) {\n        this.pushToState('compressor', { [k]: newProps[k] }, [], [k, 'value']);\n      }\n    });\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if ('node' === edge.toPort) {\n      logConnect(edge.inDataFor(change), this.state.compressor);\n      edge.inDataFor(change).connect(this.state.compressor);\n      return this.outKeys();\n    }\n    return [];\n  };\n\n  beforeDisconnectIn: Edge => void = edge => {\n    const name = edge.toPort;\n    if (name === 'node') {\n      const { node } = this.props;\n      if (node) {\n        node.disconnect();\n      }\n    }\n  };\n\n  process = () => ({ out: this.state.compressor, node: this.props.node });\n}\n\nexport class ReverbNode extends NodeBase<\n  { reverb: Tone.Freeverb, _connectedTo: ?string },\n  { node: Tone.AudioNode, dampening: number, roomSize: number },\n  { out: Tone.Freeverb, node: Tone.AudioNode }\n> {\n  static +displayName = 'Reverb';\n  static +registryName = 'ReverbNode';\n  static defaultState = { _connectedTo: null };\n  static description = (\n    <span>\n      A <code>Reverb</code> based on Freeverb (https://ccrma.stanford.edu/~jos/pasp/Freeverb.html).\n    </span>\n  );\n  static schema = {\n    input: {\n      node: TT.AudioNode.desc('The audio node to connect to this reverb node'),\n      dampening: Types.time.desc('The amount of dampening of the reverberant signal'),\n      roomSize: Types.number.desc(\n        'The roomSize value between [0,1]. A larger roomSize will result in a longer decay'\n      ),\n    },\n    output: {\n      out: Types.object.aliased('Reverb').desc('The resulting Reverb Node'),\n      node: TT.AudioNode.desc('The node that was passed in, connected to the reverb'),\n    },\n    state: {},\n  };\n\n  onAddToGraph = () => {\n    this.state.reverb = new Tone.Freeverb();\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    ['dampening', 'roomSize'].forEach(k => {\n      if (!prevProps || newProps[k] !== prevProps[k]) {\n        this.pushToState('reverb', { [k]: newProps[k] }, [], [k, 'value']);\n      }\n    });\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if ('node' === edge.toPort && this.state._connectedTo !== edge.id) {\n      logConnect(edge.inDataFor(change), this.state.reverb);\n      edge.inDataFor(change).connect(this.state.reverb);\n      return this.outKeys();\n    }\n    return [];\n  };\n\n  beforeDisconnectIn: Edge => void = edge => {\n    const name = edge.toPort;\n    if (name === 'node') {\n      const { node } = this.props;\n      if (node) {\n        node.disconnect();\n      }\n    }\n  };\n\n  process = () => ({ out: this.state.reverb, node: this.props.node });\n}\n\nexport class FeedbackDelayNode extends NodeBase<\n  { feedbackDelay: Tone.FeedbackDelay, _connectedTo: ?string },\n  { node: Tone.AudioNode, feedback: Tone.Time, delay: number },\n  { out: Tone.FeedbackDelay, node: Tone.AudioNode }\n> {\n  static +displayName = 'Feedback Delay';\n  static +registryName = 'FeedbackDelayNode';\n  static defaultState = { _connectedTo: null };\n  static description = (\n    <span>\n      A <code>DelayNode</code> in which part of output signal is fed back into the delay\n    </span>\n  );\n  static schema = {\n    input: {\n      node: TT.AudioNode.desc('The audio node to connect to this feedback delay'),\n      delayTime: Types.time.desc('The delay applied to the incoming signal'),\n      feedback: Types.number.desc(\n        'feedback The amount of the effected signal which is fed back through the delay.'\n      ),\n    },\n    output: {\n      out: TT.FeedbackDelay.desc('The resulting FeedbackDelayNode'),\n      node: TT.AudioNode.desc('The node that was passed in, connected to the feedback delay'),\n    },\n    state: {},\n  };\n\n  onAddToGraph = () => {\n    this.state.feedbackDelay = new Tone.FeedbackDelay('16n', 0.2);\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    ['delayTime', 'feedback'].forEach(k => {\n      if (!prevProps || newProps[k] !== prevProps[k]) {\n        this.pushToState('feedbackDelay', { [k]: newProps[k] }, [], [k, 'value']);\n      }\n    });\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if ('node' === edge.toPort && this.state._connectedTo !== edge.id) {\n      logConnect(edge.inDataFor(change), this.state.feedbackDelay);\n      edge.inDataFor(change).connect(this.state.feedbackDelay);\n      return this.outKeys();\n    }\n    return [];\n  };\n\n  beforeDisconnectIn: Edge => void = edge => {\n    const name = edge.toPort;\n    if (name === 'node') {\n      const { node } = this.props;\n      if (node) {\n        node.disconnect();\n      }\n    }\n  };\n\n  process = () => ({ out: this.state.feedbackDelay, node: this.props.node });\n}\n\nexport class AudioDelayNode extends NodeBase<\n  { delay: DelayNode, _connectedTo: ?string },\n  { node: Tone.AudioNode, delayTime: number },\n  { out: DelayNode, node: Tone.AudioNode }\n> {\n  static +displayName = 'Audio Delay';\n  static +registryName = 'AudioDelayNode';\n  // $FlowIssue\n  static defaultState = { _connectedTo: null };\n  static description = (\n    <span>A node which is used to delay the incoming audio signal by a certain amount of time</span>\n  );\n  static schema = {\n    input: {\n      node: TT.AudioNode.desc('The audio node to connect to this feedback delay'),\n      delayTime: Types.number.desc(\n        'An a-rate AudioParam representing the amount of delay to apply'\n      ),\n    },\n    output: {\n      out: TT.AudioNode.desc('The resulting DelayNode'),\n      node: TT.AudioNode.desc('The node that was passed in, connected to the delay'),\n    },\n    state: { delay: TT.AudioNode.desc('The delay node') },\n  };\n\n  onAddToGraph = () => {\n    this.state.delay = Tone.context.createDelay(6.0);\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    if (!prevProps || newProps.delayTime !== prevProps.delayTime) {\n      this.pushToState('delay', { delayTime: newProps.delayTime }, [], ['delayTime', 'value']);\n    }\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if ('node' === edge.toPort && this.state._connectedTo !== edge.id) {\n      logConnect(edge.inDataFor(change), this.state.delay);\n      edge.inDataFor(change).connect(this.state.delay);\n      return this.outKeys();\n    }\n    return [];\n  };\n\n  beforeDisconnectIn: Edge => void = edge => {\n    const name = edge.toPort;\n    if (name === 'node') {\n      const { node } = this.props;\n      if (node) {\n        node.disconnect();\n      }\n    }\n  };\n\n  process = () => ({ out: this.state.delay, node: this.props.node });\n}\n\nexport class AudioGainNode extends NodeBase<\n  { gain: GainNode, _connectedTo: ?string },\n  { node: Tone.AudioNode, gain: number },\n  { gain: GainNode, node: Tone.AudioNode }\n> {\n  static +displayName = 'Audio Gain';\n  static +registryName = 'AudioGainNode';\n  static defaultState = { _connectedTo: null };\n  static description = (\n    <span>\n      The GainNode interface represents a change in volume. It is an AudioNode audio-processing\n      module that causes a given gain to be applied to the input data before its propagation to the\n      output\n    </span>\n  );\n  static schema = {\n    input: {\n      node: TT.AudioNode.desc('The audio node to connect to this feedback delay'),\n      gain: Types.number.desc('An a-rate AudioParam representing the amount of gain to apply'),\n    },\n    output: {\n      gain: TT.Gain.desc('The resulting GainNode'),\n      node: TT.AudioNode.desc('The node that was passed in, connected to the gain'),\n    },\n    state: { gain: TT.Gain.desc('The gain node') },\n  };\n\n  onAddToGraph = () => {\n    this.state.gain = Tone.context.createGain();\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    if (!prevProps || newProps.gain !== prevProps.gain) {\n      this.pushToState('gain', { gain: newProps.gain }, [], ['gain', 'value']);\n    }\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if ('node' === edge.toPort && this.state._connectedTo !== edge.id) {\n      logConnect(edge.inDataFor(change), this.state.gain);\n      edge.inDataFor(change).connect(this.state.gain);\n      return this.outKeys();\n    }\n    return [];\n  };\n\n  beforeDisconnectIn: Edge => void = edge => {\n    const name = edge.toPort;\n    if (name === 'node') {\n      const { node } = this.props;\n      if (node) {\n        node.disconnect();\n      }\n    }\n  };\n\n  process = () => ({ gain: this.state.gain, node: this.props.node });\n}\n\nexport class AttackReleaseNode extends NodeBase<\n  {},\n  { synth: Tone.Synth, note: Tone.Frequency, duration: ?Tone.Time, time: Tone.Time, call: any },\n  { draw: { note: Tone.Frequency, duration: Tone.Time } }\n> {\n  static +displayName = 'Attack-Release';\n  static +registryName = 'AttackReleaseNode';\n  static description = (\n    <span>\n      Trigger the attack and then the release after the duration. Omitting a duration and calling{' '}\n      <code>call</code> results in an attack without release.\n    </span>\n  );\n  static schema = {\n    input: {\n      synth: TT.Synth.desc('The synth to use'),\n      note: TT.Note.desc('The frequency to play'),\n      duration: Types.time.desc('The duration to play the note for'),\n      time: Types.time.desc('When the note should be triggered'),\n      call: TT.Call,\n    },\n    output: {\n      draw: Types.object.desc(\n        'An note / duration object that is signalled when this node triggers its attack'\n      ),\n    },\n    state: {},\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if ('call' === edge.toPort) {\n      if (edge.inDataFor(change)) {\n        const { synth, note, duration, time } = this.props;\n        if (synth && note && duration) {\n          if (time) {\n            synth.triggerAttackRelease(note, duration, time);\n            Tone.Draw.schedule(() => {\n              this.notifyAllOutputs();\n            }, time);\n          } else {\n            synth.triggerAttackRelease(note, duration);\n            return this.outKeys();\n          }\n        } else if (synth && note) {\n          if (time) {\n            synth.triggerAttack(note, time);\n            Tone.Draw.schedule(() => {\n              this.notifyAllOutputs();\n            }, time);\n          } else {\n            synth.triggerAttack(note);\n            return this.outKeys();\n          }\n        }\n      }\n    }\n    // Return no updates here, since out signals will happen in the scheduled draw callback if not played now\n    return [];\n  };\n\n  process = () => ({ draw: this.props });\n}\n\nexport class PlayerNode extends NodeBase<{}, { url: string, call: any }, { player: Tone.Player }> {\n  static +displayName = 'Remote Player';\n  static +registryName = 'PlayerNode';\n  static description = <span>Play a sound file from a remote source</span>;\n  static schema = {\n    input: {\n      url: Types.string.aliased('url').desc('the url to fetch the sound file from.'),\n      call: TT.Call,\n      loop: Types.boolean.desc('Whether or not the player should loop its contents indefinitely'),\n    },\n    output: { player: Types.object.aliased('Player').desc('The player node') },\n    state: {},\n  };\n  _loaded: string = '';\n  _player: Tone.Player = new Tone.Player();\n\n  _makePlayer = (url: string) => {\n    if (url.startsWith('/')) {\n      url = URL_BASE + url;\n    }\n    this._player = new Tone.Player(url, () => {\n      this.notifyAllOutputs(true);\n      this._loaded = url;\n      this._checkStarted();\n    });\n    this._player.autostart = false;\n    this._setPlayerAttrs();\n  };\n\n  _setPlayerAttrs = () => {\n    ['loop'].forEach(k => (this._player[k] = get(this.props, k)));\n  };\n\n  _checkStarted = () => {\n    if (this.props.call && this._loaded && this._player.state !== 'started') {\n      this._player.start();\n    }\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    if (newProps.url && (!prevProps || newProps.url !== prevProps.url)) {\n      if (this._loaded !== newProps.url) {\n        this._makePlayer(newProps.url);\n      }\n    }\n    this._checkStarted();\n    this._setPlayerAttrs();\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    return this.outKeys();\n  };\n\n  process = () => ({ player: this._player });\n}\n\nexport class SetNoteNode extends NodeBase<\n  {},\n  { synth: Tone.Synth, note: Tone.Frequency, time: Tone.Time, call: any },\n  null\n> {\n  static +displayName = 'Set Note';\n  static +registryName = 'SetNoteNode';\n  static description = <span>Set the note for a Synth</span>;\n  static schema = {\n    input: {\n      synth: TT.Synth.desc('The synth to use'),\n      note: TT.Note.desc('The frequency to set on the synth'),\n      time: Types.time.desc('Time which the note should be set on the synth'),\n      call: TT.Call,\n    },\n    output: {},\n    state: {},\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if ('call' === edge.toPort) {\n      if (edge.inDataFor(change)) {\n        const { synth, note, time } = this.props;\n        if (synth && note) {\n          if (synth.setNote) {\n            synth.setNote(note, time || undefined);\n          } else if (synth.voices) {\n            synth.voices.forEach(v => v.setNote(note, time || undefined));\n          }\n          time && Tone.Draw.schedule(this.notifyAllOutputs, time);\n        }\n      }\n    }\n    return [];\n  };\n\n  process = () => null;\n}\n\nexport class ArpeggiateNode extends NodeBase<\n  {},\n  {\n    pattern: string,\n    notes: string[],\n    humanize: boolean | number,\n    interval: Tone.Time,\n  },\n  { note: string, time: Tone.Time }\n> {\n  static +displayName = 'Arpeggiate';\n  static +registryName = 'ArpeggiateNode';\n  static defaultProps = {\n    interval: '1m',\n    pattern: 'upDown',\n    notes: [],\n    humanize: false,\n  };\n  static description = <span>Arpeggiate between the given notes in a number of patterns</span>;\n  pattern: Tone.Pattern;\n  // $FlowIssue\n  _out: { note: string, time: Tone.Time } = {};\n  static schema = {\n    input: {\n      notes: arrayOf(TT.Note).desc('Notes to arpeggiate over'),\n      interval: Types.time.desc('The interval at which this node loops'),\n      pattern: Types.string\n        .aliased(\n          'Pattern',\n          <div>\n            <p>Arpeggio pattern. Possible values are</p>\n            <ul>\n              <li>`up` - cycles upward</li> <li>`down` - cycles downward</li>\n              <li>`upDown` - up then and down</li> <li>`downUp` - cycles down then and up</li>\n              <li>`alternateUp` - jump up two and down one</li>\n              <li>`alternateDown` - jump down two and up one</li>\n              <li>`random` - randomly select an index</li>\n              <li>`randomWalk` - randomly moves one index away from the current position</li>\n              <li>\n                `randomOnce` - randomly select an index without repeating until all values have been\n                chosen.\n              </li>\n            </ul>\n          </div>\n        )\n        .desc('The arpeggiation pattern. See the `Pattern` type for options.'),\n      humanize: Types.boolean.desc(\n        'Random variation +/-0.01s to the scheduled time. Or give it a time value which it will randomize by'\n      ),\n      probability: Types.number.desc('probability that each iteration will play, [0,1]'),\n    },\n    output: {\n      note: TT.Note.desc('The note'),\n      time: Types.time.desc('Time accompanying the note'),\n    },\n    state: {},\n  };\n\n  onAddToGraph = () => {\n    this.pattern = new Tone.Pattern((time, note) => {\n      this._out = { note, time };\n      this.notifyOutputs(this.outKeys(), true);\n    }, this.props.notes);\n    Tone.Transport.on('start', this._manageLoop);\n  };\n\n  _manageLoop = () => {\n    if (this.pattern.state !== 'started' && Tone.Transport.state === 'started') {\n      this.pattern.start();\n    }\n  };\n\n  willReceiveProps = (newProps: Object) => {\n    ['humanize', 'interval', 'pattern', 'probability'].forEach(k => {\n      this.pattern[k] = newProps[k];\n    });\n    if (newProps.notes) {\n      this.pattern.values = newProps.notes;\n    }\n  };\n\n  process = () => {\n    this._manageLoop();\n    return this._out;\n  };\n}\n\nexport class TimeLoopNode extends NodeBase<\n  {},\n  {\n    interval: Tone.Time,\n    playbackRate: Tone.Time,\n    iterations: number,\n    mute: boolean,\n    humanize: boolean | number,\n  },\n  { i: number }\n> {\n  static +displayName = 'Time Loop';\n  static +registryName = 'TimeLoopNode';\n  static defaultProps = {\n    playbackRate: 1,\n    iterations: Infinity,\n    mute: false,\n    humanize: false,\n  };\n  static description = <span>Set the note for a Synth</span>;\n  loop: Tone.Loop;\n  count: number = 0;\n  static schema = {\n    input: {\n      interval: Types.time.desc('The interval at which this node loops'),\n      playbackRate: Types.number.desc(\n        'The playback rate of the loop. The normal playback rate is 1 (no change). A playbackRate of 2 would be twice as fast'\n      ),\n      iterations: Types.number.desc(\n        'The number of iterations of the loop. The default value is Infinity (loop eternally)'\n      ),\n      mute: Types.boolean.desc('Muting the Loop means that no callbacks are invoked'),\n      humanize: Types.boolean.desc(\n        'Random variation +/-0.01s to the scheduled time. Or give it a time value which it will randomize by'\n      ),\n    },\n    output: {\n      i: Types.number.desc('The number of times this node has looped so far.'),\n    },\n    state: {},\n  };\n\n  onAddToGraph = () => {\n    this.loop = new Tone.Loop(() => {\n      this.count += 1;\n      this.notifyOutputs(this.outKeys(), true);\n    }, this.props.interval);\n    Tone.Transport.on('start', this._manageLoop);\n  };\n\n  _recreateLoop = () => {\n    this.loop && this.loop.dispose();\n    this.count = 0;\n    this.loop = new Tone.Loop(() => {\n      this.count += 1;\n      this.notifyOutputs(this.outKeys(), true);\n    }, this.props.interval);\n  };\n\n  _manageLoop = () => {\n    if (\n      this.props.interval &&\n      this.loop.state !== 'started' &&\n      Tone.Transport.state === 'started'\n    ) {\n      this.loop.start();\n    }\n  };\n\n  requireForOutput = () => typeof this.props.interval !== 'undefined';\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if (['humanize', 'loop', 'iterations', 'playbackRate'].includes(edge.toPort)) {\n      this._recreateLoop();\n      this.loop[edge.toPort] = edge.inDataFor(change);\n      return this.outKeys();\n    } else if (edge.toPort === 'interval') {\n      this._recreateLoop();\n      return this.outKeys();\n    }\n    return [];\n  };\n\n  process = () => {\n    this._manageLoop();\n    return { i: this.count };\n  };\n}\n\nexport class SynthNode extends NodeBase<\n  { value: Tone.DuoSynth },\n  { volume: number, oscillator: Object, envelope: Object },\n  { out: Tone.DuoSynth }\n> {\n  static fwdSignals = ['frequency', 'volume'];\n  static +displayName = 'Synth';\n  static +registryName = 'SynthNode';\n  static defaultEnv = {};\n  static defaultProps = { volume: 0, envelope: SynthNode.defaultEnv };\n  static description = (\n    <span>A Synth is composed by routing an OmniOscillator through a AmplitudeEnvelope.</span>\n  );\n\n  static schema = {\n    input: {\n      volume: Types.number.desc('The volume of the output in decibels'),\n      oscillator: Types.string\n        .aliased(\n          'OscillatorType',\n          <div>\n            The type of the oscillator: either sine, square, triangle, or sawtooth. Also capable of\n            setting the first x number of partials of the oscillator. For example: `sine4` would set\n            be the first 4 partials of the sine wave and `triangle8` would set the first 8 partials\n            of the triangle wave.\n          </div>\n        )\n        .desc('The type of oscillator'),\n      envelope: Types.object\n        .aliased(\n          'AmplitudeEnvelope',\n          <div>\n            AmplitudeEnvelope is an Envelope connected to a gain node. Unlike Envelope, which\n            outputs the envelope’s value, AmplitudeEnvelope accepts an audio signal as the input and\n            will apply the envelope to the amplitude of the signal.\n          </div>\n        )\n        .desc('The amplitude envelope for this synth'),\n    },\n    output: { out: TT.Synth.desc('Resulting Synth') },\n    state: { value: TT.Synth.desc('The synth') },\n  };\n\n  onAddToGraph = () => {\n    this.state.value = SynthNode.defaultSynth();\n  };\n\n  _recreateSynth = () => {\n    this.state.value && this.state.value.dispose();\n    this.state.value = new Tone.Synth({\n      oscillator: { type: this.props.oscillator },\n      envelope: this.props.envelope,\n    });\n  };\n\n  willBecomeLive = () => {\n    this._recreateSynth();\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object, manual: boolean) => {\n    if (manual) {\n      SynthNode.fwdSignals.forEach(k => {\n        if (!prevProps || newProps[k] !== prevProps[k]) {\n          this.pushToState('value', { [k]: newProps[k] }, [], [k, 'value']);\n        }\n      });\n    }\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if (SynthNode.fwdSignals.includes(edge.toPort)) {\n      const changed = this.pushToState('value', change, [], [edge.toPort, 'value']);\n      return changed ? this.outKeys() : [];\n    }\n    if (\n      ['envelope', 'oscillator'].includes(edge.toPort) &&\n      this.props.envelope &&\n      this.props.oscillator\n    ) {\n      this._recreateSynth();\n    }\n    return [];\n  };\n\n  process = () => {\n    return { out: this.state.value };\n  };\n\n  static defaultSynth() {\n    return new Tone.Synth({ oscillator: { type: 'sawtooth' }, envelope: SynthNode.defaultEnv });\n  }\n}\n\nexport class DuoSynthNode extends NodeBase<{ value: Tone.DuoSynth }, {}, { out: Tone.DuoSynth }> {\n  static fwdSignals = ['frequency', 'harmonicity', 'volume', 'vibratoAmount', 'vibratoRate'];\n  static +displayName = 'DuoSynth';\n  static +registryName = 'DuoSynthNode';\n  static description = (\n    <span>\n      A DuoSynth is a monophonic synth composed of two <code>MonoSynths</code> run in parallel with\n      control over the frequency ratio between the two voices and vibrato effect.\n    </span>\n  );\n\n  static schema = {\n    input: {\n      frequency: Types.number.desc('The frequency control'),\n      volume: Types.number.desc('The volume of the output in decibels'),\n      harmonicity: Types.number.desc(\n        'Harmonicity is the ratio between the two voices. A harmonicity of 1 is no change. Harmonicity = 2 means a change of an octave.'\n      ),\n      vibratoAmount: Types.number.desc('The amount of vibrato'),\n      vibratoRate: Types.number.desc('The frequency of vibrato'),\n    },\n    output: { out: TT.Synth.desc('Resulting Synth') },\n    state: { value: TT.Synth.desc('The synth') },\n  };\n\n  static shortNames = {\n    vibratoAmount: 'vibrato',\n    vibratoRate: 'vibratoF',\n    harmonicity: 'ratio',\n    frequency: 'freq',\n  };\n\n  onAddToGraph = () => {\n    this.state.value = DuoSynthNode.defaultSynth();\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object, manual: boolean) => {\n    if (manual) {\n      DuoSynthNode.fwdSignals.forEach(k => {\n        if (!prevProps || newProps[k] !== prevProps[k]) {\n          this.pushToState('value', { [k]: newProps[k] }, [], [k, 'value']);\n        }\n      });\n    }\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if (DuoSynthNode.fwdSignals.includes(edge.toPort)) {\n      this.pushToState('value', change, [], [edge.toPort, 'value']);\n      return [];\n    }\n    return [];\n  };\n\n  process = () => {\n    return { out: this.state.value };\n  };\n\n  static defaultSynth() {\n    let envelope = { attack: 0.8, release: 4, releaseCurve: 'linear' };\n    let filterEnvelope = {\n      baseFrequency: 200,\n      octaves: 2,\n      attack: 0,\n      decay: 0,\n      release: 1000,\n    };\n    const synthOpts = {\n      harmonicity: 1,\n      volume: -20,\n      voice0: { oscillator: { type: 'sawtooth' }, envelope, filterEnvelope },\n      voice1: { oscillator: { type: 'sine' }, envelope, filterEnvelope },\n      vibratoRate: 0.5,\n      vibratoAmount: 0.1,\n    };\n    return new Tone.DuoSynth(synthOpts);\n  }\n}\n\nexport class PianoNode extends NodeBase<{}, {}, { out: Piano }> {\n  piano: Piano;\n  loaded: boolean = false;\n  static +displayName = 'Piano';\n  static +registryName = 'PianoNode';\n  static description = <span>A virtual Salamander grand piano as a Tone Node</span>;\n\n  static schema = {\n    input: {},\n    output: { out: TT.AudioNode.desc('A piano node') },\n    state: {},\n  };\n\n  onAddToGraph = () => {\n    this.piano = new Piano({ velocities: 4 });\n    this.piano.load('https://storage.googleapis.com/learnjs-data/Piano/Salamander/').then(() => {\n      this.loaded = true;\n    });\n  };\n\n  process = () => {\n    return { out: this.piano };\n  };\n}\n\nexport class TransportTimeNode extends NodeBase<{}, { bpm: number }, { out: Tone.Transport }> {\n  static +displayName = 'Transport Time';\n  static +registryName = 'TransportTimeNode';\n  static defaultProps = { bpm: 120 };\n  static description = (\n    <span>\n      Transport for timing musical events. Supports tempo curves and time changes. Unlike event-loop\n      timing (IntervalNode), events backed by this scheduler need to specify the exact time of their\n      schedules. <br /> <br /> It is useful to think of there only being one governing Transport\n      Time for your whole graph, i.e. don't define more than one of these, or if you do, recognize\n      that you are modifying a single global transport time.\n    </span>\n  );\n\n  static schema = {\n    input: {\n      bpm: Types.number.desc(\n        'The tempo to set for this transport. See the docs on the time type to understand how time can be expressed in terms of metered time.'\n      ),\n    },\n    output: { out: Types.object.desc('Resulting transport') },\n    state: {},\n  };\n\n  _notifyOut = () => {\n    setTimeout(() => this.notifyAllOutputs(true));\n  };\n\n  onAddToGraph = () => {\n    Tone.Transport.on('start', this._notifyOut);\n    Tone.Transport.on('stop', this._notifyOut);\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object, manual: boolean) => {\n    if (manual) {\n      if (!prevProps || newProps['bpm'] !== prevProps['bpm']) {\n        Tone.Transport.bpm.value = newProps.bpm;\n      }\n    }\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if (edge.toPort === 'bpm') {\n      Tone.Transport.bpm.value = edge.inDataFor(change);\n      return this.outKeys();\n    }\n    return [];\n  };\n\n  process = () => {\n    return { out: Tone.Transport };\n  };\n}\n\nexport class StartTransportNode extends NodeBase<{}, { transport: Tone.Transport }, null> {\n  static +displayName = 'Start Transport';\n  static +registryName = 'StartTransportNode';\n  static description = (\n    <span>Start a transport time. This will put all Transport time schedules into motion</span>\n  );\n  static schema = {\n    input: { transport: Types.object.desc('The Transport Time to start') },\n    output: {},\n    state: {},\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if (edge.toPort === 'transport') {\n      const transport = edge.inDataFor(change);\n      if (transport && transport.state !== 'started') {\n        setTimeout(() => transport.start('+1'), 1);\n      }\n    }\n    return [];\n  };\n\n  _stopTime = () => {\n    const { transport } = this.props;\n    if (transport) {\n      transport.stop();\n    }\n  };\n\n  beforeDisconnectIn: Edge => void = edge => {\n    const name = edge.toPort;\n    if (name === 'transport') {\n      this._stopTime();\n    }\n  };\n\n  willBeRemoved = () => {\n    this._stopTime();\n  };\n\n  process = () => {\n    return null;\n  };\n}\n\nfunction logConnect(f, to) {\n  const fromName = f.constructor.name || f.__proto__.toString();\n  const toName = to.constructor.name || to.__proto__.toString();\n  get(window, '$logConnect') && console.log('connect', fromName, toName);\n}\n","// @flow\nimport * as tf from '@tensorflow/tfjs-core';\nimport Tone from 'tone';\nimport 'regenerator-runtime/runtime';\n\nconst STEPS_PER_GENERATE_CALL = 10;\nconst GENERATION_BUFFER_SECONDS = 0.5;\nconst MAX_GENERATION_LAG_SECONDS = 1;\nconst MAX_NOTE_DURATION_SECONDS = 3;\n\nconst NOTES_PER_OCTAVE = 12;\nconst DENSITY_BIN_RANGES = [1.0, 2.0, 4.0, 8.0, 16.0, 32.0, 64.0];\nconst PITCH_HISTOGRAM_SIZE = NOTES_PER_OCTAVE;\nconst RESET_RNN_FREQUENCY_MS = 20000;\nconst MIN_MIDI_PITCH = 0;\nconst MAX_MIDI_PITCH = 127;\nconst VELOCITY_BINS = 32;\nconst MAX_SHIFT_STEPS = 100;\n\nexport const MIDI_EVENT_ON = 0x90;\nexport const MIDI_EVENT_OFF = 0x80;\nconst EVENT_RANGES = [\n  ['note_on', MIN_MIDI_PITCH, MAX_MIDI_PITCH],\n  ['note_off', MIN_MIDI_PITCH, MAX_MIDI_PITCH],\n  ['time_shift', 1, MAX_SHIFT_STEPS],\n  ['velocity_change', 1, VELOCITY_BINS],\n];\nconst GAIN = 80;\n\nconst calculateEventSize = () => {\n  let eventOffset = 0;\n  for (const eventRange of EVENT_RANGES) {\n    const minValue = eventRange[1];\n    const maxValue = eventRange[2];\n    eventOffset += maxValue - minValue + 1;\n  }\n  return eventOffset;\n};\nconst URL_BASE = process.env.PUBLIC_URL || '';\n\nconst EVENT_SIZE = calculateEventSize();\nconst PRIMER_IDX = 355;\nconst CHECKPOINT_URL = URL_BASE + '/latent/performance';\n\nexport const pentatonic = [0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0];\nexport const cMajor = [2, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1];\nexport const fMajor = [1, 0, 1, 0, 1, 2, 0, 1, 0, 1, 1, 0];\nexport const dMinor = [1, 0, 2, 0, 1, 1, 0, 1, 0, 1, 1, 0];\n\nconst notes = ['c', 'c#', 'd', 'd#', 'e', 'f', 'f#', 'g', 'g#', 'a', 'a#', 'b'];\nconst map = {};\nfor (let i = 0; i < 128; i++) {\n  map[i] = notes[i % 12];\n}\n\nexport type ToneAction = 'attack' | 'release' | 'attackRelease';\n// [event, note, velocity]\nexport type MidiData = [number, number, number];\n\nexport default class Performance {\n  // midi num -> velocity\n  velocityMapListener: ?(Map<number, number>) => void = null;\n  midiListener: ?(midiData: MidiData, time: number) => void = null;\n  toneListener: ?(\n    note: Tone.Frequency,\n    action: ToneAction,\n    time: Tone.Time,\n    normalizedVelocity?: number\n  ) => void = null;\n  velocityMapListener: (Map<number, number>) => void;\n  activeVelocities = new Map<number, number>();\n  activeNotes = new Map<number, number>();\n  forgetBias = tf.scalar(1.0);\n\n  lstmKernel1: tf.Tensor2D;\n  lstmBias1: tf.Tensor1D;\n  lstmKernel2: tf.Tensor2D;\n  lstmBias2: tf.Tensor1D;\n  lstmKernel3: tf.Tensor2D;\n  lstmBias3: tf.Tensor1D;\n  c: tf.Tensor2D[];\n  h: tf.Tensor2D[];\n  fcB: tf.Tensor1D;\n  fcW: tf.Tensor2D;\n  pitchHistArray: number[] = pentatonic;\n  pitchHistogram: tf.Tensor1D;\n  noteDensityBucket: number = 1;\n  stepsPerSecond: number = 100;\n  noteDensityEncoding: tf.Tensor1D;\n  currentTime = 0;\n  startTime = 0;\n  currentVelocity = 100;\n  currentLoopId = 0;\n  lastSample = tf.scalar(PRIMER_IDX, 'int32');\n  initialized = false;\n  modelReady = false;\n  intervalId: ?TimeoutID;\n  generationInterval: ?TimeoutID;\n  stopped = false;\n\n  start = () => {\n    if (this.initialized) {\n      return;\n    }\n    this.initialized = true;\n    Tone.Transport.start();\n    fetch(`${CHECKPOINT_URL}/weights_manifest.json`)\n      .then(response => response.json())\n      .then((manifest: tf.WeightsManifestConfig) => tf.io.loadWeights(manifest, CHECKPOINT_URL))\n      .then((vars: { [varName: string]: tf.Tensor }) => {\n        this.lstmKernel1 = vars['rnn/multi_rnn_cell/cell_0/basic_lstm_cell/kernel'];\n        this.lstmBias1 = vars['rnn/multi_rnn_cell/cell_0/basic_lstm_cell/bias'];\n        this.lstmKernel2 = vars['rnn/multi_rnn_cell/cell_1/basic_lstm_cell/kernel'];\n        this.lstmBias2 = vars['rnn/multi_rnn_cell/cell_1/basic_lstm_cell/bias'];\n        this.lstmKernel3 = vars['rnn/multi_rnn_cell/cell_2/basic_lstm_cell/kernel'];\n        this.lstmBias3 = vars['rnn/multi_rnn_cell/cell_2/basic_lstm_cell/bias'];\n        this.fcB = vars['fully_connected/biases'];\n        this.fcW = vars['fully_connected/weights'];\n        this.modelReady = true;\n        this.resetRnn();\n      })\n      .then(() => {\n        setTimeout(() => this.resetRnnRepeatedly(), RESET_RNN_FREQUENCY_MS);\n      });\n    this.refreshConditioning();\n  };\n\n  setTempo = (sps: number) => {\n    this.stepsPerSecond = sps;\n  };\n\n  cleanup = () => {\n    if (this.intervalId) {\n      clearTimeout(this.intervalId);\n    }\n    if (this.generationInterval) {\n      clearTimeout(this.generationInterval);\n    }\n    this.stopped = true;\n  };\n\n  refreshConditioning = () => {\n    if (this.noteDensityEncoding != null) {\n      this.noteDensityEncoding.dispose();\n      this.noteDensityEncoding = null;\n    }\n    this.noteDensityEncoding = tf\n      .oneHot(tf.tensor1d([this.noteDensityBucket], 'int32'), DENSITY_BIN_RANGES.length + 1)\n      .as1D();\n    if (this.pitchHistogram != null) {\n      this.pitchHistogram.dispose();\n      this.pitchHistogram = null;\n    }\n    const buffer = tf.buffer([PITCH_HISTOGRAM_SIZE], 'float32');\n    const pitchHistogramTotal = this.pitchHistArray.reduce((prev, val) => prev + val, 0);\n    for (let i = 0; i < PITCH_HISTOGRAM_SIZE; i++) {\n      buffer.set(this.pitchHistArray[i] / pitchHistogramTotal, i);\n    }\n    this.pitchHistogram = buffer.toTensor();\n  };\n\n  resetRnn = () => {\n    this.c = [\n      tf.zeros([1, this.lstmBias1.shape[0] / 4]),\n      tf.zeros([1, this.lstmBias2.shape[0] / 4]),\n      tf.zeros([1, this.lstmBias3.shape[0] / 4]),\n    ];\n    this.h = [\n      tf.zeros([1, this.lstmBias1.shape[0] / 4]),\n      tf.zeros([1, this.lstmBias2.shape[0] / 4]),\n      tf.zeros([1, this.lstmBias3.shape[0] / 4]),\n    ];\n    if (this.lastSample != null) {\n      this.lastSample.dispose();\n    }\n    this.lastSample = tf.scalar(PRIMER_IDX, 'int32');\n    this.currentTime = Tone.now();\n    this.startTime = performance.now() - this.currentTime * 1000;\n    this.currentLoopId++;\n    // todo await\n    this.generateStep(this.currentLoopId);\n  };\n\n  getConditioning = () => {\n    return tf.tidy(() => {\n      const axis = 0;\n      const conditioning = this.noteDensityEncoding.concat(this.pitchHistogram, axis);\n      return tf.tensor1d([0], 'int32').concat(conditioning, axis);\n    });\n  };\n\n  getOutputs = () => {\n    const lstm1 = (data, c, h) =>\n      tf.basicLSTMCell(this.forgetBias, this.lstmKernel1, this.lstmBias1, data, c, h);\n    const lstm2 = (data, c, h) =>\n      tf.basicLSTMCell(this.forgetBias, this.lstmKernel2, this.lstmBias2, data, c, h);\n    const lstm3 = (data, c, h) =>\n      tf.basicLSTMCell(this.forgetBias, this.lstmKernel3, this.lstmBias3, data, c, h);\n\n    const [_c, _h, outputs] = tf.tidy(() => {\n      // Generate some notes.\n      const innerOuts: tf.Scalar[] = [];\n      for (let i = 0; i < STEPS_PER_GENERATE_CALL; i++) {\n        // Use last sampled output as the next input.\n        const eventInput = tf.oneHot(this.lastSample.as1D(), EVENT_SIZE).as1D();\n        // Dispose the last sample from the previous generate call, since we\n        // kept it.\n        if (i === 0) {\n          this.lastSample.dispose();\n        }\n        const conditioning = this.getConditioning();\n        const axis = 0;\n        const input = conditioning.concat(eventInput, axis).toFloat();\n        const output = tf.multiRNNCell([lstm1, lstm2, lstm3], input.as2D(1, -1), this.c, this.h);\n        this.c.forEach(c => c.dispose());\n        this.h.forEach(h => h.dispose());\n        this.c = output[0];\n        this.h = output[1];\n        const outputH = this.h[2];\n        const logits = outputH.matMul(this.fcW).add(this.fcB);\n        const sampledOutput = tf.multinomial(logits.as1D(), 1).asScalar();\n        innerOuts.push(sampledOutput);\n        this.lastSample = sampledOutput;\n      }\n      return [this.c, this.h, innerOuts];\n    });\n    this.c = _c;\n    this.h = _h;\n    return outputs;\n  };\n\n  generateStep = async (loopId: number) => {\n    if (loopId < this.currentLoopId) return;\n    const outputs = this.getOutputs();\n    for (let i = 0; i < outputs.length; i++) {\n      this.playOutput(outputs[i].dataSync()[0]);\n    }\n    if (Tone.now() - this.currentTime > MAX_GENERATION_LAG_SECONDS) {\n      this.currentTime = Tone.now();\n    }\n    const delta = Math.max(0, this.currentTime - Tone.now() - GENERATION_BUFFER_SECONDS);\n    this.generationInterval = setTimeout(() => this.generateStep(loopId), delta * 1000);\n  };\n\n  playOutput = (index: number) => {\n    if (this.stopped) return;\n    let offset = 0;\n    for (const eventRange of EVENT_RANGES) {\n      const eventType = eventRange[0];\n      const minValue = eventRange[1];\n      const maxValue = eventRange[2];\n      if (offset <= index && index <= offset + maxValue - minValue) {\n        if (eventType === 'note_on') {\n          const noteNum = index - offset;\n          this.activeNotes.set(noteNum, this.currentTime);\n          this.activeVelocities.set(noteNum, this.currentVelocity * GAIN);\n          this.velocityMapListener && this.velocityMapListener(this.activeVelocities);\n          this.midiListener &&\n            // $FlowIssue - not sure\n            this.midiListener(\n              [MIDI_EVENT_ON, noteNum, this.currentVelocity * GAIN],\n              Math.floor(1000 * this.currentTime) - this.startTime\n            );\n          this.toneListener &&\n            // $FlowIssue - not sure\n            this.toneListener(\n              Tone.Frequency(noteNum, 'midi'),\n              'attack',\n              this.currentTime,\n              (this.currentVelocity * GAIN) / 100\n            );\n          return;\n        } else if (eventType === 'note_off') {\n          const noteNum = index - offset;\n          const activeNoteEndTimeSec = this.activeNotes.get(noteNum);\n          if (activeNoteEndTimeSec === null || activeNoteEndTimeSec === undefined) {\n            return;\n          }\n          const timeSec = Math.max(this.currentTime, activeNoteEndTimeSec + 0.5);\n          this.midiListener &&\n            // $FlowIssue - not sure\n            this.midiListener(\n              [MIDI_EVENT_OFF, noteNum, this.currentVelocity * GAIN],\n              Math.floor(timeSec * 1000) - this.startTime\n            );\n          this.toneListener &&\n            // $FlowIssue - not sure\n            this.toneListener(\n              Tone.Frequency(noteNum, 'midi'),\n              'release',\n              this.currentTime,\n              (this.currentVelocity * GAIN) / 100\n            );\n          this.activeNotes.delete(noteNum);\n          this.activeVelocities.delete(noteNum);\n          this.velocityMapListener && this.velocityMapListener(this.activeVelocities);\n          return;\n        } else if (eventType === 'time_shift') {\n          this.currentTime += (index - offset + 1) / this.stepsPerSecond;\n          this.activeNotes.forEach((timeSec, noteNum) => {\n            if (this.currentTime - timeSec > MAX_NOTE_DURATION_SECONDS) {\n              this.midiListener &&\n                // $FlowIssue - not sure\n                this.midiListener([MIDI_EVENT_OFF, noteNum, this.currentVelocity * GAIN]);\n              this.toneListener &&\n                // $FlowIssue - not sure\n                this.toneListener(Tone.Frequency(noteNum, 'midi'), 'release', this.currentTime);\n              this.activeNotes.delete(noteNum);\n              this.activeVelocities.delete(noteNum);\n              this.velocityMapListener && this.velocityMapListener(this.activeVelocities);\n            }\n          });\n          return this.currentTime;\n        } else if (eventType === 'velocity_change') {\n          this.currentVelocity = (index - offset + 1) * Math.ceil(127 / VELOCITY_BINS);\n          this.currentVelocity = this.currentVelocity / 127;\n          return this.currentVelocity;\n        } else {\n          throw new Error('Could not decode eventType: ' + eventType);\n        }\n      }\n      offset += maxValue - minValue + 1;\n    }\n    throw new Error(`Could not decode index: ${index}`);\n  };\n\n  resetRnnRepeatedly = () => {\n    if (this.stopped) return;\n    if (this.modelReady) this.resetRnn();\n    this.intervalId = setTimeout(() => this.resetRnnRepeatedly(), RESET_RNN_FREQUENCY_MS);\n  };\n}\n","// @flow\nimport React from 'react';\nimport { compact } from 'lodash';\nimport Tone from 'tone';\nimport NodeBase from 'models/NodeBase';\nimport Edge from 'models/Edge';\nimport Performance from 'performance';\nimport { TT as ToneTypes } from 'models/nodes/ToneNode';\nimport type { MidiData, ToneAction } from 'performance';\nconst Piano = require('tone-piano').Piano;\nconst Types = window.Types;\n\nexport const TT = {\n  HistType: Types.any.aliased(\n    'PitchHistogram',\n    <div>\n      <p>\n        A scale represented as a distribution of pitch classes. Valid inputs are either an array of\n        numbers (len 12), or a single string of len 12 that describes relative semitone\n        distributions (ranged 0-9). 0-indexed at C.\n      </p>\n      <p>\n        e.g. <code>F Major</code> could be either array:{' '}\n        <code>[1, 0, 1, 0, 1, 2, 0, 1, 0, 1, 1, 0]</code> or string:\n        <code>\"101012010110\"</code>\n      </p>\n    </div>\n  ),\n  ToneData: Types.object.aliased('ToneData', 'Directives for an instrument / synth to play.'),\n  MidiData: Types.object.aliased(\n    'MidiData',\n    'Midi signal. Usually a note, action, velocity, and channel information'\n  ),\n};\nexport type ToneData = [Tone.Frequency, ToneAction, Tone.Time, ?number];\n\nexport class PerformanceRNNNode extends NodeBase<\n  {},\n  {\n    density: number,\n    synth: Tone.Synth | Tone.Instrument,\n    stepsPerSecond: number,\n  },\n  {\n    midiData: [MidiData, number],\n    toneData: ToneData,\n  }\n> {\n  static +displayName = 'Music RNN';\n  static +registryName = 'PerformanceRNNNode';\n  static defaultProps = { stepsPerSecond: 100 };\n  static description = (\n    <span>Sample an RNN model trained on the Yamaha e-Piano Competition dataset</span>\n  );\n  static schema = {\n    input: {\n      scale: TT.HistType.desc(\n        'This pitch distribution will be used as a tonic to condition this model'\n      ),\n      density: Types.number.desc(\n        'A density conditioning variable between 0-6 that serves as a directive for how many notes will be generated per step, in exponential scale. i.e. notes generated per step will be 2^density'\n      ),\n      stepsPerSecond: Types.number.desc(\n        'number of steps per second. effectively a tempo measure for note generation / playback'\n      ),\n      synth: ToneTypes.Synth.desc(\n        'Optionally attach a synth to this node and trigger its attack / release'\n      ),\n      midiOut: Types.object\n        .aliased('MidiOut', 'A connected MIDI output')\n        .desc('Optionally attach a midi output to this node and send midi signals to that device'),\n    },\n    output: {\n      midiData: Types.object.desc('midi data out'),\n      toneData: TT.ToneData.desc('tone out node'),\n    },\n    state: {},\n  };\n  static shortNames = { stepsPerSecond: 'steps/s' };\n  performance: Performance;\n  toneOut: ToneData;\n  midiOut: [MidiData, number];\n  started: boolean = false;\n  _map = {};\n  _midiMap = {};\n\n  static play(data: ToneData, synth: Tone.Synth | Tone.Instrument | Piano) {\n    const [note, action, time, velocity] = data;\n    switch (action) {\n      case 'attack':\n        if (synth instanceof Piano) {\n          try {\n            synth.keyUp(note.toMidi(), time, velocity);\n          } catch (e) {\n            console.warn(e);\n          }\n        } else {\n          synth.triggerAttack(note, time, velocity);\n        }\n        break;\n      case 'release':\n        if (synth instanceof Piano) {\n          synth.keyDown(note.toMidi(), time, velocity);\n        } else {\n          synth.triggerRelease(note, time, velocity);\n        }\n        break;\n      case 'attackRelease':\n        synth.triggerAttackRelease(note, '4n', time, velocity);\n        break;\n      default:\n        break;\n    }\n  }\n\n  onAddToGraph = () => {\n    this.performance = new Performance();\n    this.performance.toneListener = (\n      note: Tone.Frequency,\n      action: ToneAction,\n      time: Tone.Time,\n      normalizedVelocity?: number\n    ) => {\n      this.toneOut = [note, action, time, normalizedVelocity];\n      this.notifyOutputs(['toneData'], true);\n      this._getSynths().forEach(synth => PerformanceRNNNode.play(this.toneOut, synth));\n    };\n    this.performance.midiListener = (midiData, time) => {\n      this.midiOut = [midiData, time];\n      this.notifyOutputs(['midiData'], true);\n      this._getMidiDevices().forEach(device => {\n        device.send(midiData, time);\n      });\n    };\n  };\n\n  willBeRemoved = () => {\n    this.performance.toneListener = null;\n    this.performance.midiListener = null;\n    this.performance.cleanup();\n    // $FlowIssue\n    this.performance = null;\n  };\n\n  _getSynths = () => {\n    return compact(this.inputs.map(e => this._map[e.id]));\n  };\n\n  _getMidiDevices = () => {\n    return compact(this.inputs.map(e => this._midiMap[e.id]));\n  };\n\n  _startModel = () => {\n    this.performance.start();\n    this.started = true;\n  };\n\n  beforeConnectOut = () => {\n    if (!this.started) this._startModel();\n  };\n\n  beforeConnectIn = (e: Edge) => {\n    if (!this.started && e.toPort === 'synth') this._startModel();\n    if (!this.started && e.toPort === 'midiOut') this._startModel();\n  };\n\n  _compareHistograms = (hist: string | number[], other: string | number[]): boolean => {\n    const canon1 = Array.isArray(hist) ? hist.join('') : hist;\n    const canon2 = Array.isArray(other) ? other.join('') : other;\n    return canon1 === canon2;\n  };\n\n  _histForPerformance = (hist: string | any[]): number[] => {\n    if (Array.isArray(hist)) {\n      return hist.map(a => parseInt(a));\n    } else if (typeof hist === 'string') {\n      return hist.split('').map(s => parseInt(s));\n    }\n    throw new Error('cannot parse histogram');\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    if (!prevProps || (newProps.density !== undefined && newProps.density !== prevProps.density)) {\n      this.performance.noteDensityBucket = newProps.density;\n      this.performance.refreshConditioning();\n    }\n    if (\n      !prevProps ||\n      (newProps.stepsPerSecond !== undefined &&\n        newProps.stepsPerSecond !== prevProps.stepsPerSecond)\n    ) {\n      this.performance.stepsPerSecond = newProps.stepsPerSecond;\n      this.performance.refreshConditioning();\n    }\n    if (\n      !prevProps ||\n      (newProps.scale !== undefined && !this._compareHistograms(newProps.scale, prevProps.scale))\n    ) {\n      this.performance.pitchHistArray = this._histForPerformance(newProps.scale);\n      this.performance.refreshConditioning();\n    }\n  };\n\n  process = () => ({ midiData: this.midiOut, toneData: this.toneOut });\n  onInputChange = (edge: Edge, change: Object) => {\n    if (edge.toPort === 'synth') {\n      const s = edge.inDataFor(change);\n      if (s) this._map[edge.id] = s;\n    }\n    if (edge.toPort === 'midiOut') {\n      const s = edge.inDataFor(change);\n      if (s) this._midiMap[edge.id] = s;\n    }\n    // do not notify on input changes\n    return [];\n  };\n}\n","// @flow\nimport React from 'react';\nimport Tone from 'tone';\nimport { get } from 'lodash';\nimport NodeBase from 'models/NodeBase';\nimport SoundFont from 'soundfont-player';\nimport { TT as NTypes, type ToneData } from 'models/nodes/Neural';\nimport type { MidiData } from 'performance';\nimport { MIDI_EVENT_OFF, MIDI_EVENT_ON } from 'performance';\nconst Types = window.Types;\n\nexport const TT = {\n  SoundFont: Types.object.aliased('SoundFont', 'A sample set assembled to be a virtual instrument'),\n};\n\nexport class SoundFontNode extends NodeBase<\n  {},\n  { name: string, attack: number, decay: number, release: number, sustain: number },\n  { out: ?Object }\n> {\n  instrument: Object;\n  _loaded: ?string = null;\n  static +registryName = 'SoundFontNode';\n  static +displayName = 'SoundFont';\n  static description = <span>A virtual instrument</span>;\n  static defaultProps = { attack: 0.5, decay: 1, release: 1, sustain: 0.9 };\n\n  static schema = {\n    input: {\n      name: Types.string.desc(\n        <div>\n          <p>The name of the soundfont to use. Possible values:</p>\n          <p>\n            accordion, acoustic_bass, acoustic_grand_piano, acoustic_guitar_nylon,\n            acoustic_guitar_steel, agogo, alto_sax, applause, bagpipe, banjo, baritone_sax, bassoon,\n            bird_tweet, blown_bottle, brass_section, breath_noise, bright_acoustic_piano, celesta,\n            cello, choir_aahs, church_organ, clarinet, clavinet, contrabass, distortion_guitar,\n            drawbar_organ, dulcimer, electric_bass_finger, electric_bass_pick, electric_grand_piano,\n            electric_guitar_clean, electric_guitar_jazz, electric_guitar_muted, electric_piano_1,\n            electric_piano_2, english_horn, fiddle, flute, french_horn, fretless_bass, fx_1_rain,\n            fx_2_soundtrack, fx_3_crystal, fx_4_atmosphere, fx_5_brightness, fx_6_goblins,\n            fx_7_echoes, fx_8_scifi, glockenspiel, guitar_fret_noise, guitar_harmonics, gunshot,\n            harmonica, harpsichord, helicopter, honkytonk_piano, kalimba, koto, lead_1_square,\n            lead_2_sawtooth, lead_3_calliope, lead_4_chiff, lead_5_charang, lead_6_voice,\n            lead_7_fifths, lead_8_bass__lead, marimba, melodic_tom, music_box, muted_trumpet, oboe,\n            ocarina, orchestra_hit, orchestral_harp, overdriven_guitar, pad_1_new_age, pad_2_warm,\n            pad_3_polysynth, pad_4_choir, pad_5_bowed, pad_6_metallic, pad_7_halo, pad_8_sweep,\n            pan_flute, percussive_organ, piccolo, pizzicato_strings, recorder, reed_organ,\n            reverse_cymbal, rock_organ, seashore, shakuhachi, shamisen, shanai, sitar, slap_bass_1,\n            slap_bass_2, soprano_sax, steel_drums, string_ensemble_1, string_ensemble_2,\n            synth_bass_1, synth_bass_2, synth_brass_1, synth_brass_2, synth_choir, synth_drum,\n            synth_strings_1, synth_strings_2, taiko_drum, tango_accordion, telephone_ring,\n            tenor_sax, timpani, tinkle_bell, tremolo_strings, trombone, trumpet, tuba,\n            tubular_bells, vibraphone, viola, violin, voice_oohs, whistle, woodblock, xylophone\n          </p>\n        </div>\n      ),\n      attack: Types.number.desc('The attack to use for this instrument'),\n      decay: Types.number.desc('The decay to use for this instrument'),\n      release: Types.number.desc('The release to use for this instrument'),\n      sustain: Types.number.desc('The sustain to use for this instrument'),\n    },\n    output: { out: TT.SoundFont.desc('Resulting SoundFont') },\n    state: {},\n  };\n\n  _options = () => {\n    const attack = this.props.attack || 0;\n    const decay = this.props.decay || 0;\n    const release = this.props.release || 0;\n    const sustain = this.props.sustain | 0;\n    return { attack, release, decay, sustain };\n  };\n\n  _setFont = (name: string) => {\n    SoundFont.instrument(Tone.context, name, this._options()).then(inst => {\n      this.instrument = inst;\n      this.instrument.opts = { ...this.instrument.opts, ...this._options() };\n      this.notifyAllOutputs(true);\n      this._loaded = name;\n    });\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    if (newProps.name && (!prevProps || newProps.name !== prevProps.name)) {\n      if (this._loaded !== newProps.name) {\n        this._setFont(newProps.name);\n      }\n    }\n    ['attack', 'decay', 'release', 'sustain'].forEach(k => {\n      if (typeof prevProps !== 'number' || newProps[k] !== prevProps[k]) {\n        if (this.instrument) {\n          this.instrument.opts[k] = newProps[k];\n        }\n      }\n    });\n  };\n\n  process = () => {\n    return { out: this.instrument };\n  };\n}\n\nexport class SoundFontPlayerNode extends NodeBase<\n  {},\n  { soundFont: Object, toneData: ToneData, midiDevice: ?Object },\n  null\n> {\n  static +displayName = 'SoundFont Player';\n  static +registryName = 'SoundFontPlayerNode';\n  static description = <span>A Node which plays tone data to a SoundFont instrument</span>;\n\n  static schema = {\n    input: {\n      soundFont: TT.SoundFont.desc('The particular sound font to use.'),\n      toneData: NTypes.ToneData.desc(\n        'Data fed in through this channel will be sent to the sound font instrument to play'\n      ),\n      midiData: NTypes.MidiData.desc(\n        'Data fed in through this channel will be sent to the sound font instrument to play'\n      ),\n      midiDevice: Types.object\n        .aliased('MidiInput', 'A connected MIDI input')\n        .desc('Optionally attach a midi input to this node to send signals to the soundfont'),\n    },\n    output: {},\n    state: {},\n  };\n  _playMap = {};\n  listening = [];\n\n  _playToneData = (data: ToneData, sf: Object) => {\n    const [freq, action, time, velocity] = data;\n    const note = freq.toNote();\n    switch (action) {\n      case 'attack':\n        if (!this._playMap[note]) {\n          this._playMap[note] = sf.play(note, time, { ...sf.opts, gain: velocity });\n        } else {\n          // this._playMap[note].stop();\n          this._playMap[note] = sf.play(note, time, { ...sf.opts, gain: velocity });\n        }\n        break;\n      case 'release':\n        const node = this._playMap[note];\n        if (node) {\n          node.stop(time);\n        }\n        break;\n      case 'attackRelease':\n        sf.play(note, undefined, { duration: 0.5 });\n        break;\n      default:\n        break;\n    }\n  };\n\n  _playMidiData = (midi: [MidiData, ?number], sf: Object) => {\n    const [data, _time] = midi;\n    const [event, note, velocity] = data;\n    const time = _time ? _time / 1000 : _time;\n\n    switch (event) {\n      case MIDI_EVENT_OFF:\n        const node = this._playMap[note];\n        if (node) {\n          node.stop(time);\n        }\n        break;\n      case MIDI_EVENT_ON:\n        if (!this._playMap[note]) {\n          this._playMap[note] = sf.play(note, time, { ...sf.opts, gain: velocity / 100 });\n        } else {\n          this._playMap[note].stop();\n          this._playMap[note] = sf.play(note, time, { ...sf.opts, gain: velocity / 100 });\n        }\n        break;\n      default:\n        break;\n    }\n  };\n\n  _connectMidiIn = () => {\n    const { midiDevice, soundFont } = this.props;\n    if (soundFont && midiDevice && !this.listening.includes(midiDevice.id)) {\n      soundFont.listenToMidi(midiDevice);\n      this.listening.push(midiDevice.id);\n    }\n  };\n\n  process = () => {\n    const sf = get(this.props, 'soundFont', undefined);\n    if (sf) {\n      this._connectMidiIn();\n      const data = get(this.props, 'toneData');\n      if (data) this._playToneData(data, sf);\n      const midi = get(this.props, 'midiData');\n      if (midi) this._playMidiData(midi, sf);\n    }\n    return null;\n  };\n}\n","// @flow\nimport NodeBase from 'models/NodeBase';\nconst Types = window.Types;\n\ntype S = { map: Object | (any => any) };\ntype P = { input: any };\ntype O = { out: any };\n\nexport default class MapperNode extends NodeBase<S, P, O> {\n  static displayName = 'Mapper';\n  static +registryName = 'MapperNode';\n  static defaultState = { map: {} };\n  static schema = { input: { input: Types.object }, output: { out: Types.object }, state: {} };\n\n  process = () => {\n    const { map } = this.state;\n    const { input } = this.props;\n    const out = typeof map === 'object' ? map[input] : map(input);\n    return { out };\n  };\n\n  onInputChange = () => {\n    return this.outKeys();\n  };\n}\n","// @flow\nimport NodeBase from 'models/NodeBase';\nimport React from 'react';\nconst Types = window.Types;\n\ntype P = { value: any, interval: number };\ntype S = { count: number };\ntype O = { count: number, value: any };\n\nconst intervalDesc = 'The interval at which this node will emit, in miliseconds';\nconst countDesc = 'The number of times this node has emitted so far.';\n\nexport default class IntervalNode extends NodeBase<S, P, O> {\n  count: number = 0;\n  static displayName = 'Interval';\n  static +registryName = 'IntervalNode';\n  static description = (\n    <span>A node which emits any value and a count at a regular time interval.</span>\n  );\n  static defaultProps = { interval: 1000 };\n  static schema = {\n    input: {\n      value: Types.any.desc('Any input to emit at this interval'),\n      interval: Types.number.desc(intervalDesc),\n    },\n    output: {\n      count: Types.number.desc(countDesc),\n      value: Types.any.desc('The input value passed in'),\n    },\n    state: {},\n  };\n\n  subscriptionId: ?IntervalID;\n\n  _clearSubscription = () => {\n    if (this.subscriptionId) {\n      clearInterval(this.subscriptionId);\n      this.subscriptionId = null;\n    }\n  };\n\n  _resetCount = () => {\n    this.count = 0;\n  };\n\n  _startInterval = () => {\n    this._clearSubscription();\n    this._resetCount();\n    this.subscriptionId = setInterval(() => {\n      this.count += 1;\n      this.notifyOutputs(this.outKeys(), true);\n    }, this.props.interval);\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    if (!prevProps || newProps.interval !== prevProps.interval) {\n      this._startInterval();\n    }\n  };\n\n  afterConnectOut = () => {\n    if (this.outputs.length === 1 && !this.subscriptionId) {\n      this._startInterval();\n    }\n  };\n\n  process = () => {\n    return { count: this.count, value: this.props.value };\n  };\n\n  // do not notify on input changes\n  onInputChange = () => [];\n}\n","/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nconst Stats = function() {\n  let mode = 0;\n  let container = document.createElement('div');\n  container.style.cssText = 'position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000';\n  container.addEventListener(\n    'click',\n    function(event) {\n      event.preventDefault();\n      showPanel(++mode % container.children.length);\n    },\n    false\n  );\n\n  //\n\n  function addPanel(panel) {\n    container.appendChild(panel.dom);\n    return panel;\n  }\n\n  function showPanel(id) {\n    for (var i = 0; i < container.children.length; i++) {\n      container.children[i].style.display = i === id ? 'block' : 'none';\n    }\n\n    mode = id;\n  }\n\n  //\n\n  var beginTime = (performance || Date).now(),\n    prevTime = beginTime,\n    frames = 0;\n\n  var fpsPanel = addPanel(new Stats.Panel('FPS', '#4084c3', '#002'));\n  var msPanel = addPanel(new Stats.Panel('MS', '#4caa4d', '#020'));\n\n  if (window.self.performance && window.self.performance.memory) {\n    var memPanel = addPanel(new Stats.Panel('MB', '#bd2b8a', '#201'));\n  }\n\n  showPanel(0);\n\n  return {\n    REVISION: 16,\n\n    dom: container,\n\n    addPanel: addPanel,\n    showPanel: showPanel,\n\n    begin: function() {\n      beginTime = (performance || Date).now();\n    },\n\n    end: function() {\n      frames++;\n\n      var time = (performance || Date).now();\n\n      msPanel.update(time - beginTime, 200);\n\n      if (time >= prevTime + 1000) {\n        fpsPanel.update((frames * 1000) / (time - prevTime), 100);\n\n        prevTime = time;\n        frames = 0;\n\n        if (memPanel) {\n          var memory = performance.memory;\n          memPanel.update(memory.usedJSHeapSize / 1048576, memory.jsHeapSizeLimit / 1048576);\n        }\n      }\n\n      return time;\n    },\n\n    update: function() {\n      beginTime = this.end();\n    },\n\n    // Backwards Compatibility\n\n    domElement: container,\n    setMode: showPanel,\n  };\n};\n\nStats.Panel = function(name, fg, bg) {\n  var min = Infinity,\n    max = 0,\n    round = Math.round;\n  var PR = round(window.devicePixelRatio || 1);\n\n  var WIDTH = 80 * PR,\n    HEIGHT = 48 * PR,\n    TEXT_X = 3 * PR,\n    TEXT_Y = 2 * PR,\n    GRAPH_X = 3 * PR,\n    GRAPH_Y = 15 * PR,\n    GRAPH_WIDTH = 74 * PR,\n    GRAPH_HEIGHT = 30 * PR;\n\n  var canvas = document.createElement('canvas');\n  canvas.width = WIDTH;\n  canvas.height = HEIGHT;\n  canvas.style.cssText = 'width:80px;height:48px';\n\n  var context = canvas.getContext('2d');\n  context.font = 'bold ' + 9 * PR + 'px Helvetica,Arial,sans-serif';\n  context.textBaseline = 'top';\n\n  context.fillStyle = bg;\n  context.fillRect(0, 0, WIDTH, HEIGHT);\n\n  context.fillStyle = fg;\n  context.fillText(name, TEXT_X, TEXT_Y);\n  context.fillRect(GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT);\n\n  context.fillStyle = bg;\n  context.globalAlpha = 0.9;\n  context.fillRect(GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT);\n\n  return {\n    dom: canvas,\n\n    update: function(value, maxValue) {\n      min = Math.min(min, value);\n      max = Math.max(max, value);\n\n      context.fillStyle = bg;\n      context.globalAlpha = 1;\n      context.fillRect(0, 0, WIDTH, GRAPH_Y);\n      context.fillStyle = fg;\n      context.fillText(\n        round(value) + ' ' + name + ' (' + round(min) + '-' + round(max) + ')',\n        TEXT_X,\n        TEXT_Y\n      );\n\n      context.drawImage(\n        canvas,\n        GRAPH_X + PR,\n        GRAPH_Y,\n        GRAPH_WIDTH - PR,\n        GRAPH_HEIGHT,\n        GRAPH_X,\n        GRAPH_Y,\n        GRAPH_WIDTH - PR,\n        GRAPH_HEIGHT\n      );\n\n      context.fillRect(GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, GRAPH_HEIGHT);\n\n      context.fillStyle = bg;\n      context.globalAlpha = 0.9;\n      context.fillRect(\n        GRAPH_X + GRAPH_WIDTH - PR,\n        GRAPH_Y,\n        PR,\n        round((1 - value / maxValue) * GRAPH_HEIGHT)\n      );\n    },\n  };\n};\n\nexport { Stats as default };\n","/* eslint-disable no-use-before-define */\n// @flow\nimport {\n  Clock,\n  FogExp2,\n  LoadingManager,\n  PerspectiveCamera,\n  Scene,\n  Vector2,\n  WebGLRenderer,\n  OrthographicCamera,\n} from 'three';\nimport { throttle } from 'lodash';\nimport OrbitControls from 'orbit-controls-es6';\nimport Stats from 'threeUtil/Stats';\nimport { EffectComposer, RenderPass } from 'postprocessing';\n// const THREE = require('three');\n// window.THREE = THREE;\n\ntype Renderable = EffectComposer | WebGLRenderer;\nexport type UpdateSignal = $Keys<typeof Base.Signals>;\ntype ShaderUniform<T> = {\n  type: string,\n  value: T,\n};\n\ntype GlobalUniforms = {\n  u_resolution: ShaderUniform<Vector2>,\n  u_mouse: ShaderUniform<Vector2>,\n  u_time: ShaderUniform<number>,\n};\n\nexport const uniforms: GlobalUniforms = {\n  u_resolution: { type: 'v2', value: new Vector2() },\n  u_mouse: { type: 'v2', value: new Vector2() },\n  u_time: { type: 'f', value: 1.0 },\n};\n\nexport default class Base {\n  static Signals = { STOP: 'STOP' };\n  loadingManager: LoadingManager;\n  assets: ?Map<string, any>;\n  scene: Scene;\n  camera: PerspectiveCamera | OrthographicCamera;\n  showStats: boolean = process.env.NODE_ENV === 'development';\n  stats: ?{ domElement: Object, begin: () => void, update: () => void };\n  renderer: ?Renderable;\n  composer: ?EffectComposer;\n  renderPass: ?RenderPass;\n\n  constructor() {\n    this.loadingManager = new LoadingManager();\n    this.assets = null;\n    this.scene = new Scene();\n    // todo: eventually switch things to this\n    // this.scene.background = new Color(0x2c2222);\n    this.scene.fog = new FogExp2(0x0d0d0d, 0.0025);\n    this.camera = new PerspectiveCamera(40, window.innerWidth / window.innerHeight, 0.1, 1000);\n    if (this.showStats) {\n      this.stats = new Stats();\n    }\n\n    // For the Three.js debugger chrome extension\n    // window.scene = this.scene;\n    // window.THREE = THREE;\n  }\n\n  setupStats() {\n    if (this.stats) {\n      this.stats.domElement.style.position = 'absolute';\n      this.stats.domElement.style.left = '0px';\n      this.stats.domElement.style.top = '0px';\n      // $FlowIssue\n      document.body.appendChild(this.stats.domElement);\n      this.stats && this.stats.begin();\n    }\n  }\n\n  load(callback: () => void) {\n    callback();\n  }\n\n  afterLoad = () => {};\n\n  orthoCam = () =>\n    new OrthographicCamera(\n      window.innerWidth / -2,\n      window.innerWidth / 2,\n      window.innerHeight / 2,\n      window.innerHeight / -2,\n      0.1,\n      1000\n    );\n\n  initialise(composer?: ?EffectComposer, renderPass?: ?RenderPass) {\n    this.setupStats();\n    // NB: don't call this base impl if you want a higher level pass to be rendered\n    if (renderPass) {\n      renderPass.renderToScreen = true;\n    }\n  }\n\n  update: (delta: number) => ?UpdateSignal = delta => {};\n\n  configure(gui: ?Object) {}\n\n  reset = () => {\n    const fog = this.scene.fog;\n    this.scene = new Scene();\n    window.scene = this.scene;\n    this.scene.fog = fog;\n    return this;\n  };\n\n  cleanup = () => {\n    if (document.body && this.renderer) {\n      document.body.removeChild(this.renderer.domElement);\n    }\n    window.removeEventListener('resize', this.resize);\n  };\n\n  // TODO Memoize\n  static rgbToHex(r: number, g: number, b: number) {\n    return (1 << 24) + (r << 16) + (g << 8) + b;\n  }\n\n  start = () => {\n    const composer = new EffectComposer(this._makeRenderer(false), {\n      stencilBuffer: true,\n      depthTexture: true,\n    });\n    const renderer = composer.renderer;\n    // TODO enable this or not?\n    // const controls = new OrbitControls(this.camera, renderer.domElement);\n    renderer.domElement.style.visibility = 'hidden';\n    if (document.body) {\n      document.body.appendChild(renderer.domElement);\n    }\n    composer.reset();\n    this.load(() => {\n      const renderPass = new RenderPass(this.scene, this.camera);\n      this.renderPass = renderPass;\n      composer.addPass(renderPass);\n      this.initialise(composer, renderPass);\n      uniforms.u_resolution.value.x = renderer.domElement.width;\n      uniforms.u_resolution.value.y = renderer.domElement.height;\n      renderer.setPixelRatio(renderer.domElement.devicePixelRatio);\n      this.camera.aspect = window.innerWidth / window.innerHeight;\n      this.camera.updateProjectionMatrix();\n      renderer.domElement.style.visibility = 'visible';\n      this.afterLoad();\n    });\n    this._listenForWindowChanges();\n    this._startRendering(composer);\n    this.composer = composer;\n    this.renderer = renderer;\n  };\n\n  // Optionally without a composer\n  startRaw = () => {\n    const renderer = this._makeRenderer();\n    if (document.body) {\n      document.body.appendChild(renderer.domElement);\n    }\n    new OrbitControls(this.camera, renderer.domElement);\n    this.load(() => {\n      this.initialise(null, null);\n      this.camera.aspect = window.innerWidth / window.innerHeight;\n      this.camera.updateProjectionMatrix();\n      this.afterLoad();\n    });\n    this._listenForWindowChanges();\n    this._startRendering(renderer);\n    this.renderer = renderer;\n  };\n\n  _startRendering = (renderer: Renderable) => {\n    const clock = new Clock();\n    let animationId;\n    const render = () => {\n      const delta = clock.getDelta();\n      if (this.update(delta) !== Base.Signals.STOP) {\n        animationId = requestAnimationFrame(render);\n        uniforms.u_time.value += delta;\n        if (renderer instanceof EffectComposer) {\n          renderer.render(delta);\n        } else {\n          renderer.render(this.scene, this.camera);\n        }\n      } else {\n        cancelAnimationFrame(animationId);\n      }\n      if (this.stats) {\n        this.stats.update();\n      }\n    };\n    render();\n  };\n\n  _listenForWindowChanges = () => {\n    window.addEventListener('resize', this.resize);\n  };\n\n  resize = throttle((event: Event) => {\n    // $FlowIssue\n    const width = event.target.innerWidth;\n    // $FlowIssue\n    const height = event.target.innerHeight;\n    if (this.composer) {\n      this.composer.setSize(width, height);\n    } else if (this.renderer) {\n      this.renderer.setSize(width, height);\n    }\n    // $FlowIssue\n    uniforms.u_resolution.value.x = this.renderer.domElement.width;\n    // $FlowIssue\n    uniforms.u_resolution.value.y = this.renderer.domElement.height;\n    this.camera.aspect = width / height;\n    this.camera.updateProjectionMatrix();\n  }, 18);\n\n  _makeRenderer = (antialias: boolean = true) => {\n    const r = new WebGLRenderer({ alpha: true, antialias });\n    r.setSize(window.innerWidth, window.innerHeight);\n    r.setPixelRatio(window.devicePixelRatio);\n    r.setClearColor(0x2c2222);\n    r.autoClear = false;\n    return r;\n  };\n}\n","// @flow\nimport React from 'react';\nimport { get } from 'lodash';\nimport Base from 'threeUtil/Base';\nimport NodeBase from 'models/NodeBase';\nimport Edge from 'models/Edge';\nimport {\n  AmbientLight,\n  DirectionalLight,\n  LoadingManager,\n  Mesh,\n  NearestFilter,\n  Object3D,\n  TextureLoader,\n  Vector2,\n  Vector3,\n  Color as ThreeColor,\n} from 'three';\nimport {\n  ChromaticAberrationEffect,\n  ColorAverageEffect,\n  DotScreenEffect,\n  Effect,\n  EffectPass,\n  GlitchEffect,\n  NoiseEffect,\n  Pass,\n  ScanlineEffect,\n  VignetteEffect,\n} from 'postprocessing';\nconst Types = window.Types;\nconst URL_BASE = process.env.PUBLIC_URL || '';\n\ntype P = { child: Mesh };\ntype S = { base: Base, added: string[] };\nconst TT = {\n  Color: Types.object.aliased('RGBColor', 'RGB representation of a color'),\n};\n\nexport default class ThreeNode extends NodeBase<S, P, null> {\n  static +displayName = 'Render Scene';\n  static +registryName = 'ThreeNode';\n  static description = (\n    <span>This node renders a WebGL scene, by default with a perspective camera</span>\n  );\n  rendered: any;\n  started: boolean = false;\n\n  static schema = {\n    input: {\n      child: Types.object.desc('Any scene element[s] to be added'),\n      fx: Types.object.desc('Post render pass(es)'),\n      clearColor: TT.Color.desc(\"The renderer's clear color\"),\n      clearAlpha: Types.number.desc(\"The alpha component for the renderer's clear color\"),\n    },\n    output: {},\n    state: {},\n  };\n\n  onAddToGraph = () => {\n    this.state.base = new Base();\n    this.state.added = [];\n  };\n\n  _start = () => {\n    if (this.props.child && !this.started) {\n      this.started = true;\n      this.state.base.camera.position.set(0, 0, 30);\n      this.state.base.camera.lookAt(new Vector3(0, 0, 0));\n      this.state.base.start();\n      if (this.state.base.renderPass && this.state.base.renderPass.renderToScreen) {\n        this.rendered = this.state.base.renderPass;\n      }\n    }\n  };\n\n  willBeRemoved = () => {\n    this.state.base.reset();\n    this.state.base.cleanup();\n  };\n\n  addPass = (pass: Pass) => {\n    const composer = this.state.base.composer;\n    if (this.rendered && composer) {\n      this.rendered.renderToScreen = false;\n      composer.addPass(pass);\n      pass.renderToScreen = true;\n      this.rendered = pass;\n    }\n  };\n\n  onInputChange = (edge: Edge, change: $Shape<P>) => {\n    const { toPort } = edge;\n    if (toPort === 'child') {\n      if (!this.state.added.includes(edge.from.id)) {\n        this.state.added.push(edge.from.id);\n        const child = edge.inDataFor(change);\n        if (child instanceof Object3D) {\n          this.state.base.scene.add(child);\n        }\n      }\n    }\n    if (toPort === 'clearColor') {\n      const newColor = edge.inDataFor(change);\n      const renderer = get(this.state, 'base.renderer');\n      if (renderer && renderer.getClearColor() !== newColor) {\n        renderer.setClearColor(newColor);\n        this.state.base.scene.background = new ThreeColor(newColor);\n      }\n    }\n    if (toPort === 'clearAlpha') {\n      const newAlpha = edge.inDataFor(change);\n      const renderer = get(this.state, 'base.renderer');\n      if (renderer && renderer.getClearAlpha() !== newAlpha) {\n        renderer.setClearAlpha(newAlpha);\n      }\n    }\n    return [];\n  };\n\n  process = () => {\n    this._start();\n    return null;\n  };\n}\n\nexport class AmbientLightNode extends NodeBase<\n  { light: AmbientLight },\n  {},\n  { light: AmbientLight }\n> {\n  static +displayName = 'Ambient Light';\n  static +registryName = 'AmbientLightNode';\n  static description = <span>An ambient light, intended to be added to a scene</span>;\n  static schema = {\n    input: { color: TT.Color.desc('The color of this ambient light') },\n    output: { light: Types.object.desc('The ambient light source') },\n    state: { light: Types.object.desc('The ambient light source') },\n  };\n\n  onAddToGraph = () => {\n    this.state.light = new AmbientLight(0x313a59);\n  };\n\n  process = () => ({ light: this.state.light });\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    ['color'].forEach(k => {\n      if (!prevProps || newProps[k] !== prevProps[k]) {\n        this.pushToState('light', { [k]: newProps[k] }, [], k);\n      }\n    });\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    return this.outKeys();\n  };\n}\n\nexport class DirectionalLightNode extends NodeBase<\n  { light: DirectionalLight },\n  {},\n  { light: DirectionalLight }\n> {\n  static +displayName = 'Directional Light';\n  static +registryName = 'DirectionalLightNode';\n  static description = <span>A focused light, intended to be added to a scene</span>;\n  static schema = {\n    input: { color: TT.Color.desc('The color of this directional light') },\n    output: { light: Types.object.desc('The directional light source') },\n    state: { light: Types.object.desc('The directional light source, directed at the scene') },\n  };\n\n  willBecomeLive = () => {};\n  onAddToGraph = () => {\n    this.state.light = new DirectionalLight(0xffbbaa);\n    this.state.light.position.set(0, -1, 0);\n  };\n\n  afterConnectOut = (edge: Edge) => {\n    if (edge.to instanceof ThreeNode) {\n      this.state.light.target.position.copy(edge.to.state.base.scene.position);\n    }\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    ['color'].forEach(k => {\n      if (!prevProps || newProps[k] !== prevProps[k]) {\n        this.pushToState('light', { [k]: newProps[k] }, [], k);\n      }\n    });\n  };\n  process = () => ({ light: this.state.light });\n\n  onInputChange = (edge: Edge, change: Object) => {\n    return this.outKeys();\n  };\n}\ntype ColorT = { r: number, g: number, b: number };\n\nexport class Color extends NodeBase<{}, ColorT, { rgb: ColorT, hex: number }> {\n  static +displayName = 'Color';\n  static +registryName = 'Color';\n  static defaultProps = { r: 0, g: 0, b: 0 };\n  static description = <span>A color representation</span>;\n  static schema = {\n    input: {\n      r: Types.number.desc('red channel, [0,255]'),\n      g: Types.number.desc('green channel, [0,255]'),\n      b: Types.number.desc('blue channel, [0,255]'),\n    },\n    output: {\n      hex: Types.number.desc('hex representation of this color'),\n      rgb: TT.Color.desc('rgb representation'),\n    },\n    state: {},\n  };\n\n  process = () => {\n    const r = this.props.r || 0;\n    const g = this.props.g || 0;\n    const b = this.props.b || 0;\n    let hex = Base.rgbToHex(r, g, b);\n    return { hex: hex, rgb: { r, g, b } };\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    return this.outKeys();\n  };\n}\n\nexport class GlitchPassNode extends NodeBase<{}, {}, { glitch: Object }> {\n  static +displayName = 'Glitch Pass';\n  static +registryName = 'GlitchPassNode';\n  static description = <span>A holy perturbation</span>;\n\n  static schema = {\n    input: {\n      delay: Types.Vec2.desc(\n        'the min and max delay between glitches, as a 2d vector in second units'\n      ),\n    },\n    output: { glitch: Types.object.desc('glitchy pass') },\n    state: {},\n  };\n  assets: Map<string, any>;\n  glitch: GlitchEffect;\n  aberration: ChromaticAberrationEffect;\n  rendered: boolean = false;\n\n  load = (callback: () => void) => {\n    const assets = new Map();\n    const loadingManager = new LoadingManager();\n    const textureLoader = new TextureLoader(loadingManager);\n    loadingManager.onProgress = (item, loaded, total) => {\n      if (loaded === total) {\n        this.assets = assets;\n        callback();\n      }\n    };\n    textureLoader.load(URL_BASE + '/latent/textures/perturb.jpg', texture => {\n      texture.magFilter = texture.minFilter = NearestFilter;\n      assets.set('perturb-map', texture);\n    });\n  };\n\n  _render = () => {\n    if (this.rendered || !this.glitch || !this.assets) {\n      return;\n    }\n\n    this.outputs.forEach(edge => {\n      if (edge.to instanceof ThreeNode) {\n        const threeN: ThreeNode = edge.to;\n        const camera = threeN.state.base.camera;\n        if (camera) {\n          const glitchPass = new EffectPass(camera, this.glitch);\n          const chromaticAberrationPass = new EffectPass(camera, this.aberration);\n          threeN.addPass(glitchPass);\n          threeN.addPass(chromaticAberrationPass);\n          this.rendered = true;\n        }\n      }\n    });\n  };\n\n  willBecomeLive = () => {};\n\n  onAddToGraph = () => {\n    this.load(() => {\n      this.aberration = new ChromaticAberrationEffect();\n      this.glitch = new GlitchEffect({\n        perturbationMap: this.assets.get('perturb-map'),\n        chromaticAberrationOffset: this.aberration.offset,\n      });\n      this.glitch.delay = new Vector2(5.5, 10);\n      this._render();\n    });\n  };\n\n  afterConnectOut = (edge: Edge) => {\n    this._render();\n  };\n\n  process = () => ({ glitch: this.glitch });\n\n  onInputChange = (edge: Edge, change: Object) => {\n    this._render();\n    if ('delay' === edge.toPort) {\n      this.glitch.delay = edge.inDataFor(change);\n    }\n    return this.outKeys();\n  };\n}\n\nexport class VignettePassNode extends NodeBase<\n  { opacity: number, offset: number, darkness: number },\n  {},\n  { pass: Object, effect: Effect }\n> {\n  static +displayName = 'Vignette Pass';\n  static +registryName = 'VignettePassNode';\n  static description = <span>A Vignette post-process effect</span>;\n\n  static schema = {\n    input: {\n      opacity: Types.number.desc('The vignette opacity [0,1]'),\n      offset: Types.number.desc('The vignette offset [0,1]'),\n      darkness: Types.number.desc('The vignette darkness [0,1]'),\n    },\n    output: {\n      pass: Types.object.desc('a vignette pass'),\n      effect: Types.object.desc('the effect itself'),\n    },\n    state: {},\n  };\n\n  static shortNames = { effect: 'fx' };\n\n  effect: Effect;\n  pass: Pass;\n  rendered: boolean = false;\n\n  _render = () => {\n    if (this.rendered) {\n      return;\n    }\n\n    this.outputs.forEach(edge => {\n      if (edge.to instanceof ThreeNode) {\n        const threeN: ThreeNode = edge.to;\n        const camera = threeN.state.base.camera;\n        if (camera) {\n          this.effect = new VignetteEffect({\n            eskil: false,\n            offset: 0.25,\n            darkness: 0.55,\n          });\n          this.pass = new EffectPass(camera, this.effect);\n          threeN.addPass(this.pass);\n          this.rendered = true;\n        }\n      }\n    });\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    const effect = this.effect;\n    if (!effect) return;\n    ['darkness', 'offset'].forEach(k => {\n      const uni = effect.uniforms.get(k);\n      const newVal = newProps[k];\n      if (uni !== undefined && typeof newVal === 'number' && prevProps[k] !== newVal) {\n        uni.value = newVal;\n      }\n    });\n    ['opacity'].forEach(k => {\n      const opacity = get(effect, 'blendMode.opacity');\n      const newVal = newProps[k];\n      if (opacity !== undefined && typeof newVal === 'number' && opacity.value !== newVal) {\n        opacity.value = newVal;\n      }\n    });\n  };\n\n  onAddToGraph = () => {\n    this._render();\n  };\n\n  afterConnectOut = (edge: Edge) => {\n    this._render();\n  };\n\n  process = () => ({ pass: this.pass, effect: this.effect });\n\n  onInputChange = (edge: Edge, change: Object) => {\n    this._render();\n    return this.outKeys();\n  };\n}\n\nexport class ScanlinePassNode extends NodeBase<{}, {}, { pass: Object, effect: Effect }> {\n  static +displayName = 'Scanline Pass';\n  static +registryName = 'ScanlinePassNode';\n  static description = <span>A scanline post-process effect</span>;\n\n  static schema = {\n    input: {},\n    output: {\n      pass: Types.object.desc('a scanline pass'),\n      effect: Types.object.desc('the effect itself'),\n    },\n    state: {},\n  };\n\n  static shortNames = { effect: 'fx' };\n\n  effect: Effect;\n  pass: Pass;\n  rendered: boolean = false;\n\n  _render = () => {\n    if (this.rendered) {\n      return;\n    }\n\n    this.outputs.forEach(edge => {\n      if (edge.to instanceof ThreeNode) {\n        const threeN: ThreeNode = edge.to;\n        const camera = threeN.state.base.camera;\n        if (camera) {\n          this.effect = new ScanlineEffect({ density: 1.5 });\n          this.pass = new EffectPass(camera, this.effect);\n          threeN.addPass(this.pass);\n          this.rendered = true;\n        }\n      }\n    });\n  };\n\n  willBecomeLive = () => {};\n\n  onAddToGraph = () => {\n    this._render();\n  };\n\n  afterConnectOut = (edge: Edge) => {\n    this._render();\n  };\n\n  process = () => ({ pass: this.pass, effect: this.effect });\n\n  onInputChange = (edge: Edge, change: Object) => {\n    this._render();\n    return this.outKeys();\n  };\n}\n\nexport class DotScreenPassNode extends NodeBase<{}, {}, { pass: Object, effect: Effect }> {\n  static +displayName = 'DotScreen Pass';\n  static +registryName = 'DotScreenPassNode';\n  static description = <span>A Dot-screen post-process effect</span>;\n\n  static schema = {\n    input: {},\n    output: {\n      pass: Types.object.desc('a dotscreen pass'),\n      effect: Types.object.desc('the effect itself'),\n    },\n    state: {},\n  };\n  static shortNames = { effect: 'fx' };\n  effect: Effect;\n  pass: Pass;\n  rendered: boolean = false;\n\n  _render = () => {\n    if (this.rendered) {\n      return;\n    }\n\n    this.outputs.forEach(edge => {\n      if (edge.to instanceof ThreeNode) {\n        const threeN: ThreeNode = edge.to;\n        const camera = threeN.state.base.camera;\n        if (camera) {\n          const colorAverageEffect = new ColorAverageEffect();\n          this.effect = new DotScreenEffect({\n            blendFunction: 13,\n            scale: 1.0,\n            angle: Math.PI * 0.58,\n          });\n          this.effect.blendMode.opacity.value = 0.21;\n          this.pass = new EffectPass(camera, this.effect, colorAverageEffect);\n          threeN.addPass(this.pass);\n          this.rendered = true;\n        }\n      }\n    });\n  };\n\n  willBecomeLive = () => {};\n\n  onAddToGraph = () => {\n    this._render();\n  };\n\n  afterConnectOut = (edge: Edge) => {\n    this._render();\n  };\n\n  process = () => ({ pass: this.pass, effect: this.effect });\n\n  onInputChange = (edge: Edge, change: Object) => {\n    this._render();\n    return this.outKeys();\n  };\n}\n\nexport class NoisePassNode extends NodeBase<\n  {},\n  { opacity: number },\n  { pass: Object, effect: Effect }\n> {\n  static +displayName = 'Noise Pass';\n  static +registryName = 'NoisePassNode';\n  static description = <span>A noise post-process effect</span>;\n\n  static schema = {\n    input: {\n      opacity: Types.number.desc('the blending opacity'),\n    },\n    output: {\n      pass: Types.object.desc('a noise pass'),\n      effect: Types.object.desc('the effect itself'),\n    },\n    state: {},\n  };\n  static shortNames = { effect: 'fx' };\n  effect: Effect;\n  pass: Pass;\n  rendered: boolean = false;\n\n  _render = () => {\n    if (this.rendered) {\n      return;\n    }\n    this.outputs.forEach(edge => {\n      if (edge.to instanceof ThreeNode) {\n        const threeN: ThreeNode = edge.to;\n        const camera = threeN.state.base.camera;\n        if (camera) {\n          this.effect = new NoiseEffect({});\n          this.pass = new EffectPass(camera, this.effect);\n          this.effect.blendMode.opacity.value = get(this, 'props.opacity', 0.21);\n          threeN.addPass(this.pass);\n          this.rendered = true;\n        }\n      }\n    });\n  };\n\n  willReceiveProps = (newProps: Object) => {\n    const effect = this.effect;\n    if (!effect) return;\n    ['opacity'].forEach(k => {\n      const opacity = get(effect, 'blendMode.opacity');\n      const newVal = newProps[k];\n      if (opacity !== undefined && typeof newVal === 'number' && opacity.value !== newVal) {\n        opacity.value = newVal;\n      }\n    });\n  };\n\n  willBecomeLive = () => {};\n\n  onAddToGraph = () => {\n    this._render();\n  };\n\n  afterConnectOut = (edge: Edge) => {\n    this._render();\n  };\n\n  process = () => ({ pass: this.pass, effect: this.effect });\n\n  onInputChange = (edge: Edge, change: Object) => {\n    this._render();\n    return this.outKeys();\n  };\n}\n","// @flow\nimport React from 'react';\nimport NodeBase from 'models/NodeBase';\nimport Edge from 'models/Edge';\nimport {\n  TorusKnotBufferGeometry,\n  Geometry,\n  PlaneBufferGeometry,\n  BoxBufferGeometry,\n  SphereBufferGeometry,\n} from 'three';\nconst Types = window.Types;\n\ntype P = {\n  radius: number,\n  tube: number,\n  tubularSegments: number,\n  radialSegments: number,\n  p: number,\n  q: number,\n};\ntype S = { geometry: Geometry };\ntype O = { geometry: Geometry };\n\nexport class TorusKnotGeometryNode extends NodeBase<S, P, O> {\n  static +displayName = 'Torus Knot Geometry';\n  static +registryName = 'TorusKnotGeometryNode';\n  static +defaultProps = {\n    radius: 1,\n    tube: 0.4,\n    tubularSegments: 64,\n    radialSegments: 8,\n    p: 2,\n    q: 3,\n  };\n  static description = (\n    <span>\n      A torus knot (buffer) geometry, with most attributes encoded in buffers so that they are more\n      efficiently transported to your GPU.\n    </span>\n  );\n\n  static schema = {\n    input: {\n      radius: Types.number.desc('The radius of this geometry'),\n      tube: Types.number.desc('The tube radius'),\n      tubularSegments: Types.number.desc('The number of tubular segments for this geometry'),\n      radialSegments: Types.number.desc('The number of radial segments for this geometry'),\n      p: Types.number.desc('The torus knot p'),\n      q: Types.number.desc('The torus knot q'),\n    },\n    output: { geometry: Types.object.desc('this particular geometry') },\n    state: { geometry: Types.object.desc('this particular geometry') },\n  };\n\n  static shortNames = { geometry: 'geo', tubularSegments: 'tSeg', radialSegments: 'rSeg' };\n\n  _setGeo = () => {\n    const { radius, tube, tubularSegments, radialSegments, p, q } = this.props;\n    this.state.geometry && this.state.geometry.dispose();\n    this.state.geometry = new TorusKnotBufferGeometry(\n      radius,\n      tube,\n      tubularSegments,\n      radialSegments,\n      p,\n      q\n    );\n  };\n\n  onAddToGraph = () => {\n    this._setGeo();\n  };\n\n  onInputChange = (edge: Edge) => {\n    let notify = false;\n    ['radius', 'tube', 'tubularSegments', 'radialSegments', 'p', 'q'].forEach(k => {\n      if (k === edge.toPort && this.state.geometry.parameters[k] !== this.props[k]) {\n        this._setGeo();\n        notify = true;\n      }\n    });\n    return notify ? this.outKeys() : [];\n  };\n\n  process = () => {\n    return this.state;\n  };\n}\n\nexport class PlaneGeometryNode extends NodeBase<S, { width: number, height: number }, O> {\n  static +displayName = 'Plane Geometry';\n  static +registryName = 'PlaneGeometryNode';\n  static +defaultProps = { width: 2, height: 2 };\n  static description = (\n    <span>\n      A plane (buffer) geometry, with most attributes encoded in buffers so that they are more\n      efficiently transported to your GPU.\n    </span>\n  );\n\n  static schema = {\n    input: {\n      width: Types.number.desc('The width of this plane'),\n      height: Types.number.desc('The height of this plane'),\n    },\n    output: { geometry: Types.object.desc('this particular geometry') },\n    state: { geometry: Types.object.desc('this particular geometry') },\n  };\n\n  static shortNames = { geometry: 'geo' };\n\n  _setGeo = () => {\n    const { width, height } = this.props;\n    this.state.geometry && this.state.geometry.dispose();\n    this.state.geometry = new PlaneBufferGeometry(width, height);\n  };\n\n  onAddToGraph = () => {\n    this._setGeo();\n  };\n\n  onInputChange = (edge: Edge) => {\n    let notify = false;\n    ['width', 'height'].forEach(k => {\n      if (k === edge.toPort && this.state.geometry.parameters[k] !== this.props[k]) {\n        this._setGeo();\n        notify = true;\n      }\n    });\n    return notify ? this.outKeys() : [];\n  };\n\n  process = () => {\n    return this.state;\n  };\n}\n\nexport class BoxGeometryNode extends NodeBase<\n  S,\n  {\n    width: number,\n    height: number,\n    depth: number,\n  },\n  O\n> {\n  static +displayName = 'Box Geometry';\n  static +registryName = 'BoxGeometryNode';\n  static +defaultProps = {\n    width: 1,\n    height: 1,\n    depth: 1,\n  };\n  static description = (\n    <span>\n      A box (buffer) geometry, with most attributes encoded in buffers so that they are more\n      efficiently transported to your GPU.\n    </span>\n  );\n\n  static schema = {\n    input: {\n      width: Types.number.desc('The width of this box'),\n      height: Types.number.desc('The height of this box'),\n      depth: Types.number.desc('The depth of this box'),\n    },\n    output: { geometry: Types.object.desc('this particular geometry') },\n    state: { geometry: Types.object.desc('this particular geometry') },\n  };\n\n  static shortNames = { geometry: 'geo' };\n\n  _setGeo = () => {\n    const { width, height, depth } = this.props;\n    this.state.geometry && this.state.geometry.dispose();\n    this.state.geometry = new BoxBufferGeometry(width, height, depth);\n  };\n\n  onAddToGraph = () => {\n    this._setGeo();\n  };\n\n  onInputChange = (edge: Edge) => {\n    let notify = false;\n    ['width', 'height', 'depth'].forEach(k => {\n      if (k === edge.toPort && this.state.geometry.parameters[k] !== this.props[k]) {\n        this._setGeo();\n        notify = true;\n      }\n    });\n    return notify ? this.outKeys() : [];\n  };\n\n  process = () => {\n    return this.state;\n  };\n}\n\nexport class SphereGeometryNode extends NodeBase<\n  S,\n  {\n    radius: number,\n    widthSegments: number,\n    heightSegments: number,\n  },\n  O\n> {\n  static +displayName = 'Sphere Geometry';\n  static +registryName = 'SphereGeometryNode';\n  static +defaultProps = {\n    radius: 1,\n    widthSegments: 8,\n    heightSegments: 6,\n  };\n  static description = (\n    <span>\n      A sphere (buffer) geometry, with most attributes encoded in buffers so that they are more\n      efficiently transported to your GPU.\n    </span>\n  );\n\n  static schema = {\n    input: {\n      radius: Types.number.desc('The radius of the sphere'),\n      widthSegments: Types.number.desc('The number of segments along the geometry width'),\n      heightSegments: Types.number.desc('The number of segments along the geometry height'),\n    },\n    output: { geometry: Types.object.desc('this particular geometry') },\n    state: { geometry: Types.object.desc('this particular geometry') },\n  };\n\n  static shortNames = { geometry: 'geo', widthSegments: 'wSeg', heightSegments: 'hSeg' };\n\n  _setGeo = () => {\n    const { radius, widthSegments, heightSegments } = this.props;\n    this.state.geometry && this.state.geometry.dispose();\n    this.state.geometry = new SphereBufferGeometry(radius, widthSegments, heightSegments);\n  };\n\n  onAddToGraph = () => {\n    this._setGeo();\n  };\n\n  onInputChange = (edge: Edge) => {\n    let notify = false;\n    ['radius', 'widthSegments', 'heightSegments'].forEach(k => {\n      if (k === edge.toPort && this.state.geometry.parameters[k] !== this.props[k]) {\n        this._setGeo();\n        notify = true;\n      }\n    });\n    return notify ? this.outKeys() : [];\n  };\n\n  process = () => {\n    return this.state;\n  };\n}\n","// @flow\nimport React from 'react';\nimport { get } from 'lodash';\nimport NodeBase from 'models/NodeBase';\nimport { Material, MeshLambertMaterial, ShaderMaterial } from 'three';\nimport Base, { uniforms } from 'threeUtil/Base';\nconst Types = window.Types;\n\ntype P = {};\ntype S = { material: Material };\ntype O = { material: Material };\n\nlet color = Base.rgbToHex(28, 5, 9);\n\nexport class LambertMaterialNode extends NodeBase<S, P, O> {\n  static +displayName = 'Lambert Material';\n  static +registryName = 'LambertMaterialNode';\n  static description = (\n    <div>\n      <p>A material for non-shiny surfaces, without specular highlights.</p>\n      <p>\n        The material uses a non-physically based Lambertian model for calculating reflectance. This\n        can simulate some surfaces (such as untreated wood or stone) well, but cannot simulate shiny\n        surfaces with specular highlights (such as varnished wood).\n      </p>\n      <p>\n        Shading is calculated using a Gouraud shading model. This calculates shading per vertex\n        (i.e. in the vertex shader) and interpolates the results over the polygon's faces.\n      </p>\n    </div>\n  );\n\n  static schema = {\n    input: {},\n    output: { material: Types.object },\n    state: { material: Types.object },\n  };\n  static shortNames = { material: 'mat' };\n\n  onAddToGraph = () => {\n    this.state.material = new MeshLambertMaterial({\n      transparent: false,\n      color: color,\n      wireframe: false,\n    });\n  };\n\n  process = () => {\n    return this.state;\n  };\n}\n\nexport class ShaderMaterialNode extends NodeBase<S, { vertex: string, fragment: string }, O> {\n  static +displayName = 'Shader Material';\n  static +registryName = 'ShaderMaterialNode';\n  static defaultProps = {\n    vertex: `void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}`,\n    fragment: 'void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}',\n  };\n  static description = (\n    <div>\n      <p>\n        A material rendered with custom shaders. A shader is a small program written in GLSL that\n        runs on the GPU.\n      </p>\n      <p>\n        You can use the directive #pragma unroll_loop in order to unroll a for loop in GLSL by the\n        shader preprocessor. The directive has to be placed right above the loop. The loop should be\n        formatted with the standard spec (normalized, var i, paren spacing)\n      </p>\n      <p>\n        Additionally, all shader materials will be subscribed to global uniforms: `u_mouse` (vec2),\n        `u_time` (float), and `u_resolution` (vec2)\n      </p>\n    </div>\n  );\n\n  static schema = {\n    input: {\n      vertex: Types.string.desc('Vertex shader for this shader material'),\n      fragment: Types.string.desc('Fragment shader for this shader material'),\n      transparent: Types.boolean.desc(\n        'Whether or not this material responds to an alpha component'\n      ),\n    },\n    output: { material: Types.object },\n    state: { material: Types.object },\n  };\n  static shortNames = { material: 'mat', transparent: 'transp' };\n\n  _setMaterial = () => {\n    this.state.material = new ShaderMaterial({\n      uniforms: uniforms,\n      vertexShader: get(this.props, 'vertex'),\n      fragmentShader: get(this.props, 'fragment'),\n      transparent: true,\n    });\n  };\n\n  onAddToGraph = () => {\n    this._setMaterial();\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    ['vertex', 'fragment'].forEach(k => {\n      if (!prevProps || newProps[k] !== prevProps[k]) {\n        this.state.material[`${k}Shader`] = newProps[k];\n        this.state.material.needsUpdate = true;\n      }\n    });\n    ['transparent'].forEach(k => {\n      if (!prevProps || newProps[k] !== prevProps[k]) {\n        this.state.material[k] = newProps[k];\n        this.state.material.needsUpdate = true;\n      }\n    });\n  };\n\n  process = () => {\n    return this.state;\n  };\n}\n","// @flow\nimport React from 'react';\nimport { uniq, isEqual } from 'lodash';\nimport NodeBase from 'models/NodeBase';\nimport Edge from 'models/Edge';\n\nconst Types = window.Types;\n\nexport class EqualsNode extends NodeBase<{}, { numbers: any[] }, { result: boolean }> {\n  static +displayName = 'Equals';\n  static +registryName = 'EqualsNode';\n  static description = <span>Strict equals operator</span>;\n  static schema = {\n    input: { input: Types.any.desc('Any set of members to perform strict equals over') },\n    output: { result: Types.number.desc('Logical equals over inputs') },\n    state: {},\n  };\n  _map: { [string]: any } = {};\n\n  process = () => ({ result: uniq(this.inputs.map(e => this._map[e.id])).length === 1 });\n\n  onInputChange = (edge: Edge, change: Object) => {\n    this._map[edge.id] = edge.inDataFor(change);\n    return this.outKeys();\n  };\n}\n\nexport class AndNode extends NodeBase<{}, { numbers: any[] }, { result: boolean }> {\n  static +displayName = 'AND';\n  static +registryName = 'AndNode';\n  static description = <span>Logical AND over inputs</span>;\n  static schema = {\n    input: { input: Types.any.desc('Any set of members to logical `AND` over') },\n    output: { result: Types.number.desc('Logical and of inputs') },\n    state: {},\n  };\n  _map: { [string]: any } = {};\n\n  process = () => ({ result: this.inputs.reduce((memo, e) => memo && this._map[e.id], true) });\n\n  onInputChange = (edge: Edge, change: Object) => {\n    this._map[edge.id] = edge.inDataFor(change);\n    return this.outKeys();\n  };\n}\n\nexport class OrNode extends NodeBase<{}, { numbers: any[] }, { result: boolean }> {\n  static +displayName = 'OR';\n  static +registryName = 'OrNode';\n  static description = <span>Logical OR over inputs</span>;\n  static schema = {\n    input: { input: Types.any.desc('Any set of members to logical `OR` over') },\n    output: { result: Types.number.desc('Logical OR of inputs') },\n    state: {},\n  };\n  _map: { [string]: any } = {};\n\n  process = () => ({ result: this.inputs.reduce((memo, e) => memo || this._map[e.id], false) });\n\n  onInputChange = (edge: Edge, change: Object) => {\n    this._map[edge.id] = edge.inDataFor(change);\n    return this.outKeys();\n  };\n}\n\nexport class NotNode extends NodeBase<{}, { in: any }, { result: boolean }> {\n  static +displayName = 'Not';\n  static +registryName = 'NotNode';\n  static description = <span>logical not</span>;\n  static schema = {\n    input: { in: Types.any.desc('anything. negation follows regular js semantics') },\n    output: { result: Types.boolean },\n    state: {},\n  };\n\n  process = () => ({ result: !this.props.in });\n  onInputChange = (edge: Edge, change: Object) => this.outKeys();\n}\n\nexport class SwitchNode extends NodeBase<{}, { value: any, not: any, else: any }, { result: any }> {\n  static +displayName = 'Switch';\n  static +registryName = 'SwitchNode';\n  static description = <span>An If-Else switch on value equality</span>;\n  static schema = {\n    input: {\n      value: Types.any.desc('Any value, as input to the switch'),\n      not: Types.any.desc('Any value to use to compare the input to'),\n      else: Types.any.desc('Any value to return if not logically equal'),\n    },\n    output: { result: Types.any.desc('Result of the switch') },\n    state: {},\n  };\n\n  requireForOutput = () => {\n    return typeof this.props.value !== 'undefined' && typeof this.props.not !== 'undefined';\n  };\n\n  process = () => ({\n    result: isEqual(this.props.value, this.props.not) ? this.props.else : this.props.value,\n  });\n\n  onInputChange = () => this.outKeys();\n}\n","// @flow\nimport React from 'react';\nimport { get } from 'lodash';\nimport NodeBase from 'models/NodeBase';\nimport Edge from 'models/Edge';\nimport { Geometry, Material, Mesh } from 'three';\nimport type { Pos, Pos3 } from 'types';\nconst Types = window.Types;\n\ntype P = { geometry: Geometry, material: Material, rotation: Pos, scale: Pos3 };\ntype S = { mesh: Mesh };\ntype O = { mesh: Mesh };\n\nexport default class MeshNode extends NodeBase<S, P, O> {\n  static +displayName = 'Mesh';\n  static +registryName = 'MeshNode';\n  static description = <span>A WebGL mesh</span>;\n\n  static schema = {\n    input: {\n      geometry: Types.object.desc('The geometry to use with this mesh'),\n      material: Types.object.desc(\"This mesh's material\"),\n      rotation: Types.Vec2.desc('The rotation of this mesh node, in radians'),\n      scale: Types.Vec3.desc('The scale of this mesh node'),\n    },\n    output: { mesh: Types.object },\n    state: { mesh: Types.object },\n  };\n\n  static shortNames = { material: 'mat', geometry: 'geo', rotation: 'rot' };\n\n  willBecomeLive = () => {\n    const { geometry, material } = this.props;\n    this.state.mesh = new Mesh(geometry, material);\n    this.notifyAllOutputs(true);\n  };\n\n  onAddToGraph = () => {\n    this.state.mesh = new Mesh();\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if (edge.toPort === 'rotation') {\n      const { rotation } = this.props;\n      this.state.mesh.rotation.x = rotation.x;\n      this.state.mesh.rotation.y = rotation.y;\n    }\n    if (edge.toPort === 'scale') {\n      const { scale } = this.props;\n      this.state.mesh.scale.x = scale.x;\n      this.state.mesh.scale.y = scale.y;\n      this.state.mesh.scale.z = scale.z;\n    }\n    if (edge.toPort === 'material') {\n      const mat = edge.inDataFor(change);\n      if (get(mat.id) !== get(this.state.mesh, 'material.id')) {\n        this.state.mesh.material && this.state.mesh.material.dispose();\n        this.state.mesh.material = mat;\n      }\n    }\n    if (edge.toPort === 'geometry') {\n      const geo = edge.inDataFor(change);\n      if (get(geo.id) !== get(this.state.mesh, 'geometry.id')) {\n        this.state.mesh.geometry && this.state.mesh.geometry.dispose();\n        this.state.mesh.geometry = geo;\n      }\n    }\n    return this.outKeys();\n  };\n\n  process = () => {\n    return this.state;\n  };\n}\n","// @flow\nimport React from 'react';\nimport NodeBase from 'models/NodeBase';\nimport Edge from 'models/Edge';\n\nconst Types = window.Types;\n\ntype MIDIOutput = {\n  id: string,\n  name: ?string,\n  type: string,\n};\n\nexport class MidiOutNode extends NodeBase<{}, { id?: string }, { device: ?MIDIOutput }> {\n  static +displayName = 'Midi Out';\n  static +registryName = 'MidiOutNode';\n  static description = (\n    <span>\n      A midi output device. If no id / name are provided, the first midi device found will be used\n    </span>\n  );\n  static schema = {\n    input: {\n      id: Types.string.desc(\n        'The midi out device id *or* name. The first matching one will be used in the case of collisions'\n      ),\n    },\n    output: { device: Types.object.desc('The midi output, or none if none were found') },\n    state: {},\n  };\n\n  _loaded: boolean = false;\n  available: MIDIOutput[] = [];\n  midi: ?MIDIOutput = null;\n\n  loadAll = async () => {\n    try {\n      const navigator = window.navigator;\n      const midi = await navigator.requestMIDIAccess();\n      this._loaded = true;\n      midi.outputs.forEach(output => this.available.push(output));\n      if (this.available.length > 0) this._setMidi(this.available[0].id);\n      this.notifyAllOutputs();\n    } catch (e) {\n      this._loaded = true;\n      console.log('no midi devices found');\n    }\n  };\n\n  _setMidi = (id: string) => {\n    this.midi = this.available.find(o => o.id === id || o.name === id) || this.midi;\n    if (this.midi) {\n      console.log('connected to midi out', this.midi.name);\n    }\n    this.notifyAllOutputs();\n  };\n\n  onAddToGraph = () => {\n    this.loadAll();\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    if (newProps.id && (!prevProps || newProps.id !== prevProps.id)) {\n      const id = String(newProps.id);\n      if (this._loaded) {\n        this._setMidi(id);\n      } else {\n        this.loadAll().then(() => {\n          this._setMidi(id);\n        });\n      }\n    }\n  };\n\n  process = () => ({ device: this.midi });\n\n  onInputChange = (edge: Edge, change: Object) => this.outKeys();\n}\n\nexport class MidiInNode extends NodeBase<{}, { id?: string }, { device: ?MIDIOutput }> {\n  static +displayName = 'Midi In';\n  static +registryName = 'MidiInNode';\n  static description = (\n    <span>\n      A midi input device. If no id / name are provided, the first midi device found will be used\n    </span>\n  );\n  static schema = {\n    input: {\n      id: Types.string.desc(\n        'The midi in device id *or* name. The first matching one will be used in the case of collisions'\n      ),\n    },\n    output: { device: Types.object.desc('The midi input, or none if none were found') },\n    state: {},\n  };\n\n  _loaded: boolean = false;\n  available: MIDIOutput[] = [];\n  midi: ?MIDIOutput = null;\n\n  loadAll = async () => {\n    try {\n      const navigator = window.navigator;\n      const midi = await navigator.requestMIDIAccess();\n      this._loaded = true;\n      midi.inputs.forEach(output => this.available.push(output));\n      if (this.available.length > 0) this.midi = this.available[0];\n      this.notifyAllOutputs();\n    } catch (e) {\n      this._loaded = true;\n      console.log('no midi devices found');\n    }\n  };\n\n  _setMidi = (id: string) => {\n    this.midi = this.available.find(o => o.id === id || o.name === id) || this.midi;\n    this.notifyAllOutputs();\n  };\n\n  onAddToGraph = () => {\n    this.loadAll();\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    if (newProps.id && (!prevProps || newProps.id !== prevProps.id)) {\n      const id = String(newProps.id);\n      if (this._loaded) {\n        this._setMidi(id);\n      } else {\n        this.loadAll().then(() => {\n          this._setMidi(id);\n        });\n      }\n    }\n  };\n\n  process = () => ({ device: this.midi });\n\n  onInputChange = (edge: Edge, change: Object) => this.outKeys();\n}\n","// @flow\nimport React from 'react';\nimport { get, reverse, set } from 'lodash';\nimport NodeBase from 'models/NodeBase';\nimport Edge from 'models/Edge';\nimport { TT } from 'models/nodes/ToneNode';\nimport { arrayOf } from 'utils/typeUtils';\nconst Types = window.Types;\n\nexport class InfoLog extends NodeBase<{}, { anything: any }, { anything: any }> {\n  static +displayName = 'InfoLog';\n  static +registryName = 'InfoLog';\n  static description = <span>Log any inputs as they come to console info</span>;\n  static schema = {\n    input: { anything: Types.any.desc('Anything you would like to log') },\n    output: { anything: Types.any.desc('The input, passed through') },\n    state: {},\n  };\n\n  process = () => ({ anything: this.props.anything });\n\n  onInputChange = (edge: Edge, change: Object) => {\n    console.log(edge.from.constructor.displayName, edge.fromPort, edge.inDataFor(change));\n    return this.outKeys();\n  };\n}\n\nexport class JSONParse extends NodeBase<{}, { in: string }, { out: Object }> {\n  static +displayName = 'JSON Parse';\n  static +registryName = 'JSONParse';\n  static description = <span>Parse a string into an object</span>;\n  static schema = {\n    input: { in: Types.string.desc('String serialization') },\n    output: { out: Types.object.desc('Parsed object') },\n    state: {},\n  };\n\n  process = () => ({ out: this.props.in ? JSON.parse(this.props.in) : {} });\n\n  onInputChange = () => this.outKeys();\n}\n\nexport class ExtractNode extends NodeBase<{}, { from: any, get: string }, { out: any }> {\n  static +displayName = 'Extract';\n  static +registryName = 'ExtractNode';\n  static description = <span>Extract a value from an object. Complement of SetNode</span>;\n  static schema = {\n    input: {\n      from: Types.object.desc('Object to extract from'),\n      get: Types.string.desc(\n        <span>\n          The key to get. You can traverse an object with dot notation, i.e. <code>foo.bar</code>\n        </span>\n      ),\n    },\n    output: {\n      out: Types.any.desc(\n        <span>\n          The extracted value, or <code>undefined</code>\n        </span>\n      ),\n    },\n    state: {},\n  };\n\n  process = () => ({ out: get(this.props.from, this.props.get || '') });\n\n  onInputChange = () => this.outKeys();\n}\n\nexport class SetNode extends NodeBase<{}, { target: any, path: string, value: any }, { out: any }> {\n  static +displayName = 'Set Value';\n  static +registryName = 'SetNode';\n  static description = <span>Set a value on any object / array. Complement of ExtractNode</span>;\n  static schema = {\n    input: {\n      target: Types.object.desc('Object / array to set to'),\n      path: Types.string.desc(\n        <span>\n          The path to set at. You can use dot notation, i.e. <code>foo.bar</code>\n        </span>\n      ),\n      value: Types.any.desc('The value to set at path.'),\n    },\n    output: {\n      out: Types.any.desc(\n        <span>\n          The extracted value, or <code>undefined</code>\n        </span>\n      ),\n    },\n    state: {},\n  };\n  _val: any;\n\n  process = () => ({ out: this._val });\n\n  onInputChange = () => {\n    this._val = set(this.props.target, this.props.path || '', this.props.value);\n    return this.outKeys();\n  };\n}\n\nexport class StephenWolfram extends NodeBase<\n  {},\n  { rule: number, state: (0 | 1)[] | string },\n  { out: (0 | 1)[] }\n> {\n  static +displayName = 'Stephen Wolfram';\n  static +registryName = 'StephenWolfram';\n  static description = (\n    <span>\n      Stephen Wolfram is an operator that, when given a 1D cellular automata rule number [0-255] and\n      a binary representation of the world, outputs the subsequent state of the world according to\n      that rule. He can do this indefinitely and is, in fact, Earth's first eternal human.\n    </span>\n  );\n  static schema = {\n    input: {\n      rule: Types.number.desc(\n        'The rule number. Given a binary state and two neighbors (2^3 states), a transition rule set can be encoded with a binary number with each digit slot representing the next state of that configuration (2^(2^3) rule sets).'\n      ),\n      initialState: Types.any.desc(\n        \"He doesn't know or care where it comes from, but Wolfram needs an initial state in order to operate. His world is probably circular, so the first index and last index are assumed to be neighbors for rule application. Both binary strings and binary arrays are acceptable.\"\n      ),\n      call: TT.Call,\n    },\n    output: { out: arrayOf(Types.number).desc('The resulting binary array') },\n    state: {},\n  };\n\n  currentState: (0 | 1)[] = [];\n  transitions: (0 | 1)[];\n\n  static toBin8(rule: number): (0 | 1)[] {\n    const bin = [...rule.toString(2)].map(s => parseInt(s, 10));\n    if (bin.length < 8) {\n      bin.unshift(...[...new Array(8 - bin.length)].map(() => 0));\n    }\n    // $FlowIssue\n    return reverse(bin);\n  }\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    if (!prevProps || newProps.rule !== prevProps.rule) {\n      this.transitions = StephenWolfram.toBin8(newProps.rule);\n    }\n    if (!prevProps || newProps.initialState !== prevProps.initialState) {\n      const state = newProps.initialState;\n      if (Array.isArray(state)) {\n        this.currentState = state.map(a => parseInt(a));\n      } else if (typeof state === 'string') {\n        this.currentState = state.split('').map(s => parseInt(s));\n      }\n    }\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if ('call' === edge.toPort) {\n      if (edge.inDataFor(change)) {\n        const { rule } = this.props;\n        const state = this.currentState;\n        if (state && Array.isArray(state) && typeof rule === 'number') {\n          this.currentState = state.map((i, index) => {\n            const lIdx = (((index - 1) % state.length) + state.length) % state.length;\n            const rIdx = (index + 1) % state.length;\n            // noinspection EqualityComparisonWithCoercionJS accept coercion for convenience\n            // eslint-disable-next-line eqeqeq\n            const num = (state[lIdx] == 1 ? 4 : 0) + (i == 1 ? 2 : 0) + (state[rIdx] == 1 ? 1 : 0);\n            return this.transitions[num];\n          });\n          this.notifyAllOutputs(true);\n        }\n      }\n    }\n    return [];\n  };\n\n  process = () => ({ out: this.currentState });\n}\n\nexport class CollectNode extends NodeBase<{}, { capacity: number, value: any }, { out: any[] }> {\n  static +displayName = 'Collect';\n  static +registryName = 'HistoryNode';\n  static description = (\n    <span>\n      Buffer values from an input stream. If memory capacity is reached, oldest values are purged\n      first\n    </span>\n  );\n  static schema = {\n    input: {\n      capacity: Types.number.desc(\n        'The max number of elements to keep. Omitting this means no limit'\n      ),\n      value: Types.any.desc('Any value. This will be pushed into the output collector'),\n    },\n    output: { out: arrayOf(Types.any).desc('The collected queue, oldest to newest.') },\n    state: {},\n  };\n\n  memory: any[] = [];\n\n  process = () => ({ out: this.memory });\n  onInputChange = (edge: Edge, change: Object) => {\n    if ('value' === edge.toPort) {\n      const data = edge.inDataFor(change);\n      if (data) {\n        const { capacity } = this.props;\n        if (typeof capacity === 'number' && this.memory.length >= capacity) {\n          this.memory.shift();\n        }\n        // todo a better slice\n        this.memory.push(data);\n        this.notifyAllOutputs(true);\n      }\n    }\n    return [];\n  };\n}\n\nexport class JoinNode extends NodeBase<{}, { array: any[], separator: string }, { out: string }> {\n  static +displayName = 'Join';\n  static +registryName = 'JoinNode';\n  static description = <span>Join an array of values together with a separator</span>;\n  static schema = {\n    input: {\n      array: Types.object.desc('Array of any data. Ideally this data is string serializable.'),\n      separator: Types.string.desc('Separator string to join elements together with'),\n    },\n    output: { out: Types.string.desc('The joined array, as a string') },\n    state: {},\n  };\n\n  process = () => {\n    const val = (this.props.array || []).join(this.props.separator || '');\n    return { out: val };\n  };\n\n  onInputChange = () => this.outKeys();\n}\n\nexport class RegexReplace extends NodeBase<\n  {},\n  { string: string, regex: RegExp | string, replacement: string },\n  { out: string }\n> {\n  static +displayName = 'Regex Replace';\n  static +registryName = 'RegexReplace';\n  static description = <span>Replace a regex match with something else</span>;\n  static schema = {\n    input: {\n      string: Types.string.desc('The string over which to perform the replace'),\n      regex: Types.string.desc('the regexp'),\n      replacement: Types.string.desc('The string to replace matches with'),\n    },\n    output: { out: Types.string.desc('The joined array, as a string') },\n    state: {},\n  };\n  re: RegExp;\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    if (!prevProps || (newProps.regex !== prevProps.regex && newProps.regex)) {\n      const parsed = newProps.regex.match(/\\/(.+)\\/(\\w*)/);\n      if (parsed) {\n        // eslint-disable-next-line no-unused-vars\n        const [_, t, f] = parsed;\n        this.re = new RegExp(t, f);\n      } else {\n        this.re = new RegExp(newProps.regex);\n      }\n    }\n  };\n\n  requireForOutput = () =>\n    Boolean(this.re && this.props.string && typeof this.props.replacement !== 'object');\n\n  process = () => {\n    const { string, replacement } = this.props;\n    return { out: string.replace(this.re, replacement) };\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    return this.outKeys();\n  };\n}\n\nexport class ArrayFillNode extends NodeBase<{}, { length: number, fillWith: any }, { out: any[] }> {\n  static +displayName = 'Array Fill';\n  static +registryName = 'ArrayFillNode';\n  static description = <span>Create an array filled with a value</span>;\n  static schema = {\n    input: {\n      length: Types.number.desc('The length of this array'),\n      fillWith: Types.any.desc('The value to fill with'),\n    },\n    output: { out: arrayOf(Types.any).desc('An array, filled to length by value') },\n    state: {},\n  };\n\n  process = (): { out: any[] } => ({\n    out: [...new Array(this.props.length || 0)].map(() => this.props.fillWith),\n  });\n\n  onInputChange = () => this.outKeys();\n}\n\nexport class CountSourceNode extends NodeBase<{}, {}, { count: number }> {\n  static +displayName = 'Count Source';\n  static +registryName = 'CountSourceNode';\n  static description = <span>Create an array filled with a value</span>;\n  static schema = {\n    input: {},\n    output: { count: Types.number.desc('The output count') },\n    state: {},\n  };\n  _count = 0;\n\n  process = () => ({ count: this._count++ });\n\n  onInputChange = () => this.outKeys();\n}\n\nexport class ZipNode extends NodeBase<\n  {},\n  { arg1: any, arg2: any, arg3: any, arg4: any },\n  { zipped: any[] }\n> {\n  static +displayName = 'Zip';\n  static +registryName = 'ZipItemsNode';\n  static description = <span>Zip elements from an input stream</span>;\n  static schema = {\n    input: {\n      arg1: Types.any.desc('Any object to zip'),\n      arg2: Types.any.desc('Any object to zip'),\n      arg3: Types.any.desc('Any object to zip'),\n      arg4: Types.any.desc('Any object to zip'),\n    },\n    output: { zipped: arrayOf(Types.any).desc('The zipped object') },\n    state: {},\n  };\n\n  requireForOutput = () => this.inputs.length >= 2;\n  process = () => ({ zipped: this.forAllConnectedInputs((k, v) => v) });\n  onInputChange = () => this.outKeys();\n}\n","// @flow\nimport React from 'react';\nimport NodeBase from 'models/NodeBase';\nimport type { Pos } from 'types';\nconst Types = window.Types;\n\ntype P = Pos;\ntype S = { value: Pos };\ntype O = { out: Pos };\n\nexport default class Vector2D extends NodeBase<S, P, O> {\n  static +displayName = 'Vector 2D';\n  static +registryName = 'Vector2D';\n\n  static description = (\n    <span>\n      A two dimensional vector with keys <code>x</code> and <code>y</code>\n    </span>\n  );\n\n  static schema = {\n    input: { x: Types.number, y: Types.number },\n    output: { out: Types.Vec2 },\n    state: { value: Types.Vec2 },\n  };\n\n  onInputChange = () => {\n    this.state.value = this.props;\n    return this.outKeys();\n  };\n\n  process = () => {\n    return { out: this.state.value };\n  };\n}\n","// @flow\nimport React from 'react';\nimport NodeBase from 'models/NodeBase';\nimport type { Pos3 } from 'types';\nconst Types = window.Types;\n\ntype P = Pos3;\ntype S = { value: Pos3 };\ntype O = { out: Pos3 };\n\nexport default class Vector3D extends NodeBase<S, P, O> {\n  static +displayName = 'Vector 3D';\n  static +registryName = 'Vector3D';\n\n  static description = (\n    <span>\n      A two dimensional vector with <code>x</code> <code>y</code> and <code>y</code> components\n    </span>\n  );\n\n  static schema = {\n    input: { x: Types.number, y: Types.number, z: Types.number },\n    output: { out: Types.Vec3 },\n    state: { value: Types.Vec3 },\n  };\n\n  onInputChange = () => {\n    this.state.value = this.props;\n    return this.outKeys();\n  };\n\n  process = () => {\n    return { out: this.state.value };\n  };\n}\n","// @flow\nimport React from 'react';\nimport NodeBase from 'models/NodeBase';\n\nconst Types = window.Types;\n\nexport class DomNode extends NodeBase<{}, { html: string, style: string, text: ?string }, null> {\n  static +displayName = 'HTML Element';\n  static +registryName = 'DomNode';\n  static description = <span>A node that renders HTML to the screen</span>;\n  static defaultProps = { html: '' };\n  static schema = {\n    input: {\n      html: Types.string.desc('The html for this element'),\n      text: Types.string.desc('The inner text of this element'),\n      style: Types.string.desc('The style attribute for this node'),\n    },\n    output: {},\n    state: {},\n  };\n  domNode: HTMLElement;\n  inserted: boolean = false;\n\n  _ensureExist = () => {\n    if (this.inserted) {\n      return;\n    }\n    this.domNode = document.createElement('div');\n    this.props.style && this.domNode.setAttribute('style', this.props.style);\n    setTimeout(() => this._tryInsert(), 20);\n  };\n\n  _tryInsert = () => {\n    if (this.inserted) {\n      return;\n    }\n    const root = document.getElementById('graph-root');\n    const scalable = document.getElementById('graph-scalable');\n    if (root && scalable) {\n      this.inserted = Boolean(root.insertBefore(this.domNode, scalable));\n    }\n    if (!this.inserted) {\n      setTimeout(() => this._tryInsert(), 20);\n    }\n  };\n\n  willReceiveProps = (newProps: Object, prevProps: Object) => {\n    this._ensureExist();\n    if (!prevProps || newProps.text !== prevProps.text) {\n      this.domNode.innerText = newProps.text;\n    }\n    if (!prevProps || newProps.html !== prevProps.html) {\n      this.domNode.innerHTML = newProps.html;\n    }\n    if (!prevProps || newProps.style !== prevProps.style) {\n      this.domNode.setAttribute('style', newProps.style);\n    }\n  };\n\n  process = () => null;\n}\n","// @flow\nimport React from 'react';\nimport NodeBase from 'models/NodeBase';\n\nconst Types = window.Types;\n\nexport class PlusNode extends NodeBase<{}, { left: any, right: any }, { out: any }> {\n  static +displayName = 'Plus';\n  static +registryName = 'PlusNode';\n  static description = <span>A plus operator. Usable with both strings and numbers.</span>;\n  static schema = {\n    input: {\n      left: Types.any.desc('left hand side'),\n      right: Types.any.desc('right hand side'),\n    },\n    output: { out: Types.any.desc('The result') },\n    state: {},\n  };\n\n  process = () => ({\n    out: this.props.left + this.props.right,\n  });\n}\n","// @flow\nimport React from 'react';\nimport { get } from 'lodash';\nimport { Chord, Scale } from 'tonal';\nimport * as Key from 'tonal-key';\nimport { chroma } from 'tonal-pcset';\nimport { transpose } from 'tonal-distance';\nimport NodeBase from 'models/NodeBase';\nimport Edge from 'models/Edge';\nimport { arrayOf } from 'utils/typeUtils';\nconst Types = window.Types;\n// window.Chord = Chord;\n// window.Key = Key;\n// window.Scale = Scale;\n\nconst TT = {\n  Note: Types.string.aliased(\n    'Note',\n    'Note encoding, can be something like A4, a midi index, or a raw frequency in Hz'\n  ),\n  Interval: Types.string.aliased(\n    'Interval',\n    'Natural interval name, e.g. 1P, 2M, 3M, 4P, 5P, 6m, 7m'\n  ),\n  Scale: Types.string.aliased(\n    'ScaleName',\n    <div>\n      <p>One of:</p>\n      <p style={{ display: 'flex', flexWrap: 'wrap' }}>\n        {Scale.names().map(n => (\n          <code style={{ marginRight: 5, marginBottom: 6 }} key={n}>\n            {n}\n          </code>\n        ))}\n      </p>\n    </div>\n  ),\n  Chord: Types.string.aliased(\n    'ChordName',\n    <div>\n      <p>One of:</p>\n      <p style={{ display: 'flex', flexWrap: 'wrap' }}>\n        {Chord.names().map(n => (\n          <code style={{ marginRight: 5, marginBottom: 6 }} key={n}>\n            {n}\n          </code>\n        ))}\n      </p>\n    </div>\n  ),\n};\nexport class ScaleNode extends NodeBase<\n  {},\n  { name: string, tonic: string },\n  { notes: string[], intervals: string[] }\n> {\n  static +displayName = 'Music Scale';\n  static +registryName = 'ScaleNode';\n  static description = <span>A Musical scale</span>;\n  static schema = {\n    input: {\n      tonic: Types.string.desc(\n        'The tonic for this scale, e.g. \"C\" or \"Ab4\". ' +\n          'You can optionally specify the scale name here too, and omit the name input, e.g. \"C minor pentatonic\"' +\n          ' See the name param info for possible scale names.'\n      ),\n      name: TT.Scale.desc('The name of the scale. Check type for possible values'),\n    },\n    output: {\n      notes: arrayOf(TT.Note).desc('The notes in this scale'),\n      intervals: arrayOf(TT.Interval).desc('The intervals between notes in this scale'),\n    },\n    state: {},\n  };\n\n  process = () => {\n    if (!get(this.props, 'tonic')) {\n      return { notes: [], intervals: [] };\n    }\n    return {\n      notes: Scale.notes(this.props.tonic, this.props.name),\n      intervals: Scale.intervals(this.props.name || this.props.tonic),\n    };\n  };\n\n  onInputChange = () => this.outKeys();\n}\n\nexport class ChordNode extends NodeBase<\n  {},\n  { name: string, tonic: string },\n  { notes: string[], intervals: string[] }\n> {\n  static +displayName = 'Music Chord';\n  static +registryName = 'ChordNode';\n  static description = <span>A Chord</span>;\n  static schema = {\n    input: {\n      tonic: Types.string.desc(\n        'The tonic for this scale, e.g. \"C\" or \"Ab4\". ' +\n          'You can optionally specify the chord name here too, and omit the name input, e.g. \"E Maj7\"' +\n          ' See the name param info for recognized chord names.'\n      ),\n      name: TT.Chord.desc('The name of the chord. Check type for possible values'),\n    },\n    output: {\n      notes: arrayOf(TT.Note).desc('The notes in this chord'),\n      intervals: arrayOf(TT.Interval).desc('The intervals between notes in this chord'),\n    },\n    state: {},\n  };\n\n  process = () => {\n    if (!get(this.props, 'tonic')) {\n      return { notes: [], intervals: [] };\n    }\n    return {\n      notes: Chord.notes(this.props.tonic, this.props.name),\n      intervals: Chord.intervals(this.props.name || this.props.tonic),\n    };\n  };\n\n  onInputChange = () => this.outKeys();\n}\n\nexport class KeyTriadsNode extends NodeBase<{}, { key: string }, { notes: string[] }> {\n  static +displayName = 'Key Triads';\n  static +registryName = 'KeyTriadsNode';\n  static description = <span>Triads For a Key</span>;\n  static schema = {\n    input: {\n      key: Types.string.desc('The name of the key (a tonic + a mode), e.g. C major, Db dorian'),\n    },\n    output: {\n      notes: arrayOf(TT.Note).desc('Triad lead-sheet symbols for this key'),\n    },\n    state: {},\n  };\n\n  process = () => {\n    if (!get(this.props, 'key')) {\n      return { notes: [] };\n    }\n    return { notes: Key.triads(this.props.key) };\n  };\n\n  onInputChange = (edge: Edge, change: Object) => this.outKeys();\n}\n\nexport class TransposeNode extends NodeBase<\n  {},\n  { note: string, interval: string },\n  { out: ?string }\n> {\n  static +displayName = 'Transpose';\n  static +registryName = 'TransposeNode';\n  static description = <span>Transpose a note by an interval. e.g. transpose(A4, M3) -> C#5 </span>;\n  static schema = {\n    input: {\n      note: Types.string.desc(\n        'The note to transpose. This can be abstract or a concrete pitch, i.e. C or C4'\n      ),\n      interval: Types.string.desc('The interval to transpose by, e.g. P5 or M3'),\n    },\n    output: { out: Types.string.desc('The note, transposed by the interval') },\n    state: {},\n  };\n\n  process = () => {\n    if (this.props.note && this.props.interval) {\n      return { out: transpose(this.props.note, this.props.interval) };\n    }\n    return { out: undefined };\n  };\n\n  onInputChange = (edge: Edge, change: Object) => this.outKeys();\n}\n\nexport class ChromaNode extends NodeBase<{}, { notes: string[] }, { chroma: number[] }> {\n  static +displayName = 'Scale Chroma';\n  static +registryName = 'ChromaNode';\n  static description = (\n    <span>\n      A chroma representation of a pitchset as a 12-digit binary array, with each index presenting\n      one semitone of the octave\n    </span>\n  );\n  static schema = {\n    input: {\n      notes: arrayOf(TT.Note).desc('A list of notes to compute a chroma for'),\n    },\n    output: {\n      chroma: arrayOf(Types.number).desc(\n        'the chroma output: 12-digit binary array, with each index presenting one semitone of the octave'\n      ),\n    },\n    state: {},\n  };\n\n  process = () => {\n    if (!get(this.props, 'notes') || !Array.isArray(this.props.notes)) {\n      return { chroma: [] };\n    }\n    return {\n      chroma: chroma(this.props.notes)\n        .split('')\n        .map(s => parseInt(s)),\n    };\n  };\n\n  onInputChange = (edge: Edge, change: Object) => this.outKeys();\n}\n","// @flow\nimport React from 'react';\nimport NodeBase from 'models/NodeBase';\nimport Edge from 'models/Edge';\n\nconst Types = window.Types;\n\nexport class DivideNode extends NodeBase<\n  {},\n  { dividend: number, divisor: number },\n  { result: number, int: number }\n> {\n  static +displayName = 'Divide';\n  static +registryName = 'DivideNode';\n  static +defaultProps = { dividend: 0, divisor: 1 };\n  static description = <span>Divide one number by another</span>;\n  static schema = {\n    input: { dividend: Types.number, divisor: Types.number },\n    output: { result: Types.number, int: Types.number },\n    state: {},\n  };\n\n  process = () => ({\n    result: this.props.dividend / this.props.divisor,\n    int: parseInt(this.props.dividend / this.props.divisor, 10),\n  });\n\n  onInputChange = () => (this.props.dividend && this.props.divisor ? this.outKeys() : []);\n}\n\nexport class SumNode extends NodeBase<{}, { numbers: number[] }, { result: number }> {\n  static +displayName = 'Sum';\n  static +registryName = 'SumNode';\n  static description = <span>Sum across numbers</span>;\n  static schema = {\n    input: { numbers: Types.number.desc('All numbers to add together') },\n    output: { result: Types.number.desc('Sum') },\n    state: {},\n  };\n  _map: { [string]: number } = {};\n\n  process = () => ({ result: this.inputs.reduce((memo, e) => memo + this._map[e.id] || 0, 0) });\n\n  onInputChange = (edge: Edge, change: Object) => {\n    this._map[edge.id] = edge.inDataFor(change);\n    return this.outKeys();\n  };\n}\n\nexport class ProductNode extends NodeBase<{}, { numbers: number[] }, { result: number }> {\n  static +displayName = 'Product';\n  static +registryName = 'ProductNode';\n  static description = <span>Multiply over numbers</span>;\n  static schema = {\n    input: { numbers: Types.number.desc('All numbers to multiply together') },\n    output: { result: Types.number.desc('Product') },\n    state: {},\n  };\n  _map: { [string]: number } = {};\n\n  process = () => ({ result: this.inputs.reduce((memo, e) => memo * this._map[e.id] || 0, 1) });\n\n  onInputChange = (edge: Edge, change: Object) => {\n    this._map[edge.id] = edge.inDataFor(change);\n    return this.outKeys();\n  };\n}\n\nexport class IntToIntMathNode extends NodeBase<\n  {},\n  { fn: string, in: number },\n  { result: ?number }\n> {\n  static +displayName = 'Math: Int -> Int';\n  static +registryName = 'IntToIntMathNode';\n  static description = (\n    <div>\n      Admittedly a node borne of laziness -- given a standard js math package operation name, this\n      node performs that operation. Constants are included. Full signature list in MathFnIntInt\n      help. For non unary functions like <code>min</code>, an array argument can be spread into the\n      args.\n    </div>\n  );\n  static schema = {\n    input: {\n      fn: Types.string\n        .aliased(\n          'MathFn',\n          <div>\n            <p>Signatures for the available functions</p>\n            <p>\n              E: number; LN10: number; LN2: number; LOG10E: number; LOG2E: number; PI: number;\n              SQRT1_2: number; SQRT2: number; abs(x: number): number; acos(x: number): number;\n              acosh(x: number): number; asin(x: number): number; asinh(x: number): number; atan(x:\n              number): number; atan2(y: number, x: number): number; atanh(x: number): number;\n              cbrt(x: number): number; ceil(x: number): number; cos(x: number): number; cosh(x:\n              number): number; exp(x: number): number; expm1(x: number): number; floor(x: number):\n              number; fround(x: number): number; log(x: number): number; log10(x: number): number;\n              log1p(x: number): number; log2(x: number): number; pow(x: number, y: number): number;\n              random(): number; round(x: number): number; sign(x: number): number; sin(x: number):\n              number; sinh(x: number): number; sqrt(x: number): number; tan(x: number): number;\n              tanh(x: number): number; trunc(x: number): number; max(...args: number[]);\n              min(...args: number[])\n            </p>\n          </div>\n        )\n        .desc('The function name. Check type info for options'),\n      in: Types.number,\n    },\n    output: { result: Types.number },\n    state: {},\n  };\n\n  requireForOutput = () =>\n    (this.props.in || typeof this.props.in === 'number') && typeof this.props.fn === 'string';\n\n  process = () => {\n    return {\n      result: Math[this.props.fn].apply(\n        null,\n        Array.isArray(this.props.in) ? this.props.in : [this.props.in]\n      ),\n    };\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    return this.outKeys();\n  };\n}\n","// @flow\nimport React from 'react';\nimport NodeBase from 'models/NodeBase';\nimport Edge from 'models/Edge';\nimport * as tf from '@tensorflow/tfjs-core';\nimport { webgl } from '@tensorflow/tfjs-core';\nimport { arrayOf } from 'utils/typeUtils';\n\nconst Types = window.Types;\n\nconst TT = {\n  Program: Types.object.aliased('GPGPUProgram', 'An uncompiled GPGPU program'),\n};\nexport class GPGPUProgramNode extends NodeBase<\n  {},\n  { userCode: string, outputShape: ?(number[]), variableNames: string[] },\n  { program: webgl.GPGPUProgram }\n> {\n  static +displayName = 'GPGPU Program';\n  static +registryName = 'GPGPUProgram';\n  static +defaultProps = { variableNames: [], outputShape: [], userCode: '' };\n  static shortNames = { variableNames: 'varNames', outputShape: 'outShape' };\n  static description = (\n    <span>Define a GPGPU program to be run on your machine's compatible backend</span>\n  );\n  static schema = {\n    input: {\n      userCode: Types.string\n        .desc(\n          <p>\n            Your user code for the kernel to be uploaded to your graphics hardware. Syntax is\n            specific to your backend, but a safe bet is conforming to the OpenGL/WebGL standards\n            that your hardware supports. In order to set an output to your kernel call{' '}\n            <code>setOutput</code> in your kernel's main function. To get the output coords in your\n            computation call <code>getOutputCoords</code>.\n          </p>\n        )\n        .aliased('GPGPUKernel', 'An open frameworks compliant shader program'),\n      outputShape: arrayOf(Types.number).desc(\n        <p>\n          A tensor shape describing the kernel output, e.g. <code>[100, 100]</code>. if omitted,\n          output shape is assumed to be the same as the input shape\n        </p>\n      ),\n      variableNames: arrayOf(Types.string).desc(\n        <p>\n          A list of variable names that your kernel will use. This gives you access to functions\n          inside your program kernel. i.e. variable named <code>X</code> gives you the methods{' '}\n          <code>getXAtOutCoords</code> and <code>getX</code>\n        </p>\n      ),\n    },\n    output: {\n      program: TT.Program.desc(\n        'Program info output. Use the \"Run GPGPU\" node to compile and run this over inputs'\n      ),\n    },\n    state: {},\n  };\n  _varNames = [];\n\n  updateProgram = (up: { variableNames?: string[] | string }) => {\n    if (up.variableNames) {\n      if (Array.isArray(up.variableNames)) {\n        this._varNames = up.variableNames;\n      } else if (\n        typeof up.variableNames === 'string' &&\n        !this._varNames.includes(up.variableNames)\n      ) {\n        this._varNames.push(up.variableNames);\n      }\n    }\n  };\n\n  process = () => ({ program: { ...this.props, variableNames: this._varNames } });\n\n  onInputChange = (edge: Edge, change: Object) => {\n    this.updateProgram(change);\n    return this.outKeys();\n  };\n}\n\nexport class RunGPGPUProgramNode extends NodeBase<\n  {},\n  { program: webgl.GPGPUProgram, input: any[] },\n  { result: number[] }\n> {\n  static +displayName = 'Run GPGPU';\n  static +registryName = 'RunGPGPUProgram';\n  static description = (\n    <span>\n      Compile and run a GPGPU program. Kernels passed in will be compiled and cached, so that\n      subsequent calls to kernels will not create new binaries.\n    </span>\n  );\n  static schema = {\n    input: {\n      program: TT.Program.desc('The uncompiled program info to be turned into a full WebGL shader'),\n      input: arrayOf(Types.any).desc('The input tensor to run through the compiled program kernel'),\n    },\n    output: { result: arrayOf(Types.any).desc('Program output') },\n    state: {},\n  };\n  _inputQ: any[][] = [];\n  _result: any;\n\n  process = () => ({ result: this._result });\n\n  // TODO can we batch this in handles?\n  _compileAndRun = () => {\n    const { program } = this.props;\n    if (!program) {\n      return;\n    }\n    this._inputQ.forEach(async input => {\n      const i = tf.tensor(input);\n      const { program } = this.props;\n      if (program && program.outputShape.length === 0) {\n        program.outputShape = i.shape.slice();\n      }\n      this._result = await tf\n        .backend()\n        .compileAndRun(program, [i])\n        .data();\n      this._result && this.notifyOutputs('result');\n    });\n    this._inputQ = [];\n  };\n\n  onInputChange = (edge: Edge, change: Object) => {\n    if (edge.toPort === 'input') {\n      const i = edge.inDataFor(change);\n      i && this._inputQ.push(i);\n    }\n    this._compileAndRun();\n    return [];\n  };\n}\n","// @flow\nimport React from 'react';\nimport NodeBase from 'models/NodeBase';\nimport Edge from 'models/Edge';\n\nconst Types = window.Types;\n\nexport class JSCodeNode extends NodeBase<\n  {},\n  { userCode: string, arg1: any, arg2: any, arg3: any, arg4: any, arg5: any },\n  { return: any }\n> {\n  static +displayName = 'JS Code';\n  static +registryName = 'JSCodeNode';\n  static description = (\n    <span>\n      Define arbitrary JS code in this node. Runtime compatibility is based on your browser\n    </span>\n  );\n  static schema = {\n    input: {\n      userCode: Types.string\n        .aliased(\n          'JSFunction',\n          <div>\n            A valid JS code block. You should call <code>return</code> at the end of your function\n            to provide an output.\n          </div>\n        )\n        .desc(\n          <p>\n            A JS code block that returns something over the inputs. You can reference variables by\n            input name, e.g. <code>arg1</code>\n          </p>\n        ),\n      arg1: Types.any.desc(\n        <p>\n          Any arg to supply to the user code block, accessible via <code>arg1</code>\n        </p>\n      ),\n      arg2: Types.any.desc(\n        <p>\n          Any arg to supply to the user code block, accessible via <code>arg2</code>\n        </p>\n      ),\n      arg3: Types.any.desc(\n        <p>\n          Any arg to supply to the user code block, accessible via <code>arg3</code>\n        </p>\n      ),\n      arg4: Types.any.desc(\n        <p>\n          Any arg to supply to the user code block, accessible via <code>arg4</code>\n        </p>\n      ),\n      arg5: Types.any.desc(\n        <p>\n          Any arg to supply to the user code block, accessible via <code>arg5</code>\n        </p>\n      ),\n    },\n    output: { return: Types.any.desc('Whatever was returned in the userCode block') },\n    state: {},\n  };\n\n  _argsCode = () => `\n  const arg1 = ${this.props.arg1};\n  const arg2 = ${this.props.arg2};\n  const arg3 = ${this.props.arg3};\n  const arg4 = ${this.props.arg4};\n  const arg5 = ${this.props.arg5};\n  `;\n\n  make = () =>\n    window.Function(`\n  \"use strict\";\n  ${this._argsCode()}\n  ${this.props.userCode}\n  `);\n\n  requireForOutput = () => Boolean(this.props.userCode);\n  process = () => {\n    const r = { return: this.make()() };\n    return r;\n  };\n  onInputChange = (edge: Edge, change: Object) => this.outKeys();\n}\n","// @flow\nimport NodeBase from 'models/NodeBase';\nimport { TypeImpl } from 'models/AttributeType';\nconst Types = window.Types;\n\ntype S = { value: any };\ntype O = { out: any };\n\nconst [number, string, boolean, date] = ['number', 'string', 'boolean', 'date']\n  .map(n => Types[n])\n  .map(\n    (_t: TypeImpl) =>\n      class _PrimNode extends NodeBase<S, null, O> {\n        static defaultState = { value: _t.defaultValue };\n        static displayName = _t.name;\n        static registryName = _t.name;\n        static isPrimitive = true;\n        static schema = {\n          input: {},\n          output: { out: _t },\n          state: { value: _t },\n        };\n        process = () => {\n          const out = _t.serialize ? _t.serialize(this.state.value) : this.state.value;\n          return { out };\n        };\n      }\n  );\n\nexport { number, string, boolean, date };\n","// @flow\nimport { fromPairs } from 'lodash';\nimport {\n  DuoSynthNode,\n  SynthNode,\n  AttackReleaseNode,\n  AudioMasterNode,\n  PannerNode,\n  FeedbackDelayNode,\n  AudioDelayNode,\n  AudioGainNode,\n  SetNoteNode,\n  TimeLoopNode,\n  StartTransportNode,\n  TransportTimeNode,\n  ConnectNode,\n  ContextDestinationNode,\n  ToContextDestinationNode,\n  PianoNode,\n  ArpeggiateNode,\n  CompressorNode,\n  ReverbNode,\n  PlayerNode,\n  VolumeNode,\n} from './ToneNode';\nimport { SoundFontNode, SoundFontPlayerNode } from './SoundFont';\nimport MapperNode from './MapperNode';\nimport IntervalNode from './IntervalNode';\nimport ThreeNode, {\n  Color,\n  DirectionalLightNode,\n  AmbientLightNode,\n  GlitchPassNode,\n  ScanlinePassNode,\n  DotScreenPassNode,\n  VignettePassNode,\n  NoisePassNode,\n} from './ThreeNode';\nimport {\n  TorusKnotGeometryNode,\n  PlaneGeometryNode,\n  SphereGeometryNode,\n  BoxGeometryNode,\n} from './Geometries';\nimport { LambertMaterialNode, ShaderMaterialNode } from './MaterialNode';\nimport { AndNode, OrNode, NotNode, EqualsNode, SwitchNode } from './Logic';\nimport MeshNode from './MeshNode';\nimport { MidiOutNode, MidiInNode } from './Midi';\nimport {\n  InfoLog,\n  JSONParse,\n  ExtractNode,\n  SetNode,\n  StephenWolfram,\n  CollectNode,\n  JoinNode,\n  RegexReplace,\n  ArrayFillNode,\n  CountSourceNode,\n  ZipNode,\n} from './UtilNodes';\nimport Vector2D from './Vector2D';\nimport Vector3D from './Vector3D';\nimport { DomNode } from './Dom';\nimport { PlusNode } from './String';\nimport { ScaleNode, ChromaNode, ChordNode, TransposeNode, KeyTriadsNode } from './Music';\nimport { PerformanceRNNNode } from './Neural';\nimport { DivideNode, SumNode, ProductNode, IntToIntMathNode } from './MathNodes';\nimport { GPGPUProgramNode, RunGPGPUProgramNode } from './GPGPU';\nimport { JSCodeNode } from './Code';\nimport { number, string, boolean, date } from './primitives';\n\n/**\n * Aggregator file to export all the nodes from a single place.\n * Eventually this should be separated to packages (maybe)\n *\n * Eventually this should be code-gen'd.\n */\nexport {\n  Vector2D,\n  MeshNode,\n  TorusKnotGeometryNode,\n  LambertMaterialNode,\n  ShaderMaterialNode,\n  ThreeNode,\n  DuoSynthNode,\n  SynthNode,\n  AttackReleaseNode,\n  AudioMasterNode,\n  PannerNode,\n  FeedbackDelayNode,\n  AudioDelayNode,\n  AudioGainNode,\n  MapperNode,\n  IntervalNode,\n  SetNoteNode,\n  TimeLoopNode,\n  StartTransportNode,\n  TransportTimeNode,\n  ConnectNode,\n  ContextDestinationNode,\n  ToContextDestinationNode,\n  PianoNode,\n  ArpeggiateNode,\n  CompressorNode,\n  ReverbNode,\n  PlayerNode,\n  VolumeNode,\n  SoundFontNode,\n  SoundFontPlayerNode,\n  DivideNode,\n  SumNode,\n  ProductNode,\n  IntToIntMathNode,\n  Color,\n  DirectionalLightNode,\n  AmbientLightNode,\n  GlitchPassNode,\n  ScanlinePassNode,\n  DotScreenPassNode,\n  VignettePassNode,\n  NoisePassNode,\n  Vector3D,\n  AndNode,\n  OrNode,\n  NotNode,\n  EqualsNode,\n  SwitchNode,\n  PerformanceRNNNode,\n  InfoLog,\n  ScaleNode,\n  ChromaNode,\n  ChordNode,\n  TransposeNode,\n  KeyTriadsNode,\n  MidiOutNode,\n  MidiInNode,\n  JSONParse,\n  ExtractNode,\n  SetNode,\n  StephenWolfram,\n  CollectNode,\n  JoinNode,\n  RegexReplace,\n  ArrayFillNode,\n  CountSourceNode,\n  ZipNode,\n  DomNode,\n  PlusNode,\n  GPGPUProgramNode,\n  RunGPGPUProgramNode,\n  JSCodeNode,\n  number,\n  string,\n  boolean,\n  date,\n};\n\nexport const allNodes = [\n  Vector2D,\n  MeshNode,\n  TorusKnotGeometryNode,\n  PlaneGeometryNode,\n  SphereGeometryNode,\n  BoxGeometryNode,\n  LambertMaterialNode,\n  ShaderMaterialNode,\n  ThreeNode,\n  DuoSynthNode,\n  SynthNode,\n  AttackReleaseNode,\n  AudioMasterNode,\n  PannerNode,\n  FeedbackDelayNode,\n  AudioDelayNode,\n  AudioGainNode,\n  MapperNode,\n  IntervalNode,\n  SetNoteNode,\n  TimeLoopNode,\n  StartTransportNode,\n  TransportTimeNode,\n  ConnectNode,\n  ContextDestinationNode,\n  ToContextDestinationNode,\n  PianoNode,\n  ArpeggiateNode,\n  CompressorNode,\n  ReverbNode,\n  PlayerNode,\n  VolumeNode,\n  SoundFontNode,\n  SoundFontPlayerNode,\n  DivideNode,\n  SumNode,\n  ProductNode,\n  IntToIntMathNode,\n  Color,\n  DirectionalLightNode,\n  AmbientLightNode,\n  GlitchPassNode,\n  ScanlinePassNode,\n  DotScreenPassNode,\n  VignettePassNode,\n  NoisePassNode,\n  Vector3D,\n  AndNode,\n  OrNode,\n  NotNode,\n  EqualsNode,\n  SwitchNode,\n  PerformanceRNNNode,\n  InfoLog,\n  ScaleNode,\n  ChromaNode,\n  ChordNode,\n  TransposeNode,\n  KeyTriadsNode,\n  MidiOutNode,\n  MidiInNode,\n  JSONParse,\n  ExtractNode,\n  SetNode,\n  StephenWolfram,\n  CollectNode,\n  JoinNode,\n  RegexReplace,\n  ArrayFillNode,\n  CountSourceNode,\n  ZipNode,\n  DomNode,\n  PlusNode,\n  GPGPUProgramNode,\n  RunGPGPUProgramNode,\n  JSCodeNode,\n  number,\n  string,\n  boolean,\n  date,\n];\n\nwindow.allNodes = allNodes;\n\nconst NodeRegistry = fromPairs(allNodes.map(n => [n.getRegistryName(), n]));\nif (Object.keys(NodeRegistry).length !== allNodes.length) {\n  throw new Error('duplicate node by registryName in node registry');\n}\nwindow.NodeRegistry = NodeRegistry;\n","// @flow\n\nimport Tone from 'tone';\nimport 'models/AttributeType';\nimport 'models/types';\nimport 'models/nodes';\n\nwindow.Tone = Tone;\nwindow['$debug'] = true;\n","// @flow\n\nimport React, { Component } from 'react';\n\ntype P = { index: number, onMouseUp: number => void, item: string, filled: boolean };\ntype S = { hover: boolean };\n\nexport default class NodeInputListItem extends Component<P, S> {\n  state = { hover: false };\n\n  onMouseUp = (e: MouseEvent) => {\n    e.stopPropagation();\n    e.preventDefault();\n    this.props.onMouseUp(this.props.index);\n  };\n\n  onMouseOver = () => this.setState({ hover: true });\n  onMouseOut = () => this.setState({ hover: false });\n\n  render() {\n    const { hover } = this.state;\n    const { filled, item } = this.props;\n    const icon = filled || hover ? 'fa-circle' : 'fa-circle';\n    const modifier = hover ? ' hover' : filled ? ' connected-node' : '';\n    return (\n      <li onMouseOver={this.onMouseOver} onMouseOut={this.onMouseOut} onMouseUp={this.onMouseUp}>\n        <span className={`input-text${modifier}`}>\n          <i className={`fa ${icon}`} />\n          {item}\n        </span>\n      </li>\n    );\n  }\n}\n","// @flow\n\nimport React from 'react';\n\nimport NodeInputListItem from './NodeInputListItem';\n\n// TODO: change this to type Item = {name: string, filled: boolean}\ntype P = {\n  onCompleteConnector: number => void,\n  items: string[],\n  connected: string[],\n  display: string[],\n};\n\nexport default class NodeInputList extends React.Component<P> {\n  onMouseUp = (i: number) => {\n    this.props.onCompleteConnector(i);\n  };\n\n  render() {\n    const { items, connected, display } = this.props;\n    return (\n      <div className=\"nodeInputWrapper\">\n        <ul className=\"nodeInputList\">\n          {items.map((item, i) => (\n            <NodeInputListItem\n              onMouseUp={this.onMouseUp}\n              key={`item-${i}`}\n              index={i}\n              item={display[i]}\n              filled={connected.includes(item)}\n            />\n          ))}\n        </ul>\n      </div>\n    );\n  }\n}\n","// @flow\nimport React from 'react';\nimport type { DraggableData } from 'react-draggable';\nimport { DraggableCore } from 'react-draggable';\nimport type { Pos } from 'types';\n\ntype P = {\n  index: number,\n  onMouseDown: (number, MouseEvent, DraggableData) => void,\n  item: string,\n  filled: boolean,\n  scale: number,\n  positionOffset: Pos | typeof undefined,\n};\n\nexport default class NodeOutputListItem extends React.Component<P> {\n  onMouseDown = (e: MouseEvent, data: DraggableData) => {\n    e.stopPropagation();\n    e.preventDefault();\n    this.props.onMouseDown(this.props.index, e, data);\n  };\n\n  render() {\n    const { filled, item } = this.props;\n    const modifier = filled ? '' : ' unconnected';\n    return (\n      <DraggableCore onStart={this.onMouseDown}>\n        <li>\n          <span>\n            {item}\n            <i className={`fa fa-circle${modifier}`} />\n          </span>\n        </li>\n      </DraggableCore>\n    );\n  }\n}\n","// @flow\nimport React from 'react';\n\nimport NodeOutputListItem from './NodeOutputListItem';\nimport type { Pos } from 'types';\nimport { DraggableData } from 'react-draggable';\n\ntype P = {\n  onStartConnector: (number, MouseEvent, DraggableData) => void,\n  items: string[],\n  connected: string[],\n  display: string[],\n  scale: number,\n  positionOffset: Pos | typeof undefined,\n};\n\nexport default class NodeOutputList extends React.Component<P> {\n  render() {\n    const { items, connected, display, scale, positionOffset, onStartConnector } = this.props;\n    return (\n      <div className=\"nodeOutputWrapper\">\n        <ul className=\"nodeOutputList\">\n          {items.map((item, i) => {\n            return (\n              <NodeOutputListItem\n                filled={connected.includes(item)}\n                onMouseDown={onStartConnector}\n                key={`item-${i}`}\n                index={i}\n                item={display[i]}\n                scale={scale}\n                positionOffset={positionOffset}\n              />\n            );\n          })}\n        </ul>\n      </div>\n    );\n  }\n}\n","// @flow\n\nimport type { Pos } from 'types';\n\nexport const addVec = (v1: Pos, v2: Pos): Pos => {\n  return { x: v1.x + v2.x, y: v1.y + v2.y };\n};\n\nexport const subVec = (v1: Pos, v2: Pos): Pos => {\n  return { x: v1.x - v2.x, y: v1.y - v2.y };\n};\n\nexport type Direction = 'left' | 'right' | 'up' | 'down';\n\nconst units = {\n  left: { x: 1, y: 0 },\n  right: { x: -1, y: 0 },\n  up: { x: 0, y: 1 },\n  down: { x: 0, y: -1 },\n};\nexport const unitVec = (dir: Direction): Pos => units[dir];\n\nexport const scaleVec = (v: Pos, scale: number): Pos => {\n  return { x: v.x * scale, y: v.y * scale };\n};\n\nexport const zero = { x: 0, y: 0 };\n","// @flow\n\nimport React from 'react';\nimport { get } from 'lodash';\nimport { connect } from 'react-redux';\nimport { createSelector } from 'redux-starter-kit';\nimport onClickOutside from 'react-onclickoutside';\nimport Draggable, { type DraggableEventHandler, type DraggableData } from 'react-draggable';\nimport NodeInputList from './NodeInputList';\nimport NodeOutputList from './NodeOutputList';\nimport type { AnyNode } from 'models/NodeBase';\nimport type { NodeInSpace, Pos } from 'types';\nimport { Hotkey, Hotkeys, HotkeysTarget } from '@blueprintjs/core';\nimport { addVec } from 'utils/vector';\n\ntype SP = {| pos: Pos, infoShowing: boolean |};\ntype OP = {|\n  index: number,\n  nis: NodeInSpace,\n  onNodeStart: (NodeInSpace, DraggableData) => void,\n  onNodeStop: (NodeInSpace, DraggableData) => void,\n  onNodeMove: (NodeInSpace, DraggableData) => void,\n  onStartConnector: (string, number, e: MouseEvent, d: DraggableData) => void,\n  onCompleteConnector: (string, number) => void,\n  onNodeSelect?: (NodeInSpace, ?number, ?boolean) => void,\n  onNodeDeselect?: (NodeInSpace, boolean, ?boolean) => void,\n  onDelete?: AnyNode => void,\n  visible: boolean,\n  selected: boolean,\n  scale?: ?number,\n  positionOffset?: Pos | typeof undefined,\n  disabled: boolean,\n|};\ntype P = {| ...SP, ...OP |};\nconst MoveBufferPx = 4;\n\nclass Node extends React.Component<P> {\n  dragStart: ?Pos;\n\n  _onDelete = () => {\n    this.props.onDelete && this.props.onDelete(this.props.nis.node);\n  };\n\n  handleDragStart = (event: MouseEvent, data: DraggableData) => {\n    if (event.metaKey || event.shiftKey) {\n      return;\n    }\n    this.dragStart = { x: event.clientX, y: event.clientY };\n    this.props.onNodeStart(this.props.nis, data);\n  };\n\n  handleDragStop: DraggableEventHandler = (event: MouseEvent, data: DraggableData) => {\n    this.props.onNodeStop(this.props.nis, data);\n    setTimeout(() => {\n      this.dragStart = null;\n    });\n  };\n\n  handleDrag = (event: MouseEvent, data: DraggableData) => {\n    if (event.metaKey) {\n      return;\n    }\n    this.props.onNodeMove(this.props.nis, data);\n  };\n\n  onStartConnector = (i: number, e: MouseEvent, d: DraggableData) => {\n    this.props.onStartConnector(this.props.nis.node.id, i, e, d);\n  };\n\n  onCompleteConnector = index => {\n    this.props.onCompleteConnector(this.props.nis.node.id, index);\n    this.forceUpdate();\n  };\n\n  _selectNode = (resetHighlights?: boolean) => {\n    if (this.props.onNodeSelect) {\n      this.props.onNodeSelect(this.props.nis, this.props.index, resetHighlights);\n    }\n  };\n\n  _deselectNode = (removeHighlight: boolean, resetOtherHighlights: boolean) => {\n    if (this.props.onNodeDeselect) {\n      this.props.onNodeDeselect(this.props.nis, removeHighlight, resetOtherHighlights);\n    }\n  };\n\n  handleClick = (event: MouseEvent) => {\n    const x = get(this.dragStart, 'x');\n    const y = get(this.dragStart, 'y');\n    if (\n      x &&\n      y &&\n      event.clientX &&\n      event.clientY &&\n      (Math.abs(event.clientX - x) > MoveBufferPx || Math.abs(event.clientY - y) > MoveBufferPx)\n    ) {\n      return;\n    }\n    if (this.props.selected) {\n      this._deselectNode(event.metaKey, !event.metaKey);\n    } else {\n      this._selectNode();\n    }\n  };\n\n  // noinspection JSUnusedGlobalSymbols\n  handleClickOutside = event => {\n    const { selected, infoShowing } = this.props;\n    const ignore = !selected && !infoShowing;\n    if (event.metaKey || event.shiftKey || ignore) {\n      return;\n    }\n    if (this.props.onNodeDeselect) {\n      this.props.onNodeDeselect(this.props.nis, false);\n    }\n  };\n\n  render() {\n    const { selected, infoShowing, visible, pos, scale, positionOffset, disabled } = this.props;\n    const { node } = this.props.nis;\n    const sel = infoShowing ? 'in-view' : selected ? 'selected' : '';\n    let nodeClass = 'node' + (sel ? ` ${sel} ignore-react-onclickoutside` : '');\n    if (!visible) {\n      return <div />;\n    }\n\n    const name = node.name();\n    return (\n      <Draggable\n        disabled={disabled}\n        position={pos}\n        handle=\".node\"\n        onStart={this.handleDragStart}\n        onStop={this.handleDragStop}\n        onDrag={this.handleDrag}\n        scale={scale || 1}\n        positionOffset={positionOffset}\n      >\n        <div\n          className={nodeClass}\n          onClick={this.handleClick}\n          onDoubleClick={() => this._selectNode(true)}\n          id={node.domId()}\n        >\n          <header className=\"node-header\">\n            <span className=\"node-title\">{name}</span>\n          </header>\n          <div className=\"node-content\">\n            <NodeInputList\n              connected={node.connectedInputKeys()}\n              items={node.inKeys()}\n              display={node.constructor.displayInKeys()}\n              onCompleteConnector={this.onCompleteConnector}\n            />\n            <NodeOutputList\n              connected={node.connectedOutputKeys()}\n              items={node.outKeys()}\n              display={node.constructor.displayOutKeys()}\n              onStartConnector={this.onStartConnector}\n              scale={scale || 1}\n              positionOffset={addVec(pos, positionOffset || { x: 0, y: 0 })}\n            />\n          </div>\n        </div>\n      </Draggable>\n    );\n  }\n\n  // noinspection JSUnusedGlobalSymbols\n  renderHotkeys() {\n    const show = this.props.selected || this.props.infoShowing;\n    if (!show) {\n      return <Hotkeys />;\n    }\n    return (\n      <Hotkeys>\n        <Hotkey\n          group=\"Node Actions\"\n          combo=\"backspace\"\n          label=\"Delete selected node\"\n          global={true}\n          onKeyDown={this._onDelete}\n        />\n      </Hotkeys>\n    );\n  }\n}\n\nconst getInfoShowing = (s, op) => Boolean(s.graph.infoOpen === op.nis.node.id);\nconst getPos = (s, op) => s.graph.nodePos[op.nis.node.id] || op.nis.pos;\n\nconst makeSelectCreator = () =>\n  createSelector(\n    [getPos, getInfoShowing],\n    (pos, infoShowing) => ({ pos, infoShowing })\n  );\n\nconst makeSelect = () => {\n  const selector = makeSelectCreator();\n  return (s, op) => selector(s, op);\n};\n\nexport default connect(makeSelect)(onClickOutside(HotkeysTarget(Node)));\n","//@flow\nimport { get, flatten, uniqBy, fromPairs, mapValues } from 'lodash';\nimport Edge from 'models/Edge';\nimport NodeBase from 'models/NodeBase';\nimport type { NodeInSpace, Pos } from 'types';\nimport type { AnyNode, NodeSerialization } from 'models/NodeBase';\nimport type { EdgeSerialization } from 'models/Edge';\nimport { uuid } from 'helpers';\nimport type { PosMemo } from 'redux/ducks/graph';\n\ntype MetaData = { zoom?: number };\n\nexport type GraphSerialization = {\n  name?: string,\n  nodes: NodeSerialization<any>[],\n  edges: EdgeSerialization[],\n  meta?: MetaData,\n};\n\nexport default class Graph {\n  id: string;\n  name: string = 'untitled';\n  meta: MetaData = {};\n  nodes: NodeInSpace[] = [];\n  _nodesById: { [string]: NodeInSpace } = {};\n  edges: Edge[] = [];\n\n  constructor(\n    nodes?: NodeInSpace[] = [],\n    edges?: Edge[] = [],\n    name?: string = 'untitled',\n    meta: MetaData = {}\n  ) {\n    this.id = uuid();\n    const _nodes = nodes || [];\n    _nodes.forEach(nis => this.addNode(nis.node, nis.pos));\n    const _edges = edges || [];\n    _edges.forEach(this.addEdge);\n    this.name = name;\n    this.meta = meta;\n  }\n\n  nodeWithId: string => ?NodeInSpace = id => this._nodesById[id];\n\n  nodeWithIdF: string => NodeInSpace = id => {\n    const n = this.nodeWithId(id);\n    if (n) {\n      return n;\n    } else {\n      throw new Error('not found');\n    }\n  };\n\n  addNode: (AnyNode, Pos) => NodeInSpace = (node, pos) => {\n    const nis = { node, pos };\n    this._nodesById[node.id] = nis;\n    this.nodes.push(nis);\n    node.onAddToGraph();\n    return nis;\n  };\n\n  setNodes: (NodeInSpace[]) => Graph = nodes => {\n    this.nodes = nodes;\n    this._nodesById = fromPairs(nodes.map(n => [n.node.id, n]));\n    return this;\n  };\n\n  updatePositions = (pos: PosMemo) => {\n    this.nodes.forEach(nis => {\n      const p = pos[nis.node.id];\n      if (p) {\n        nis.pos = p;\n      }\n    });\n  };\n\n  nodeIds = (): string[] => Object.keys(this._nodesById);\n\n  nodePositions = (): PosMemo => mapValues(this._nodesById, 'pos');\n\n  removeNode: AnyNode => Graph = node => {\n    node.inputs.forEach(this.removeEdge);\n    node.outputs.forEach(this.removeEdge);\n    node.willBeRemoved();\n    this.setNodes(this.nodes.filter(n => n.node.id !== node.id));\n    return this;\n  };\n\n  addEdge: Edge => void = edge => {\n    this.edges.push(edge);\n    edge.from.addOutput(edge);\n    edge.to.addInput(edge);\n  };\n\n  removeEdge: Edge => void = edge => {\n    this.edges = this.edges.filter(e => e.id !== edge.id);\n    edge.from.removeOutput(edge);\n    edge.to.removeInput(edge);\n  };\n\n  serialize: (string, ?MetaData) => GraphSerialization = (name, meta) => {\n    return {\n      name,\n      nodes: this.nodes.map(n => n.node.serialize(n.pos.x, n.pos.y)),\n      edges: this.edges.map(e => e.serialize()),\n      ...(meta && { meta }),\n    };\n  };\n\n  duplicate: (NodeInSpace[]) => NodeInSpace[] = nodes => {\n    const ids = nodes.map(nis => nis.node.id);\n    const newNodes = nodes.map(nis =>\n      this.addNode(NodeBase.duplicate(nis.node), { x: nis.pos.x + 50, y: nis.pos.y + 50 })\n    );\n    uniqBy(flatten(nodes.map(nis => nis.node.inputs.concat(nis.node.outputs))), 'id').forEach(e => {\n      const fIdx = ids.indexOf(e.from.id);\n      const tIdx = ids.indexOf(e.to.id);\n      if (fIdx !== -1 && tIdx !== -1) {\n        this.addEdge(new Edge(newNodes[fIdx].node, newNodes[tIdx].node, e.fromPort, e.toPort));\n      }\n    });\n    return newNodes;\n  };\n\n  dispose = () => {\n    this.edges.forEach(this.removeEdge);\n    this.nodes.map(n => n.node).forEach(this.removeNode);\n    this.edges = [];\n    this.nodes = [];\n    this._nodesById = {};\n    if (get(window, '$graph.id') === this.id) {\n      window['$graph'] = null;\n    }\n  };\n\n  static load(json: GraphSerialization): Graph {\n    const nodesInSpace = json.nodes.map(n => ({ node: NodeBase.load(n), pos: { x: n.x, y: n.y } }));\n    const nodes = nodesInSpace.map(nis => nis.node);\n    const edges = json.edges.map(j => Edge.load(j, nodes));\n    const name = json.name || 'untitled';\n    const meta = json.meta || {};\n    return new Graph(nodesInSpace, edges, name, meta);\n  }\n\n  static empty(): GraphSerialization {\n    return { name: 'untitled', edges: [], nodes: [] };\n  }\n\n  static serialization(frm: any): ?GraphSerialization {\n    return typeof frm === 'object' && frm.edges && frm.nodes ? frm : null;\n  }\n\n  static fromFile(file: File, handler: GraphSerialization => void) {\n    const fileReader = new FileReader();\n    fileReader.onload = () => {\n      const result = fileReader.result;\n      if (typeof result === 'string') {\n        try {\n          handler(JSON.parse(result));\n        } catch (e) {\n          console.error('could not load graph', e);\n        }\n      }\n    };\n    fileReader.readAsText(file);\n  }\n}\n","import React, { Component } from 'react';\n\nexport default class SVGComponent extends Component {\n  render() {\n    return (\n      <svg {...this.props}>\n        {this.props.children}\n      </svg>\n    );\n  }\n}\n","// @flow\nimport React from 'react';\nimport { get } from 'lodash';\nimport onClickOutside from 'react-onclickoutside';\nimport type { Pos } from 'types';\nimport Edge from 'models/Edge';\nimport { Hotkey, Hotkeys, HotkeysTarget } from '@blueprintjs/core';\nimport { connect } from 'react-redux';\nimport { selSet as _selSet, setInfoOpen as _setInfoOpen } from 'redux/ducks/graph';\n\ntype DP = {|\n  selSet: (string[]) => void,\n  setInfoOpen: (?string) => void,\n|};\ntype OP = {| start: Pos, end: Pos, onRemove?: () => void, edge: ?Edge, highlighted?: boolean |};\ntype P = {| ...OP, ...DP |};\ntype S = { selected: boolean };\n\nclass Spline extends React.Component<P, S> {\n  el: ?Element;\n  state = { selected: false };\n  listeningOnEdge: string;\n\n  handleClick = () => {\n    this.setState({ selected: true });\n    this.props.selSet([]);\n    this.props.setInfoOpen(null);\n  };\n\n  componentDidMount() {\n    this._setListener();\n  }\n\n  componentDidUpdate() {\n    this._setListener();\n  }\n\n  _setListener = () => {\n    if (this.props.edge && this.listeningOnEdge !== this.props.edge.id) {\n      this.props.edge.notifyListener = this._onNotify;\n      this.listeningOnEdge = this.props.edge.id;\n    }\n  };\n\n  _onNotify = () => {\n    !this.state.selected &&\n      this.el &&\n      // $FlowIssue\n      this.el.animate(\n        [\n          { stroke: '#999999', strokeWidth: 4, filter: 'blur(0)' },\n          { stroke: '#4caa4d', strokeWidth: 6, filter: 'blur(20px)' },\n          { stroke: '#999999', strokeWidth: 4, filter: 'blur(0)' },\n        ],\n        { duration: 500, iterations: 1 }\n      );\n  };\n\n  // noinspection JSUnusedGlobalSymbols\n  handleClickOutside = event => {\n    if (!this.state.selected || event.metaKey || event.shiftKey) {\n      return;\n    }\n    this.setState({ selected: false });\n  };\n\n  handleRemove = () => {\n    this.setState({ selected: false });\n    this.props.onRemove && this.props.onRemove();\n  };\n\n  render() {\n    let { selected } = this.state;\n    let { start, end, highlighted, edge } = this.props;\n    const dist = this.distance([start.x, start.y], [end.x, end.y]);\n    const selfEdge = edge && get(edge, 'from.id') === get(edge, 'to.id');\n    const pathString = this.bezierCurve(\n      start.x, // start x\n      start.y, // start y\n      start.x + dist * (selfEdge ? 0.7 : 0.18), // cp1 x\n      start.y - dist * (selfEdge ? 0.9 : 0), // cp1 y\n      end.x - dist * (selfEdge ? 0.7 : 0.35), // cp2 x\n      end.y - dist * (selfEdge ? 0.9 : 0), // cp2 y\n      end.x, // end x\n      end.y\n    );\n\n    const cls = 'connector' + (selected ? ' selected' : '') + (highlighted ? ' highlight' : '');\n    return (\n      <g>\n        <path className=\"connector-click-area\" d={pathString} onClick={this.handleClick} />\n        <path className={cls} d={pathString} onClick={this.handleClick} ref={r => (this.el = r)} />\n      </g>\n    );\n  }\n\n  bezierCurve(a, b, cp1x, cp1y, cp2x, cp2y, x, y) {\n    return `M${a},${b} C${cp1x},${cp1y} ${cp2x},${cp2y} ${x},${y}`;\n  }\n\n  distance(a, b) {\n    return Math.sqrt((b[0] - a[0]) ** 2 + (b[1] - a[1]) ** 2);\n  }\n\n  // noinspection JSUnusedGlobalSymbols\n  renderHotkeys() {\n    let { selected } = this.state;\n    if (!selected) {\n      return <Hotkeys />;\n    }\n    return (\n      <Hotkeys>\n        <Hotkey\n          group=\"Edge Actions\"\n          combo=\"backspace\"\n          label=\"Delete edge\"\n          global={true}\n          onKeyDown={this.handleRemove}\n        />\n      </Hotkeys>\n    );\n  }\n}\n\nexport default connect(\n  null,\n  d => ({\n    selSet: id => d(_selSet(id)),\n    setInfoOpen: n => d(_setInfoOpen(n)),\n  })\n)(onClickOutside(HotkeysTarget(Spline)));\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { createSelector } from 'redux-starter-kit';\nimport { inOffset, outOffset } from 'components/util';\nimport SVGComponent from 'components/SVGComponent';\nimport Spline from 'components/Spline';\nimport { selectInfoOpen, selectPositions } from 'redux/ducks/graph';\nimport type { Pos } from 'types';\nimport type Edge from 'models/Edge';\nimport { addVec, scaleVec, subVec } from 'utils/vector';\nimport type { PosMemo } from 'redux/ducks/graph';\nimport type Graph from 'models/Graph';\n\ntype P = {\n  dragging: boolean,\n  source: ?[string, number],\n  visible: boolean,\n  paneId: ?string,\n  selected: { [string]: boolean },\n  onRemoveConnector: Edge => void,\n  edges: Edge[],\n  pan: Pos,\n  positions: PosMemo,\n  graph: Graph,\n  scaleInverse: number,\n  mousePos: ?Pos,\n};\nconst AllEdges = ({\n  positions,\n  dragging,\n  source,\n  visible,\n  paneId,\n  selected,\n  onRemoveConnector,\n  edges,\n  pan,\n  graph,\n  scaleInverse,\n  mousePos,\n}: P) => {\n  if (!visible) {\n    return null;\n  }\n  let creatingSpline = null;\n  const mid = window.centerP;\n  if (dragging && source && mousePos && mid) {\n    const [nodeId, outIdx] = source;\n    let src = positions[nodeId] || graph.nodeWithIdF(nodeId).pos;\n    creatingSpline = (\n      <Spline\n        start={addVec(outOffset(src.x, src.y, outIdx), pan)}\n        end={addVec(mid, scaleVec(subVec(mousePos, mid), scaleInverse))}\n      />\n    );\n  }\n  return (\n    <SVGComponent height=\"100%\" width=\"100%\">\n      {edges.map(e => {\n        const [fromId, toId] = [e.from.id, e.to.id];\n        const [i, o] = [graph.nodeWithIdF(toId), graph.nodeWithIdF(fromId)];\n\n        const outIdx = o.node.constructor.outKeyIndex(e.fromPort);\n        const inIdx = i.node.constructor.inKeyIndex(e.toPort);\n\n        const frm = positions[e.from.id] || o.pos;\n        const to = positions[e.to.id] || i.pos;\n        return (\n          <Spline\n            highlighted={\n              selected[fromId] ||\n              selected[toId] ||\n              (paneId && (fromId === paneId || toId === paneId))\n            }\n            edge={e}\n            start={addVec(outOffset(frm.x, frm.y, outIdx), pan)}\n            end={addVec(inOffset(to.x, to.y, inIdx), pan)}\n            key={`${e.id}-spline`}\n            onRemove={() => onRemoveConnector(e)}\n          />\n        );\n      })}\n      {creatingSpline}\n    </SVGComponent>\n  );\n};\n\nconst selector = createSelector(\n  [selectInfoOpen, selectPositions],\n  (paneId, positions) => ({ paneId, positions })\n);\n\nexport default connect(selector)(AllEdges);\n","// @flow\n\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { createSelector } from 'redux-starter-kit';\nimport { DraggableCore } from 'react-draggable';\nimport { get, uniq, throttle, omit, fromPairs, mapValues } from 'lodash';\nimport Node from './Node';\nimport Graph from 'models/Graph';\nimport Edge from 'models/Edge';\n\nimport type { DraggableData } from 'react-draggable';\nimport { Hotkey, Hotkeys, HotkeysTarget } from '@blueprintjs/core';\nimport {\n  selectedS,\n  selectView,\n  selSet as _selSet,\n  zoomIn as _zIn,\n  zoomOut as _zOut,\n  zoomReset as _zReset,\n  setPan as _setPan,\n  updatePos as _updatePos,\n  zooms,\n} from 'redux/ducks/graph';\n\nimport type { NodeInSpace, Pos } from 'types';\nimport type { AnyNode } from 'models/NodeBase';\nimport AllEdges from 'components/AllEdges';\nimport type { PosMemo, SelectedView } from 'redux/ducks/graph';\nimport { addVec, scaleVec, subVec, unitVec, zero } from 'utils/vector';\nimport type { Direction } from 'utils/vector';\n\ntype OP = {|\n  graph: Graph,\n  onCreateEdge?: Edge => void,\n  onDeleteEdge?: Edge => void,\n  onNodeSelect?: AnyNode => void,\n  onNodeDeselect?: (AnyNode, ?boolean, ?boolean) => void,\n  onNodeSelectionChange?: (?AnyNode, ?number) => void,\n  visible: boolean,\n|};\ntype SP = {| selected: { [string]: boolean }, selectCount: number, ...SelectedView |};\ntype DP = {|\n  selSet: (string[]) => void,\n  zoomIn: (?Pos) => void,\n  zoomOut: (?Pos) => void,\n  zoomReset: () => void,\n  setPan: Pos => void,\n  updatePos: PosMemo => void,\n|};\n\ntype P = {| ...SP, ...OP, ...DP |};\ntype S = {|\n  source: ?[string, number],\n  dragging: boolean,\n  mousePos: ?Pos,\n  canvasDragEnd: ?Pos,\n  metaDown: boolean,\n|};\n\nclass NodeGraph extends React.Component<P, S> {\n  dragOffsets: PosMemo = {};\n  canvasDragStart: ?Pos;\n  moving: boolean = false;\n  deselectNodes: boolean = false;\n  timeoutId: ?TimeoutID = null;\n  deltaY: number = 0;\n  state = { source: null, dragging: false, mousePos: null, canvasDragEnd: null, metaDown: false };\n\n  componentDidMount() {\n    document.addEventListener('mousemove', this.onMouseMove);\n    document.addEventListener('mouseup', this.onMouseUp);\n    document.addEventListener('keyup', this.onKeyUp);\n    document.addEventListener('keydown', this.onKeyDown);\n    window.centerP = { x: window.innerWidth / 2, y: window.innerHeight / 2 };\n    window.addEventListener('resize', this.onWinResize);\n    const { graph } = this.props;\n    graph && this._setPosFromGraph();\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousemove', this.onMouseMove);\n    document.removeEventListener('mouseup', this.onMouseUp);\n    document.removeEventListener('keyup', this.onKeyUp);\n    document.removeEventListener('keydown', this.onKeyDown);\n    window.removeEventListener('resize', this.onWinResize);\n    this.timeoutId && clearTimeout(this.timeoutId);\n    this._debouncedSetMouse.cancel();\n  }\n\n  componentDidUpdate(prev) {\n    const { graph, scale } = this.props;\n    graph && graph !== prev.graph && this._setPosFromGraph();\n    if (prev.scale !== scale && document.body) {\n      const size = 250 * (scale * 0.25 + 0.75);\n      document.body.style.backgroundSize = `${size}px ${size}px`;\n    }\n  }\n\n  onKeyUp = (e: KeyboardEvent) => e.key === 'Meta' && this.setState({ metaDown: false });\n  onKeyDown = (e: KeyboardEvent) => e.key === 'Meta' && this.setState({ metaDown: true });\n  onScroll = (e: WheelEvent) => {\n    const { zoom, scale } = this.props;\n    this.deltaY += e.deltaY;\n    const thresh = 30;\n    let txFn = null;\n    if (this.deltaY > thresh && zoom < zooms.length - 1) {\n      txFn = this.props.zoomIn;\n      this.deltaY = 0;\n    } else if (this.deltaY < -thresh && zoom > 0) {\n      txFn = this.props.zoomOut;\n      this.deltaY = 0;\n    }\n    if (this.deltaY > thresh || this.deltaY < -thresh) {\n      this.deltaY = 0;\n    }\n    if (txFn) {\n      const fromCenter = subVec({ x: e.clientX, y: e.clientY }, window.centerP);\n      txFn(scaleVec(fromCenter, scale * 0.1 * Math.sign(e.deltaY)));\n    }\n  };\n\n  onWinResize = () => {\n    window.centerP = { x: window.innerWidth / 2, y: window.innerHeight / 2 };\n  };\n\n  onMouseUp = () => {\n    this.timeoutId = setTimeout(() => this.setState({ dragging: false, mousePos: null }), 1);\n  };\n\n  onMouseMove = (e: MouseEvent) => {\n    if (this.moving) {\n      return;\n    }\n    const { dragging } = this.state;\n    const { selectCount } = this.props;\n    const set = dragging || selectCount > 0;\n    if (!set) {\n      return;\n    }\n    this._debouncedSetMouse(e);\n  };\n\n  _debouncedSetMouse = throttle((e: MouseEvent) => {\n    this.setState({ mousePos: { x: e.clientX, y: e.clientY } });\n  }, 24);\n\n  _getSelected = (): NodeInSpace[] => {\n    const { selected, graph } = this.props;\n    return graph.nodes.filter(nis => selected[nis.node.id]);\n  };\n\n  onNodeStartMove = (started: NodeInSpace, data: DraggableData) => {\n    if (!this.props.selected[started.node.id]) {\n      this.dragOffsets = { [started.node.id]: zero };\n      this.props.selectCount && this.props.selSet([]);\n    } else {\n      this.dragOffsets = fromPairs(\n        this._getSelected()\n          .map(nis => [nis.node.id, subVec(started.pos, nis.pos)])\n          .concat([[started.node.id, zero]])\n      );\n    }\n    this.moving = true;\n  };\n\n  onNodeStopMove = (node: NodeInSpace, data: DraggableData) => {\n    this.onNodeMove(node, data);\n    const { graph } = this.props;\n    const updates = mapValues(this.dragOffsets, offset => subVec(data, offset));\n    graph.updatePositions(updates);\n    this._setPosFromGraph();\n    this.dragOffsets = {};\n    this.moving = false;\n  };\n\n  lastData: ?DraggableData;\n  lastUpdateTime: number = performance.now();\n  onNodeMove = (node: NodeInSpace, data: DraggableData) => {\n    const thresh = 120 * this.props.scaleInverse;\n    const timeThresh = this.props.selectCount < 4 ? 16 : this.props.selectCount < 11 ? 30 : 50;\n    if (\n      !this.lastData ||\n      performance.now() - this.lastUpdateTime > timeThresh ||\n      Math.abs(this.lastData.x - data.x) > thresh ||\n      Math.abs(this.lastData.y - data.y) > thresh\n    ) {\n      const updates = mapValues(this.dragOffsets, offset => subVec(data, offset));\n      this.props.updatePos(updates);\n      this.lastUpdateTime = performance.now();\n      this.lastData = data;\n    }\n  };\n\n  onStartConnector = (id: string, outputIndex: number, e: MouseEvent, d: DraggableData) => {\n    this.setState({\n      dragging: true,\n      source: [id, outputIndex],\n      mousePos: { x: e.clientX, y: e.clientY },\n    });\n  };\n\n  onCompleteConnector = (id: string, inIndex: number) => {\n    const { dragging, source } = this.state;\n    const { graph } = this.props;\n    if (dragging && source) {\n      const [nodeId, outIdx] = source;\n      let fromNode = graph.nodeWithId(nodeId);\n      let toNode = graph.nodeWithId(id);\n      if (fromNode && toNode) {\n        let fromAttr = fromNode.node.outKeyAt(outIdx);\n        let toAttr = toNode.node.inKeyAt(inIndex);\n        const edge = new Edge(fromNode.node, toNode.node, fromAttr, toAttr);\n        graph.addEdge(edge);\n        this.props.onCreateEdge && this.props.onCreateEdge(edge);\n      }\n    }\n    this.setState({ dragging: false, mousePos: null });\n    this.forceUpdate();\n  };\n\n  handleRemoveConnector = (edge: Edge) => {\n    if (this.props.onDeleteEdge) {\n      this.props.onDeleteEdge(edge);\n    }\n    this.props.graph.removeEdge(edge);\n    this.forceUpdate();\n  };\n\n  onNodeSelect = (n: NodeInSpace, idx?: number, resetHighlights?: boolean) => {\n    if (this.props.onNodeSelect) {\n      this.props.onNodeSelect(n.node);\n    }\n    const highlighted = resetHighlights\n      ? [n.node.id]\n      : uniq(Object.keys(this.props.selected).concat(n.node.id));\n    if (highlighted.length > 1) {\n      this._onNodeChange(null);\n    } else {\n      this._onNodeChange(n.node, idx);\n    }\n    this.props.selSet(highlighted);\n  };\n\n  onNodeDeselect = (n: NodeInSpace, removeHighlight: boolean, resetOtherHighlights?: boolean) => {\n    if (this.props.onNodeDeselect) {\n      this.props.onNodeDeselect(n.node);\n    }\n    this._onNodeChange(null);\n    if (removeHighlight || resetOtherHighlights) {\n      const highlighted = resetOtherHighlights\n        ? removeHighlight\n          ? []\n          : [n.node.id]\n        : Object.keys(omit(this.props.selected, n.node.id));\n      this.props.selSet(highlighted);\n    }\n  };\n\n  onDeleteNode = (n: AnyNode) => {\n    this.props.graph.removeNode(n);\n    this._setPosFromGraph();\n    this._onNodeChange(null);\n  };\n\n  _setPosFromGraph = () => {\n    this.props.updatePos(this.props.graph.nodePositions());\n  };\n\n  _onNodeChange = (n: ?AnyNode, idx?: number) => {\n    if (this.props.onNodeSelectionChange) {\n      this.props.onNodeSelectionChange(n, idx);\n    }\n  };\n\n  _overlaps = (r1: ClientRect, r2: ClientRect) =>\n    !(r1.right < r2.left || r1.left > r2.right || r1.bottom < r2.top || r1.top > r2.bottom);\n\n  _nodesIntersecting = (box: ClientRect): NodeInSpace[] =>\n    this.props.graph.nodes.filter(nis => {\n      const el = document.getElementById(nis.node.domId());\n      return el && this._overlaps(box, el.getBoundingClientRect());\n    });\n\n  _setIntersects = throttle((union: boolean, subtract: boolean) => {\n    const selBox = document.getElementById('selection-box');\n    if (!selBox) {\n      return;\n    }\n    const selBound = selBox.getBoundingClientRect();\n    if (selBound.width < 10 && selBound.height < 10) {\n      return;\n    }\n    const { selSet, selected } = this.props;\n    const ids = this._nodesIntersecting(selBound).map(nis => nis.node.id);\n    selSet(\n      union\n        ? uniq(Object.keys(selected).concat(ids))\n        : subtract\n        ? Object.keys(selected).filter(sId => !ids.includes(sId))\n        : ids\n    );\n  }, 18);\n\n  _onCanvasDrag = throttle((e: MouseEvent, data: DraggableData) => {\n    if (!this.moving) {\n      if (e.metaKey && this.canvasDragStart) {\n        this.setState({ canvasDragEnd: data });\n        this._setIntersects(e.shiftKey, e.altKey);\n      } else if (!e.metaKey) {\n        const { setPan, pan, scaleInverse, scale } = this.props;\n        const newPan = addVec(pan, scaleVec({ x: data.deltaX, y: data.deltaY }, scaleInverse));\n        setPan(newPan);\n        if (document.body) {\n          document.body.style.backgroundPosition = `${newPan.x * scale}px ${newPan.y * scale}px`;\n        }\n        this.deselectNodes = false;\n      }\n    }\n  }, 18);\n\n  _onStartCanvasDrag = (e: MouseEvent, data: DraggableData) => {\n    if (e.metaKey) {\n      this.canvasDragStart = data;\n      this.deselectNodes = false;\n    } else {\n      this.deselectNodes = true;\n    }\n  };\n\n  _onEndCanvasDrag = (e: MouseEvent, data: DraggableData) => {\n    if (this.deselectNodes) {\n      this.props.selSet([]);\n      this.deselectNodes = false;\n    }\n    this.canvasDragStart = null;\n    this.setState({ canvasDragEnd: null });\n  };\n\n  render() {\n    const { dragging, source, metaDown } = this.state;\n    const { visible, selected, scale, pan, graph, scaleInverse } = this.props;\n    const selStyle = this._selectionBoxStyle();\n    return (\n      <DraggableCore\n        onDrag={this._onCanvasDrag}\n        scale={scale}\n        onStart={this._onStartCanvasDrag}\n        onStop={this._onEndCanvasDrag}\n      >\n        <div\n          id=\"graph-root\"\n          className={\n            dragging\n              ? 'dragging'\n              : selStyle || metaDown\n              ? 'selecting'\n              : this.moving\n              ? 'moving-node'\n              : ''\n          }\n          onWheel={this.onScroll}\n          onDoubleClick={() => this.props.selSet([])}\n        >\n          <div id=\"graph-scalable\" className=\"graph-scalable\" style={this._rootStyle()}>\n            {graph.nodes.map((nis, i) => {\n              return (\n                <Node\n                  selected={selected[nis.node.id]}\n                  visible={visible}\n                  disabled={Boolean(metaDown)}\n                  index={i}\n                  nis={nis}\n                  key={`node-${nis.node.id}`}\n                  onNodeStart={this.onNodeStartMove}\n                  onNodeStop={this.onNodeStopMove}\n                  onNodeMove={this.onNodeMove}\n                  onStartConnector={this.onStartConnector}\n                  onCompleteConnector={this.onCompleteConnector}\n                  onNodeSelect={this.onNodeSelect}\n                  onNodeDeselect={this.onNodeDeselect}\n                  onDelete={this.onDeleteNode}\n                  scale={scale}\n                  positionOffset={pan}\n                />\n              );\n            })}\n            <AllEdges\n              edges={get(graph, 'edges', [])}\n              dragging={dragging}\n              source={source}\n              visible={visible}\n              selected={selected}\n              onRemoveConnector={this.handleRemoveConnector}\n              pan={pan}\n              scaleInverse={scaleInverse}\n              graph={graph}\n              mousePos={this.state.mousePos}\n            />\n          </div>\n          {selStyle && <div id=\"selection-box\" style={selStyle} />}\n        </div>\n      </DraggableCore>\n    );\n  }\n\n  _rootStyle = () => ({ transform: `scale(${this.props.scale})` });\n\n  _selectionBoxStyle = () => {\n    const {\n      canvasDragStart,\n      state: { canvasDragEnd },\n    } = this;\n    if (!canvasDragEnd || !canvasDragStart) {\n      return;\n    }\n    const selCoord = subVec(canvasDragEnd, canvasDragStart);\n    return {\n      width: Math.abs(selCoord.x),\n      height: Math.abs(selCoord.y),\n      top: Math.min(canvasDragStart.y, canvasDragEnd.y),\n      left: Math.min(canvasDragStart.x, canvasDragEnd.x),\n    };\n  };\n\n  _onCopy = () => {\n    const selected = this.props.graph.duplicate(this._getSelected()).map(nis => nis.node.id);\n    this.props.selSet(selected);\n  };\n\n  _selectAll = () => this.props.selSet(this.props.graph.nodeIds());\n\n  _pan = throttle((dir: Direction) => {\n    const { setPan, pan, scaleInverse } = this.props;\n    setPan(addVec(pan, scaleVec(unitVec(dir), scaleInverse * 20)));\n  }, 60);\n\n  _panR = () => this._pan('right');\n  _panL = () => this._pan('left');\n  _panD = () => this._pan('down');\n  _panU = () => this._pan('up');\n\n  // noinspection JSUnusedGlobalSymbols\n  renderHotkeys() {\n    const { selectCount, zoomIn, zoomOut, zoomReset } = this.props;\n    const showCopy = selectCount > 0;\n    return (\n      <Hotkeys>\n        {showCopy && (\n          <Hotkey\n            group=\"Node Actions\"\n            combo=\"shift + meta + c\"\n            label=\"Duplicate Node(s)\"\n            global={true}\n            onKeyDown={this._onCopy}\n            preventDefault\n          />\n        )}\n        <Hotkey global combo=\"shift + meta + a\" label=\"Select All\" onKeyDown={this._selectAll} />\n        <Hotkey global combo=\"alt + =\" label=\"Zoom in\" onKeyDown={() => zoomIn()} group=\"View\" />\n        <Hotkey global combo=\"alt + -\" label=\"Zoom out\" onKeyDown={() => zoomOut()} group=\"View\" />\n        <Hotkey\n          global\n          combo=\"alt + 0\"\n          label=\"Home View\"\n          onKeyDown={() => zoomReset()}\n          group=\"View\"\n        />\n        <Hotkey global combo=\"right\" label=\"Pan right\" onKeyDown={this._panR} group=\"View\" />\n        <Hotkey global combo=\"left\" label=\"Pan left\" onKeyDown={this._panL} group=\"View\" />\n        <Hotkey global combo=\"down\" label=\"Pan down\" onKeyDown={this._panD} group=\"View\" />\n        <Hotkey global combo=\"up\" label=\"Pan up\" onKeyDown={this._panU} group=\"View\" />\n\n        <Hotkey global combo=\"meta + drag\" label=\"Select Area\" group=\"Selection\" />\n        <Hotkey global combo=\"meta + alt + drag\" label=\"Subtract Selection\" group=\"Selection\" />\n        <Hotkey global combo=\"meta + shift + drag\" label=\"Add Selection\" group=\"Selection\" />\n      </Hotkeys>\n    );\n  }\n}\n\nconst select = createSelector(\n  [selectedS, selectView],\n  (selected, view) => ({ ...selected, ...view })\n);\nconst dispatch = d => ({\n  selSet: id => d(_selSet(id)),\n  zoomIn: (pan?: Pos) => d(_zIn(pan)),\n  zoomOut: (pan?: Pos) => d(_zOut(pan)),\n  zoomReset: () => d(_zReset()),\n  setPan: (pos: Pos) => d(_setPan(pos)),\n  updatePos: (pos: PosMemo) => d(_updatePos(pos)),\n});\n\nexport default connect(\n  select,\n  dispatch\n)(HotkeysTarget(NodeGraph));\n","/* eslint-disable */\nconst toObj = ['gainnode', 'delaynode', 'midiinput', 'midioutput', 'float32array'];\n\n//returns a string \"type\" of input object\nexport function toType(obj) {\n  let type = getType(obj);\n  // some extra disambiguation for numbers\n  if (type === 'number') {\n    if (isNaN(obj)) {\n      type = 'nan';\n    } else if ((obj | 0) != obj) {\n      //bitwise OR produces integers\n      type = 'float';\n    } else {\n      type = 'integer';\n    }\n  }\n  if (toObj.includes(type)) {\n    return 'object';\n  }\n  return type;\n}\n\n//source: http://stackoverflow.com/questions/7390426/better-way-to-get-type-of-a-javascript-variable/7390612#7390612\nfunction getType(obj) {\n  return {}.toString\n    .call(obj)\n    .split(' ')[1]\n    .slice(0, -1)\n    .toLowerCase();\n}\n\n//validation for base-16 themes\nexport function isTheme(theme) {\n  const theme_keys = [\n    'base00',\n    'base01',\n    'base02',\n    'base03',\n    'base04',\n    'base05',\n    'base06',\n    'base07',\n    'base08',\n    'base09',\n    'base0A',\n    'base0B',\n    'base0C',\n    'base0D',\n    'base0E',\n    'base0F',\n  ];\n  if (toType(theme) === 'object') {\n    for (var i = 0; i < theme_keys.length; i++) {\n      if (!(theme_keys[i] in theme)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return false;\n}\n","export const defTheme = {\n  scheme: 'rjv-default',\n  //transparent main background\n  base00: 'transparent',\n  base01: 'rgba(0, 0, 0, 0.3)',\n  base02: 'rgba(0, 0, 0, 0.4)',\n  base03: 'rgba(200, 200, 200, 0.3)',\n  base04: '#5f9c92',\n  base05: '#81b5ac',\n  base06: '#a7cec8',\n  base07: '#d2e7e4',\n  base08: '#3e9688',\n  base09: '#3e7996',\n  base0A: '#d0d5d6',\n  base0B: '#883e96',\n  base0C: '#963e4c',\n  base0D: '#cdbe51',\n  base0E: '#4caa4d',\n  base0F: '#e9d449',\n};\n","export default {\n  white: '#fff',\n  black: '#000',\n  transparent: 'rgba(1, 1, 1, 0)',\n\n  globalFontFamily: 'Monaco, \"Source Code Pro\", monospace, sans-serif',\n  globalCursor: 'default',\n\n  indentBlockWidth: '5px',\n\n  braceFontWeight: 'bold',\n  braceCursor: 'pointer',\n\n  ellipsisFontSize: '18px',\n  ellipsisLineHeight: '10px',\n  ellipsisCursor: 'pointer',\n\n  keyMargin: '0px 5px',\n  keyLetterSpacing: '0.5px',\n  keyFontStyle: 'none',\n  keyBorderRadius: '3px',\n  keyColonWeight: 'bold',\n  keyVerticalAlign: 'top',\n  keyOpacity: '0.85',\n  keyOpacityHover: '1',\n\n  keyValPaddingTop: '3px',\n  keyValPaddingBottom: '3px',\n  keyValPaddingRight: 0,\n  keyValBorderLeft: '1px solid',\n  keyValBorderHover: '2px solid',\n  keyValPaddingHover: '3px 5px 3px 4px',\n\n  pushedContentMarginLeft: '6px',\n\n  variableValuePaddingRight: 0,\n\n  nullFontSize: '11px',\n  nullFontWeight: 'bold',\n  nullPadding: '1px 5px',\n  nullBorderRadius: '3px',\n\n  dataTypeFontSize: '11px',\n  dataTypeMarginRight: '4px',\n  datatypeOpacity: '0.8',\n\n  objectSizeBorderRadius: '3px',\n  objectSizeFontStyle: 'italic',\n  objectSizeMargin: '0px 6px 0px 0px',\n\n  clipboardCursor: 'pointer',\n  clipboardCheckMarginLeft: '-12px',\n\n  metaDataPadding: '0px 0px 0px 10px',\n\n  arrayGroupMetaPadding: '0px 0px 0px 4px',\n\n  iconContainerWidth: '17px',\n\n  tooltipPadding: '4px',\n\n  editInputHeight: '25px',\n  editInputMinWidth: '130px',\n  editInputBorderRadius: '3px',\n  editInputPadding: '6px 8px 4px 8px',\n  editInputMarginRight: '4px',\n  editInputFontFamily: 'Monaco, \"Source Code Pro\", monospace, sans-serif',\n\n  iconCursor: 'pointer',\n  iconFontSize: '15px',\n  iconPaddingRight: '1px',\n\n  dateValueMarginLeft: '2px',\n\n  iconMarginRight: '3px',\n\n  detectedRowPaddingTop: '3px',\n\n  addKeyCoverBackground: 'rgba(255, 255, 255, 0.3)',\n  addKeyCoverPosition: 'absolute',\n  addKeyCoverPositionPx: '0px',\n  addKeyModalWidth: '200px',\n  addKeyModalMargin: 'auto',\n  addKeyModalPadding: '10px',\n  addKeyModalRadius: '3px',\n};\n","import { defTheme } from './base16/rjv-themes';\nimport constants from './styleConstants';\nimport { createStyling } from 'react-base16-styling';\n\nconst colorMap = theme => ({\n  backgroundColor: theme.base00,\n  ellipsisColor: theme.base09,\n  braceColor: theme.base07,\n  expandedIcon: theme.base0D,\n  collapsedIcon: theme.base0E,\n  keyColor: theme.base07,\n  arrayKeyColor: theme.base0C,\n  objectSize: theme.base04,\n  copyToClipboard: theme.base0F,\n  copyToClipboardCheck: theme.base0D,\n  objectBorder: theme.base03,\n  dataTypes: {\n    boolean: theme.base0E,\n    date: theme.base0D,\n    float: theme.base0B,\n    function: theme.base0D,\n    integer: theme.base0F,\n    string: theme.base09,\n    nan: theme.base08,\n    null: theme.base0A,\n    undefined: theme.base05,\n    regexp: theme.base0A,\n    background: theme.base02,\n  },\n  editVariable: {\n    editIcon: theme.base0E,\n    cancelIcon: theme.base09,\n    removeIcon: theme.base09,\n    addIcon: theme.base0E,\n    checkIcon: theme.base0E,\n    background: theme.base01,\n    color: theme.base0A,\n    border: theme.base07,\n  },\n  addKeyModal: {\n    background: theme.base05,\n    border: theme.base04,\n    color: theme.base0A,\n    labelColor: theme.base01,\n  },\n  validationFailure: {\n    background: theme.base09,\n    iconColor: theme.base01,\n    fontColor: theme.base01,\n  },\n});\n\nconst getDefaultThemeStyling = theme => {\n  const colors = colorMap(theme);\n\n  return {\n    'app-container': {\n      fontFamily: constants.globalFontFamily,\n      cursor: constants.globalCursor,\n      backgroundColor: colors.backgroundColor,\n      position: 'relative',\n    },\n    ellipsis: {\n      display: 'inline-block',\n      color: colors.ellipsisColor,\n      fontSize: constants.ellipsisFontSize,\n      lineHeight: constants.ellipsisLineHeight,\n      cursor: constants.ellipsisCursor,\n    },\n    'brace-row': {\n      display: 'inline-block',\n      cursor: 'pointer',\n    },\n    brace: {\n      display: 'inline-block',\n      cursor: constants.braceCursor,\n      fontWeight: constants.braceFontWeight,\n      color: colors.braceColor,\n    },\n    'expanded-icon': {\n      color: colors.expandedIcon,\n    },\n    'collapsed-icon': {\n      color: colors.collapsedIcon,\n    },\n    colon: {\n      display: 'inline-block',\n      margin: constants.keyMargin,\n      color: colors.keyColor,\n      verticalAlign: 'top',\n    },\n    objectKeyVal: (component, variable_style) => {\n      return {\n        style: {\n          paddingTop: constants.keyValPaddingTop,\n          paddingRight: constants.keyValPaddingRight,\n          paddingBottom: constants.keyValPaddingBottom,\n          borderLeft: constants.keyValBorderLeft + ' ' + colors.objectBorder,\n          ':hover': {\n            paddingLeft: variable_style.paddingLeft - 1 + 'px',\n            borderLeft: constants.keyValBorderHover + ' ' + colors.objectBorder,\n          },\n          ...variable_style,\n        },\n      };\n    },\n    'object-key-val-no-border': {\n      padding: constants.keyValPadding,\n    },\n    'pushed-content': (_, styles) => ({\n      style: {\n        marginLeft: constants.pushedContentMarginLeft,\n        ...styles,\n      },\n    }),\n    variableValue: (component, variable_style) => {\n      return {\n        style: {\n          display: 'inline-block',\n          paddingRight: constants.variableValuePaddingRight,\n          position: 'relative',\n          ...variable_style,\n        },\n      };\n    },\n    'object-name': {\n      display: 'inline-block',\n      color: colors.keyColor,\n      letterSpacing: constants.keyLetterSpacing,\n      fontStyle: constants.keyFontStyle,\n      verticalAlign: constants.keyVerticalAlign,\n      opacity: constants.keyOpacity,\n      ':hover': {\n        opacity: constants.keyOpacityHover,\n      },\n    },\n    'array-key': {\n      display: 'inline-block',\n      color: colors.arrayKeyColor,\n      letterSpacing: constants.keyLetterSpacing,\n      fontStyle: constants.keyFontStyle,\n      verticalAlign: constants.keyVerticalAlign,\n      opacity: constants.keyOpacity,\n      ':hover': {\n        opacity: constants.keyOpacityHover,\n      },\n    },\n    'object-size': {\n      color: colors.objectSize,\n      borderRadius: constants.objectSizeBorderRadius,\n      fontStyle: constants.objectSizeFontStyle,\n      margin: constants.objectSizeMargin,\n      cursor: 'default',\n    },\n    'data-type-label': {\n      fontSize: constants.dataTypeFontSize,\n      marginRight: constants.dataTypeMarginRight,\n      opacity: constants.datatypeOpacity,\n    },\n    boolean: {\n      display: 'inline-block',\n      color: colors.dataTypes.boolean,\n      fontWeight: 'bold',\n    },\n    date: {\n      display: 'inline-block',\n      color: colors.dataTypes.date,\n    },\n    'date-value': {\n      marginLeft: constants.dateValueMarginLeft,\n    },\n    float: {\n      display: 'inline-block',\n      color: colors.dataTypes.float,\n    },\n    function: {\n      display: 'inline-block',\n      color: colors.dataTypes['function'],\n      cursor: 'pointer',\n      whiteSpace: 'pre-line',\n    },\n    'function-value': {\n      fontStyle: 'italic',\n    },\n    integer: {\n      display: 'inline-block',\n      color: colors.dataTypes.integer,\n    },\n    string: {\n      display: 'inline-block',\n      color: colors.dataTypes.string,\n    },\n    nan: {\n      display: 'inline-block',\n      color: colors.dataTypes.nan,\n      fontWeight: constants.nullFontWeight,\n      fontSize: constants.nullFontSize,\n      padding: constants.nullPadding,\n      borderRadius: constants.nullBorderRadius,\n      backgroundColor: colors.dataTypes.background,\n    },\n    null: {\n      display: 'inline-block',\n      color: colors.dataTypes.null,\n      fontWeight: constants.nullFontWeight,\n      fontSize: constants.nullFontSize,\n      padding: constants.nullPadding,\n      borderRadius: constants.nullBorderRadius,\n      backgroundColor: colors.dataTypes.background,\n    },\n    undefined: {\n      display: 'inline-block',\n      color: colors.dataTypes.undefined,\n      fontSize: constants.nullFontSize,\n      padding: constants.nullPadding,\n      borderRadius: constants.nullBorderRadius,\n      backgroundColor: colors.dataTypes.background,\n    },\n    regexp: {\n      display: 'inline-block',\n      color: colors.dataTypes.regexp,\n    },\n    'copy-to-clipboard': {\n      cursor: constants.clipboardCursor,\n    },\n    'copy-icon': {\n      color: colors.copyToClipboard,\n      fontSize: constants.iconFontSize,\n      marginRight: constants.iconMarginRight,\n      verticalAlign: 'top',\n    },\n    'copy-icon-copied': {\n      color: colors.copyToClipboardCheck,\n      marginLeft: constants.clipboardCheckMarginLeft,\n    },\n    'array-group-meta-data': {\n      display: 'inline-block',\n      padding: constants.arrayGroupMetaPadding,\n    },\n    'object-meta-data': {\n      display: 'inline-block',\n      padding: constants.metaDataPadding,\n    },\n    'icon-container': {\n      display: 'inline-block',\n      width: constants.iconContainerWidth,\n    },\n    tooltip: {\n      padding: constants.tooltipPadding,\n    },\n    removeVarIcon: {\n      verticalAlign: 'top',\n      display: 'inline-block',\n      color: colors.editVariable.removeIcon,\n      cursor: constants.iconCursor,\n      fontSize: constants.iconFontSize,\n      marginRight: constants.iconMarginRight,\n    },\n    addVarIcon: {\n      verticalAlign: 'top',\n      display: 'inline-block',\n      color: colors.editVariable.addIcon,\n      cursor: constants.iconCursor,\n      fontSize: constants.iconFontSize,\n      marginRight: constants.iconMarginRight,\n    },\n    editVarIcon: {\n      verticalAlign: 'top',\n      display: 'inline-block',\n      color: colors.editVariable.editIcon,\n      cursor: constants.iconCursor,\n      fontSize: constants.iconFontSize,\n      marginRight: constants.iconMarginRight,\n    },\n    'edit-icon-container': {\n      display: 'block',\n    },\n    'check-icon': {\n      display: 'inline-block',\n      cursor: constants.iconCursor,\n      color: colors.editVariable.checkIcon,\n      fontSize: constants.iconFontSize,\n      paddingRight: constants.iconPaddingRight,\n    },\n    'cancel-icon': {\n      display: 'inline-block',\n      cursor: constants.iconCursor,\n      color: colors.editVariable.cancelIcon,\n      fontSize: constants.iconFontSize,\n      paddingRight: constants.iconPaddingRight,\n    },\n    'edit-input': {\n      display: 'inline-block',\n      minHeight: constants.editInputHeight,\n      minWidth: constants.editInputMinWidth,\n      borderRadius: constants.editInputBorderRadius,\n      border: 'none',\n      backgroundColor: colors.editVariable.background,\n      color: colors.editVariable.color,\n      padding: constants.editInputPadding,\n      marginRight: constants.editInputMarginRight,\n      fontFamily: constants.editInputFontFamily,\n      resize: 'none',\n    },\n    'detected-row': {\n      paddingTop: constants.detectedRowPaddingTop,\n    },\n    'key-modal-request': {\n      position: constants.addKeyCoverPosition,\n      top: constants.addKeyCoverPositionPx,\n      left: constants.addKeyCoverPositionPx,\n      right: constants.addKeyCoverPositionPx,\n      bottom: constants.addKeyCoverPositionPx,\n      backgroundColor: constants.addKeyCoverBackground,\n    },\n    'key-modal': {\n      width: constants.addKeyModalWidth,\n      backgroundColor: colors.addKeyModal.background,\n      marginLeft: constants.addKeyModalMargin,\n      marginRight: constants.addKeyModalMargin,\n      padding: constants.addKeyModalPadding,\n      borderRadius: constants.addKeyModalRadius,\n      marginTop: '15px',\n      position: 'relative',\n    },\n    'key-modal-label': {\n      color: colors.addKeyModal.labelColor,\n      marginLeft: '2px',\n      marginBottom: '5px',\n      fontSize: '11px',\n    },\n    'key-modal-input-container': {\n      overflow: 'hidden',\n    },\n    'key-modal-input': {\n      width: '100%',\n      padding: '3px 6px',\n      fontFamily: 'monospace',\n      color: colors.addKeyModal.color,\n      border: 'none',\n      boxSizing: 'border-box',\n      borderRadius: '2px',\n    },\n    'key-modal-cancel': {\n      backgroundColor: colors.editVariable.removeIcon,\n      position: 'absolute',\n      top: '0px',\n      right: '0px',\n      borderRadius: '0px 3px 0px 3px',\n      cursor: 'pointer',\n    },\n    'key-modal-cancel-icon': {\n      color: colors.addKeyModal.labelColor,\n      fontSize: constants.iconFontSize,\n      transform: 'rotate(45deg)',\n    },\n    'key-modal-submit': {\n      color: colors.editVariable.addIcon,\n      fontSize: constants.iconFontSize,\n      position: 'absolute',\n      right: '2px',\n      top: '3px',\n      cursor: 'pointer',\n    },\n    'function-ellipsis': {\n      display: 'inline-block',\n      color: colors.ellipsisColor,\n      fontSize: constants.ellipsisFontSize,\n      lineHeight: constants.ellipsisLineHeight,\n      cursor: constants.ellipsisCursor,\n    },\n    'validation-failure': {\n      float: 'right',\n      padding: '3px 6px',\n      borderRadius: '2px',\n      cursor: 'pointer',\n      color: colors.validationFailure.fontColor,\n      backgroundColor: colors.validationFailure.background,\n    },\n    'validation-failure-label': {\n      marginRight: '6px',\n    },\n    'validation-failure-clear': {\n      position: 'relative',\n      verticalAlign: 'top',\n      cursor: 'pointer',\n      color: colors.validationFailure.iconColor,\n      fontSize: constants.iconFontSize,\n      transform: 'rotate(45deg)',\n    },\n  };\n};\n\nconst getStyle = theme => {\n  return createStyling(getDefaultThemeStyling, { defaultBase16: defTheme })(theme);\n};\n\nexport default function style(theme, component, args) {\n  if (!theme) {\n    console.error('theme has not been set');\n  }\n\n  return getStyle(theme)(component, args);\n}\n","import React from 'react';\n\n//theme\nimport Theme from './../../themes/getStyle';\n\nexport default class extends React.PureComponent {\n  render() {\n    const { type_name, displayDataTypes, theme } = this.props;\n    if (displayDataTypes) {\n      return (\n        <span className=\"data-type-label\" {...Theme(theme, 'data-type-label')}>\n          {type_name}\n        </span>\n      );\n    }\n    return null;\n  }\n}\n","import React from 'react';\nimport DataTypeLabel from './DataTypeLabel';\n\n//theme\nimport Theme from './../../themes/getStyle';\n\nexport default class extends React.PureComponent {\n  render() {\n    const type_name = 'bool';\n    const { props } = this;\n\n    return (\n      <div {...Theme(props.theme, 'boolean')}>\n        <DataTypeLabel type_name={type_name} {...props} />\n        {props.value ? 'true' : 'false'}\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport DataTypeLabel from './DataTypeLabel';\n\n//theme\nimport Theme from './../../themes/getStyle';\n\nexport default class extends React.PureComponent {\n  render() {\n    const type_name = 'date';\n    const { props } = this;\n    const display_options = {\n      weekday: 'short',\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    };\n    return (\n      <div {...Theme(props.theme, 'date')}>\n        <DataTypeLabel type_name={type_name} {...props} />\n        <span className=\"date-value\" {...Theme(props.theme, 'date-value')}>\n          {props.value.toLocaleTimeString('en-us', display_options)}\n        </span>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport DataTypeLabel from './DataTypeLabel';\n\n//theme\nimport Theme from './../../themes/getStyle';\n\nexport default class extends React.PureComponent {\n  render() {\n    const type_name = 'float';\n    const { props } = this;\n    return (\n      <div {...Theme(props.theme, 'float')}>\n        <DataTypeLabel type_name={type_name} {...props} />\n        {this.props.value}\n      </div>\n    );\n  }\n}\n","import { Dispatcher } from 'flux';\nconst dispatcher = new Dispatcher();\nexport default dispatcher;\n","/* eslint-disable */\nimport { EventEmitter } from 'events';\nimport dispatcher from './../helpers/dispatcher';\nimport { toType } from './../helpers/util';\n\n//store persistent display attributes for objects and arrays\nclass ObjectAttributes extends EventEmitter {\n  objects = {};\n\n  set = (rjvId, name, key, value) => {\n    if (this.objects[rjvId] === undefined) {\n      this.objects[rjvId] = {};\n    }\n    if (this.objects[rjvId][name] === undefined) {\n      this.objects[rjvId][name] = {};\n    }\n    this.objects[rjvId][name][key] = value;\n  };\n\n  get = (rjvId, name, key, default_value) => {\n    if (\n      this.objects[rjvId] === undefined ||\n      this.objects[rjvId][name] === undefined ||\n      this.objects[rjvId][name][key] == undefined\n    ) {\n      return default_value;\n    }\n    return this.objects[rjvId][name][key];\n  };\n\n  handleAction = action => {\n    const { rjvId, data, name } = action;\n    switch (name) {\n      case 'RESET':\n        this.emit('reset-' + rjvId);\n        break;\n      case 'VARIABLE_UPDATED':\n        action.data.updated_src = this.updateSrc(rjvId, data);\n        this.set(rjvId, 'action', 'variable-update', { ...data, type: 'variable-edited' });\n        this.emit('variable-update-' + rjvId);\n        break;\n      case 'VARIABLE_REMOVED':\n        action.data.updated_src = this.updateSrc(rjvId, data);\n        this.set(rjvId, 'action', 'variable-update', { ...data, type: 'variable-removed' });\n        this.emit('variable-update-' + rjvId);\n        break;\n      case 'VARIABLE_ADDED':\n        action.data.updated_src = this.updateSrc(rjvId, data);\n        this.set(rjvId, 'action', 'variable-update', { ...data, type: 'variable-added' });\n        this.emit('variable-update-' + rjvId);\n        break;\n      case 'ADD_VARIABLE_KEY_REQUEST':\n        this.set(rjvId, 'action', 'new-key-request', data);\n        this.emit('add-key-request-' + rjvId);\n        break;\n    }\n  };\n\n  updateSrc = (rjvId, request) => {\n    let { name, namespace, new_value, existing_value, variable_removed } = request;\n\n    namespace.shift();\n\n    //deepy copy src\n    let src = this.get(rjvId, 'global', 'src');\n    //deep copy of src variable\n    let updated_src = this.deepCopy(src, [...namespace]);\n\n    //point at current index\n    let walk = updated_src;\n    for (const idx of namespace) {\n      walk = walk[idx];\n    }\n\n    if (variable_removed) {\n      if (toType(walk) == 'array') {\n        walk.splice(name, 1);\n      } else {\n        delete walk[name];\n      }\n    } else {\n      //update copied variable at specified namespace\n      if (name !== null) {\n        walk[name] = new_value;\n      } else {\n        updated_src = new_value;\n      }\n    }\n\n    this.set(rjvId, 'global', 'src', updated_src);\n\n    return updated_src;\n  };\n\n  deepCopy = (src, copy_namespace) => {\n    const type = toType(src);\n    let result;\n    let idx = copy_namespace.shift();\n    if (type == 'array') {\n      result = [...src];\n    } else if (type == 'object') {\n      result = { ...src };\n    }\n    if (idx !== undefined) {\n      result[idx] = this.deepCopy(src[idx], copy_namespace);\n    }\n    return result;\n  };\n}\n\nconst attributeStore = new ObjectAttributes();\ndispatcher.register(attributeStore.handleAction.bind(attributeStore));\nexport default attributeStore;\n","import React from 'react';\nimport DataTypeLabel from './DataTypeLabel';\n\n//theme\nimport Theme from './../../themes/getStyle';\n\n//attribute store for storing collapsed state\nimport AttributeStore from './../../stores/ObjectAttributes';\n\nexport default class extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      collapsed: AttributeStore.get(props.rjvId, props.namespace, 'collapsed', true),\n    };\n  }\n\n  toggleCollapsed = () => {\n    this.setState(\n      {\n        collapsed: !this.state.collapsed,\n      },\n      () => {\n        // will be called after setState takes effect.\n        AttributeStore.set(\n          this.props.rjvId,\n          this.props.namespace,\n          'collapsed',\n          this.state.collapsed\n        );\n      }\n    );\n  };\n\n  render() {\n    const type_name = 'function';\n    const { props } = this;\n    const { collapsed } = this.state;\n\n    return (\n      <div {...Theme(props.theme, 'function')}>\n        <DataTypeLabel type_name={type_name} {...props} />\n        <span\n          {...Theme(props.theme, 'function-value')}\n          className=\"rjv-function-container\"\n          onClick={this.toggleCollapsed}>\n          {this.getFunctionDisplay(collapsed)}\n        </span>\n      </div>\n    );\n  }\n\n  getFunctionDisplay = collapsed => {\n    const { props } = this;\n    if (collapsed) {\n      return (\n        <span>\n          {this.props.value\n            .toString()\n            .slice(9, -1)\n            .replace(/\\{[\\s\\S]+/, '')}\n          <span className=\"function-collapsed\" style={{ fontWeight: 'bold' }}>\n            <span>{'{'}</span>\n            <span {...Theme(props.theme, 'ellipsis')}>...</span>\n            <span>{'}'}</span>\n          </span>\n        </span>\n      );\n    } else {\n      return this.props.value.toString().slice(9, -1);\n    }\n  };\n}\n","import React from 'react';\n\n//theme\nimport Theme from './../../themes/getStyle';\n\nexport default class extends React.PureComponent {\n  render() {\n    return <div {...Theme(this.props.theme, 'nan')}>NaN</div>;\n  }\n}\n","import React from 'react';\n\n//theme\nimport Theme from './../../themes/getStyle';\n\nexport default class extends React.PureComponent {\n  render() {\n    return <div {...Theme(this.props.theme, 'null')}>null</div>;\n  }\n}\n","import React from 'react';\nimport DataTypeLabel from './DataTypeLabel';\n\n//theme\nimport Theme from './../../themes/getStyle';\n\nexport default class extends React.PureComponent {\n  render() {\n    const type_name = 'int';\n    const { props } = this;\n    return (\n      <div {...Theme(props.theme, 'integer')}>\n        <DataTypeLabel type_name={type_name} {...props} />\n        {this.props.value}\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport DataTypeLabel from './DataTypeLabel';\n\n//theme\nimport Theme from './../../themes/getStyle';\n\nexport default class extends React.PureComponent {\n  render() {\n    const type_name = 'regexp';\n    const { props } = this;\n    return (\n      <div {...Theme(props.theme, 'regexp')}>\n        <DataTypeLabel type_name={type_name} {...props} />\n        {this.props.value.toString()}\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport DataTypeLabel from './DataTypeLabel';\nimport { toType } from './../../helpers/util';\n\n//theme\nimport Theme from './../../themes/getStyle';\n\n//attribute store for storing collapsed state\nimport AttributeStore from './../../stores/ObjectAttributes';\n\nexport default class extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      collapsed: AttributeStore.get(props.rjvId, props.namespace, 'collapsed', true),\n    };\n  }\n\n  toggleCollapsed = () => {\n    this.setState(\n      {\n        collapsed: !this.state.collapsed,\n      },\n      () => {\n        AttributeStore.set(\n          this.props.rjvId,\n          this.props.namespace,\n          'collapsed',\n          this.state.collapsed\n        );\n      }\n    );\n  };\n\n  render() {\n    const type_name = 'string';\n    const { props } = this;\n    const { collapseStringsAfterLength, theme, isPrimitive } = props;\n    let { value } = props;\n    let collapsible = toType(collapseStringsAfterLength) === 'integer';\n    let style = { style: { cursor: 'default', whiteSpace: 'pre-wrap' } };\n\n    if (collapsible && value.length > collapseStringsAfterLength && !isPrimitive) {\n      style.style.cursor = 'pointer';\n      if (this.state.collapsed) {\n        value = (\n          <span>\n            {value.substring(0, collapseStringsAfterLength)}\n            <span {...Theme(theme, 'ellipsis')}> ...</span>\n          </span>\n        );\n      }\n    }\n\n    return (\n      <div {...Theme(theme, 'string')}>\n        <DataTypeLabel type_name={type_name} {...props} />\n        <span className=\"string-value\" {...style} onClick={this.toggleCollapsed}>\n          \"{value}\"\n        </span>\n      </div>\n    );\n  }\n}\n","import React from 'react';\n\n//theme\nimport Theme from './../../themes/getStyle';\n\nexport default class extends React.PureComponent {\n  render() {\n    return <div {...Theme(this.props.theme, 'undefined')}>undefined</div>;\n  }\n}\n","export default function parseInput(input) {\n  //following code is to make a best guess at\n  //the type for a variable being submitted.\n  //we are working with a serialized data representation\n  input = input.trim();\n  try {\n    input = JSON.stringify(JSON.parse(input));\n    if (input[0] === '[') {\n      //array\n      return formatResponse('array', JSON.parse(input));\n    } else if (input[0] === '{') {\n      //object\n      return formatResponse('object', JSON.parse(input));\n    } else if (input.match(/-?\\d+\\.\\d+/) && input.match(/-?\\d+\\.\\d+/)[0] === input) {\n      //integer\n      return formatResponse('float', parseFloat(input));\n    } else if (input.match(/-?\\d+/) && input.match(/-?\\d+/)[0] === input) {\n      //float\n      return formatResponse('integer', parseInt(input));\n    }\n  } catch (e) {\n    // no-op\n  }\n\n  //run in case input was not serializable\n  input = input.toLowerCase();\n  switch (input) {\n    case 'undefined': {\n      return formatResponse('undefined', undefined);\n    }\n    case 'nan': {\n      return formatResponse('nan', NaN);\n    }\n    case 'infinity': {\n      return formatResponse('infinity', Infinity);\n    }\n    case 'null': {\n      return formatResponse('null', null);\n    }\n    case 'true': {\n      return formatResponse('boolean', true);\n    }\n    case 'false': {\n      return formatResponse('boolean', false);\n    }\n    default: {\n      return formatResponse(false, null);\n    }\n  }\n}\n\nfunction formatResponse(type, value) {\n  return { type: type, value: value };\n}\n","import { toType } from './util';\n\nexport default value => {\n  const type = toType(value);\n  let string_value;\n  switch (type) {\n    case 'undefined': {\n      string_value = 'undefined';\n      break;\n    }\n    case 'nan':\n      string_value = 'NaN';\n      break;\n    case 'string':\n      string_value = value;\n      break;\n    case 'date':\n      string_value = value.toString();\n      break;\n    case 'function':\n      string_value = value.toString();\n      break;\n    case 'regexp':\n      string_value = value.toString();\n      break;\n    default: {\n      try {\n        string_value = JSON.stringify(value, null, '  ');\n      } catch (e) {\n        string_value = '';\n      }\n    }\n  }\n\n  return string_value;\n};\n","import React from 'react';\n\nconst DEFAULT_COLOR = '#000000';\n\nexport class CircleMinus extends React.PureComponent {\n  render() {\n    const { props } = this;\n    const { style, ...rest } = props;\n\n    return (\n      <span {...rest}>\n        <svg\n          {...getIconStyle(style)}\n          viewBox=\"0 0 24 24\"\n          fill=\"currentColor\"\n          preserveAspectRatio=\"xMidYMid meet\">\n          <path d=\"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M7,13H17V11H7\" />\n        </svg>\n      </span>\n    );\n  }\n}\n\nexport class CirclePlus extends React.PureComponent {\n  render() {\n    const { props } = this;\n    const { style, ...rest } = props;\n\n    return (\n      <span {...rest}>\n        <svg\n          {...getIconStyle(style)}\n          viewBox=\"0 0 24 24\"\n          fill=\"currentColor\"\n          preserveAspectRatio=\"xMidYMid meet\">\n          <path d=\"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M13,7H11V11H7V13H11V17H13V13H17V11H13V7Z\" />\n        </svg>\n      </span>\n    );\n  }\n}\n\nexport class SquareMinus extends React.PureComponent {\n  render() {\n    const { props } = this;\n    const { style, ...rest } = props;\n    const svgStyle = getIconStyle(style).style;\n\n    return (\n      <span {...rest}>\n        <svg\n          fill={svgStyle.color}\n          width={svgStyle.height}\n          height={svgStyle.width}\n          style={svgStyle}\n          viewBox=\"0 0 1792 1792\">\n          <path d=\"M1344 800v64q0 14-9 23t-23 9h-832q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h832q14 0 23 9t9 23zm128 448v-832q0-66-47-113t-113-47h-832q-66 0-113 47t-47 113v832q0 66 47 113t113 47h832q66 0 113-47t47-113zm128-832v832q0 119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119 84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z\" />\n        </svg>\n      </span>\n    );\n  }\n}\n\nexport class SquarePlus extends React.PureComponent {\n  render() {\n    const { props } = this;\n    const { style, ...rest } = props;\n    const svgStyle = getIconStyle(style).style;\n\n    return (\n      <span {...rest}>\n        <svg\n          fill={svgStyle.color}\n          width={svgStyle.height}\n          height={svgStyle.width}\n          style={svgStyle}\n          viewBox=\"0 0 1792 1792\">\n          <path d=\"M1344 800v64q0 14-9 23t-23 9h-352v352q0 14-9 23t-23 9h-64q-14 0-23-9t-9-23v-352h-352q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h352v-352q0-14 9-23t23-9h64q14 0 23 9t9 23v352h352q14 0 23 9t9 23zm128 448v-832q0-66-47-113t-113-47h-832q-66 0-113 47t-47 113v832q0 66 47 113t113 47h832q66 0 113-47t47-113zm128-832v832q0 119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119 84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z\" />\n        </svg>\n      </span>\n    );\n  }\n}\n\nexport class ArrowRight extends React.PureComponent {\n  render() {\n    const { props } = this;\n    const { style, ...rest } = props;\n\n    return (\n      <span {...rest}>\n        <svg\n          style={{ ...getIconStyle(style).style, paddingLeft: '2px', verticalAlign: 'top' }}\n          viewBox=\"0 0 15 15\"\n          fill=\"currentColor\">\n          <path d=\"M0 14l6-6-6-6z\" />\n        </svg>\n      </span>\n    );\n  }\n}\n\nexport class ArrowDown extends React.PureComponent {\n  render() {\n    const { props } = this;\n    const { style, ...rest } = props;\n\n    return (\n      <span {...rest}>\n        <svg\n          style={{ ...getIconStyle(style).style, paddingLeft: '2px', verticalAlign: 'top' }}\n          viewBox=\"0 0 15 15\"\n          fill=\"currentColor\">\n          <path d=\"M0 5l6 6 6-6z\" />\n        </svg>\n      </span>\n    );\n  }\n}\n\nexport class Clippy extends React.PureComponent {\n  render() {\n    const { props } = this;\n    const { style, ...rest } = props;\n\n    return (\n      <span {...rest}>\n        <svg\n          {...getIconStyle(style)}\n          viewBox=\"0 0 40 40\"\n          fill=\"currentColor\"\n          preserveAspectRatio=\"xMidYMid meet\">\n          <g>\n            <path d=\"m30 35h-25v-22.5h25v7.5h2.5v-12.5c0-1.4-1.1-2.5-2.5-2.5h-7.5c0-2.8-2.2-5-5-5s-5 2.2-5 5h-7.5c-1.4 0-2.5 1.1-2.5 2.5v27.5c0 1.4 1.1 2.5 2.5 2.5h25c1.4 0 2.5-1.1 2.5-2.5v-5h-2.5v5z m-20-27.5h2.5s2.5-1.1 2.5-2.5 1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5 1.3 2.5 2.5 2.5h2.5s2.5 1.1 2.5 2.5h-20c0-1.5 1.1-2.5 2.5-2.5z m-2.5 20h5v-2.5h-5v2.5z m17.5-5v-5l-10 7.5 10 7.5v-5h12.5v-5h-12.5z m-17.5 10h7.5v-2.5h-7.5v2.5z m12.5-17.5h-12.5v2.5h12.5v-2.5z m-7.5 5h-5v2.5h5v-2.5z\" />\n          </g>\n        </svg>\n      </span>\n    );\n  }\n}\n\nexport class RemoveCircle extends React.PureComponent {\n  render() {\n    const { props } = this;\n    const { style, ...rest } = props;\n\n    return (\n      <span {...rest}>\n        <i className=\"fa fa-remove attr-indicator\" />\n      </span>\n    );\n  }\n}\n\nexport class AddCircle extends React.PureComponent {\n  render() {\n    const { props } = this;\n    const { style, ...rest } = props;\n\n    return (\n      <span {...rest}>\n        <svg\n          {...getIconStyle(style)}\n          viewBox=\"0 0 40 40\"\n          fill=\"currentColor\"\n          preserveAspectRatio=\"xMidYMid meet\">\n          <g>\n            <path d=\"m30.1 21.4v-2.8q0-0.6-0.4-1t-1-0.5h-5.7v-5.7q0-0.6-0.4-1t-1-0.4h-2.9q-0.6 0-1 0.4t-0.4 1v5.7h-5.7q-0.6 0-1 0.5t-0.5 1v2.8q0 0.6 0.5 1t1 0.5h5.7v5.7q0 0.5 0.4 1t1 0.4h2.9q0.6 0 1-0.4t0.4-1v-5.7h5.7q0.6 0 1-0.5t0.4-1z m7.2-1.4q0 4.7-2.3 8.6t-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3 8.6 2.3 6.3 6.2 2.3 8.6z\" />\n          </g>\n        </svg>\n      </span>\n    );\n  }\n}\n\nexport class Add extends React.PureComponent {\n  render() {\n    const { props } = this;\n    const { style, ...rest } = props;\n\n    return (\n      <span {...rest}>\n        <svg\n          {...getIconStyle(style)}\n          viewBox=\"0 0 40 40\"\n          fill=\"currentColor\"\n          preserveAspectRatio=\"xMidYMid meet\">\n          <g>\n            <path d=\"m31.6 21.6h-10v10h-3.2v-10h-10v-3.2h10v-10h3.2v10h10v3.2z\" />\n          </g>\n        </svg>\n      </span>\n    );\n  }\n}\n\nexport class Edit extends React.PureComponent {\n  render() {\n    const { props } = this;\n    const { style, ...rest } = props;\n    return (\n      <span {...rest}>\n        <i className=\"fa fa-edit attr-indicator\" />\n      </span>\n    );\n  }\n}\n\nexport class CheckCircle extends React.PureComponent {\n  render() {\n    const { props } = this;\n    const { style, ...rest } = props;\n\n    return (\n      <span {...rest}>\n        <i className=\"fa fa-check attr-indicator\" />\n      </span>\n    );\n  }\n}\n\nfunction getIconStyle(style) {\n  if (!style) {\n    style = {};\n  }\n  return {\n    style: {\n      verticalAlign: 'middle',\n      ...style,\n      color: style.color ? style.color : DEFAULT_COLOR,\n      height: '1em',\n      width: '1em',\n    },\n  };\n}\n","/* eslint-disable */\nimport React from 'react';\nimport AutosizeTextarea from 'react-textarea-autosize';\n\nimport dispatcher from './../helpers/dispatcher';\nimport parseInput from './../helpers/parseInput';\nimport stringifyVariable from './../helpers/stringifyVariable';\n\n//data type components\nimport {\n  JsonBoolean,\n  JsonDate,\n  JsonFloat,\n  JsonFunction,\n  JsonInteger,\n  JsonNan,\n  JsonNull,\n  JsonRegexp,\n  JsonString,\n  JsonUndefined,\n} from './DataTypes/DataTypes';\n\nimport { Edit, CheckCircle, RemoveCircle as Remove } from './icons';\n\n//theme\nimport Theme from './../themes/getStyle';\nimport { Hotkey, Hotkeys, HotkeysTarget } from '@blueprintjs/core';\n\nclass VariableEditor extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      editMode: false,\n      editValue: '',\n      renameKey: false,\n      parsedInput: {\n        type: false,\n        value: null,\n      },\n    };\n  }\n\n  // noinspection JSUnusedGlobalSymbols\n  renderHotkeys() {\n    if (!this.props.editOnHotkey) {\n      return <Hotkeys />;\n    }\n    return (\n      <Hotkeys>\n        <Hotkey\n          group=\"Detail Pane\"\n          global={Boolean(this.props.variable)}\n          combo=\"meta + i\"\n          label=\"Edit First Value\"\n          onKeyDown={() => this.prepopInput(this.props.variable)}\n        />\n      </Hotkeys>\n    );\n  }\n\n  renderKey = () => {\n    const { type, isPrimitive, variable, theme, namespace } = this.props;\n    if (isPrimitive) return null;\n    return type === 'array' ? (\n      <span {...Theme(theme, 'array-key')} key={variable.name + '_' + namespace}>\n        {variable.name}\n        <div {...Theme(theme, 'colon')}>:</div>\n      </span>\n    ) : (\n      <span>\n        <span\n          {...Theme(theme, 'object-name')}\n          className=\"object-key\"\n          key={variable.name + '_' + namespace}\n        >\n          <span style={{ display: 'inline-block' }}>{variable.name}</span>\n        </span>\n        <span {...Theme(theme, 'colon')}>:</span>\n      </span>\n    );\n  };\n\n  render() {\n    const {\n      variable,\n      singleIndent,\n      theme,\n      namespace,\n      indentWidth,\n      onEdit,\n      onDelete,\n      onSelect,\n      isPrimitive,\n    } = this.props;\n    const { editMode } = this.state;\n\n    const overrideStyle = isPrimitive\n      ? { paddingLeft: 0, borderLeft: 'none' }\n      : { paddingLeft: indentWidth * singleIndent };\n    return (\n      <div\n        {...Theme(theme, 'objectKeyVal', overrideStyle)}\n        className=\"variable-row\"\n        key={variable.name}\n      >\n        {this.renderKey()}\n        <div\n          className=\"variable-value\"\n          onClick={\n            onSelect === false && onEdit === false\n              ? null\n              : e => {\n                  let location = [...namespace];\n                  if ((e.ctrlKey || e.metaKey) && onEdit !== false) {\n                    this.prepopInput(variable);\n                  } else if (onSelect !== false) {\n                    location.shift();\n                    onSelect({\n                      ...variable,\n                      namespace: location,\n                    });\n                  }\n                }\n          }\n          {...Theme(theme, 'variableValue', {\n            cursor: onSelect === false ? 'default' : 'pointer',\n          })}\n        >\n          {this.getValue(variable, editMode)}\n        </div>\n        {onEdit !== false && editMode === false ? this.getEditIcon() : null}\n        {onDelete !== false && editMode === false ? this.getRemoveIcon() : null}\n      </div>\n    );\n  }\n\n  getEditIcon = () => {\n    const { variable, theme } = this.props;\n\n    return (\n      <span className=\"click-to-edit\" style={{ verticalAlign: 'middle' }}>\n        <Edit\n          className=\"click-to-edit-icon\"\n          {...Theme(theme, 'editVarIcon')}\n          onClick={() => {\n            this.prepopInput(variable);\n          }}\n        />\n      </span>\n    );\n  };\n\n  prepopInput = variable => {\n    if (this.props.onEdit !== false) {\n      const stringifiedValue = stringifyVariable(variable.value);\n      const detected = parseInput(stringifiedValue);\n      this.setState({\n        editMode: true,\n        editValue: stringifiedValue,\n        parsedInput: {\n          type: detected.type,\n          value: detected.value,\n        },\n      });\n    }\n  };\n\n  getRemoveIcon = () => {\n    const { variable, namespace, theme, rjvId } = this.props;\n\n    return (\n      <div className=\"click-to-remove\" style={{ verticalAlign: 'top' }}>\n        <Remove\n          className=\"click-to-remove-icon\"\n          {...Theme(theme, 'removeVarIcon')}\n          onClick={() => {\n            dispatcher.dispatch({\n              name: 'VARIABLE_REMOVED',\n              rjvId: rjvId,\n              data: {\n                name: variable.name,\n                namespace: namespace,\n                existing_value: variable.value,\n                variable_removed: true,\n              },\n            });\n          }}\n        />\n      </div>\n    );\n  };\n\n  getValue = (variable, editMode) => {\n    const type = editMode ? false : variable.type;\n    const { props } = this;\n    switch (type) {\n      case false:\n        return this.getEditInput();\n      case 'string':\n        return <JsonString value={variable.value} {...props} />;\n      case 'integer':\n        return <JsonInteger value={variable.value} {...props} />;\n      case 'float':\n        return <JsonFloat value={variable.value} {...props} />;\n      case 'boolean':\n        return <JsonBoolean value={variable.value} {...props} />;\n      case 'function':\n        return <JsonFunction value={variable.value} {...props} />;\n      case 'null':\n        return <JsonNull {...props} />;\n      case 'nan':\n        return <JsonNan {...props} />;\n      case 'undefined':\n        return <JsonUndefined {...props} />;\n      case 'date':\n        return <JsonDate value={variable.value} {...props} />;\n      case 'regexp':\n        return <JsonRegexp value={variable.value} {...props} />;\n      default:\n        // catch-all for types that weren't anticipated\n        return <div className=\"object-value\">{JSON.stringify(variable.value)}</div>;\n    }\n  };\n\n  getEditInput = () => {\n    const { theme } = this.props;\n    const { editValue } = this.state;\n\n    return (\n      <div style={{ display: 'flex', alignItems: 'center', width: '100%' }}>\n        <AutosizeTextarea\n          type=\"text\"\n          inputRef={input => input && input.focus()}\n          value={editValue}\n          className=\"variable-editor\"\n          onChange={event => {\n            const value = event.target.value;\n            const detected = parseInput(value);\n            this.setState({\n              editValue: value,\n              parsedInput: {\n                type: detected.type,\n                value: detected.value,\n              },\n            });\n          }}\n          onKeyDown={e => {\n            switch (e.key) {\n              case 'Escape': {\n                this.setState({\n                  editMode: false,\n                  editValue: '',\n                });\n                break;\n              }\n              case 'Enter': {\n                if (e.ctrlKey || e.metaKey) {\n                  this.submitEdit(true);\n                }\n                break;\n              }\n            }\n            e.stopPropagation();\n          }}\n          placeholder=\"edit...\"\n          {...Theme(theme, 'edit-input')}\n        />\n        <div {...Theme(theme, 'edit-icon-container')}>\n          <div>\n            <Remove\n              className=\"edit-cancel\"\n              {...Theme(theme, 'cancel-icon')}\n              onClick={() => {\n                this.setState({ editMode: false, editValue: '' });\n              }}\n            />\n          </div>\n          <div>\n            <CheckCircle\n              className=\"edit-check string-value\"\n              {...Theme(theme, 'check-icon')}\n              onClick={() => this.submitEdit(true)}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  submitEdit = submit_detected => {\n    const { variable, namespace, rjvId } = this.props;\n    const { editValue, parsedInput } = this.state;\n    let new_value = editValue;\n    if (submit_detected && parsedInput.type) {\n      new_value = parsedInput.value;\n    }\n    this.setState({\n      editMode: false,\n    });\n    dispatcher.dispatch({\n      name: 'VARIABLE_UPDATED',\n      rjvId: rjvId,\n      data: {\n        name: variable.name,\n        namespace: namespace,\n        existing_value: variable.value,\n        new_value: new_value,\n        variable_removed: false,\n      },\n    });\n  };\n\n  getDetectedInput = () => {\n    const { parsedInput } = this.state;\n    const { type, value } = parsedInput;\n    const { props } = this;\n    const { theme } = props;\n\n    if (type !== false) {\n      switch (type.toLowerCase()) {\n        case 'object':\n          return (\n            <span>\n              <span\n                style={{\n                  ...Theme(theme, 'brace').style,\n                  cursor: 'default',\n                }}\n              >\n                {'{'}\n              </span>\n              <span\n                style={{\n                  ...Theme(theme, 'ellipsis').style,\n                  cursor: 'default',\n                }}\n              >\n                ...\n              </span>\n              <span\n                style={{\n                  ...Theme(theme, 'brace').style,\n                  cursor: 'default',\n                }}\n              >\n                {'}'}\n              </span>\n            </span>\n          );\n        case 'array':\n          return (\n            <span>\n              <span\n                style={{\n                  ...Theme(theme, 'brace').style,\n                  cursor: 'default',\n                }}\n              >\n                {'['}\n              </span>\n              <span\n                style={{\n                  ...Theme(theme, 'ellipsis').style,\n                  cursor: 'default',\n                }}\n              >\n                ...\n              </span>\n              <span\n                style={{\n                  ...Theme(theme, 'brace').style,\n                  cursor: 'default',\n                }}\n              >\n                {']'}\n              </span>\n            </span>\n          );\n        case 'string':\n          return <JsonString value={value} {...props} />;\n        case 'integer':\n          return <JsonInteger value={value} {...props} />;\n        case 'float':\n          return <JsonFloat value={value} {...props} />;\n        case 'boolean':\n          return <JsonBoolean value={value} {...props} />;\n        case 'function':\n          return <JsonFunction value={value} {...props} />;\n        case 'null':\n          return <JsonNull {...props} />;\n        case 'nan':\n          return <JsonNan {...props} />;\n        case 'undefined':\n          return <JsonUndefined {...props} />;\n        case 'date':\n          return <JsonDate value={new Date(value)} {...props} />;\n      }\n    }\n  };\n}\n\nexport default HotkeysTarget(VariableEditor);\n","/* eslint-disable */\nimport React from 'react';\n\nimport { toType } from './../helpers/util';\n\n//clibboard icon\nimport { Clippy } from './icons';\n\n//theme\nimport Theme from './../themes/getStyle';\n\nexport default class extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      copied: false,\n    };\n  }\n\n  copiedTimer = null;\n\n  componentWillUnmount() {\n    if (this.copiedTimer) {\n      clearTimeout(this.copiedTimer);\n      this.copiedTimer = null;\n    }\n  }\n\n  handleCopy = () => {\n    const container = document.createElement('textarea');\n    const { clickCallback, src, namespace } = this.props;\n\n    container.innerHTML = JSON.stringify(this.clipboardValue(src), null, '  ');\n\n    document.body.appendChild(container);\n    container.select();\n    document.execCommand('copy');\n\n    document.body.removeChild(container);\n\n    this.copiedTimer = setTimeout(() => {\n      this.setState({\n        copied: false,\n      });\n    }, 5500);\n\n    this.setState({ copied: true }, () => {\n      if (typeof clickCallback !== 'function') {\n        return;\n      }\n\n      clickCallback({\n        src: src,\n        namespace: namespace,\n        name: namespace[namespace.length - 1],\n      });\n    });\n  };\n\n  getClippyIcon = () => {\n    const { theme } = this.props;\n\n    if (this.state.copied) {\n      return (\n        <span>\n          <Clippy className=\"copy-icon\" {...Theme(theme, 'copy-icon')} />\n          <span {...Theme(theme, 'copy-icon-copied')}>✔</span>\n        </span>\n      );\n    }\n\n    return <Clippy className=\"copy-icon\" {...Theme(theme, 'copy-icon')} />;\n  };\n\n  clipboardValue = value => {\n    const type = toType(value);\n    switch (type) {\n      case 'function':\n      case 'regexp':\n        return value.toString();\n      default:\n        return value;\n    }\n  };\n\n  render() {\n    const { src, theme, hidden } = this.props;\n    let style = Theme(theme, 'copy-to-clipboard').style;\n    let display = 'inline';\n\n    if (hidden) {\n      display = 'none';\n    }\n\n    return (\n      <span className=\"copy-to-clipboard-container\" title=\"Copy to clipboard\">\n        <span\n          style={{\n            ...style,\n            display: display,\n          }}\n          onClick={this.handleCopy}\n        >\n          {this.getClippyIcon()}\n        </span>\n      </span>\n    );\n  }\n}\n","/* eslint-disable */\nimport React from 'react';\nimport dispatcher from './../helpers/dispatcher';\n\nimport CopyToClipboard from './CopyToClipboard';\nimport { toType } from './../helpers/util';\n\n//icons\nimport { RemoveCircle as Remove, AddCircle as Add } from './icons';\n\n//theme\nimport Theme from './../themes/getStyle';\n\nexport default class extends React.PureComponent {\n  getObjectSize = () => {\n    const { size, theme, displayObjectSize } = this.props;\n    if (displayObjectSize) {\n      return (\n        <span className=\"object-size\" {...Theme(theme, 'object-size')}>\n          {size} item\n          {size === 1 ? '' : 's'}\n        </span>\n      );\n    }\n  };\n\n  getAddAttribute = () => {\n    const { theme, namespace, name, src, rjvId, depth } = this.props;\n\n    return (\n      <span className=\"click-to-add\" style={{ verticalAlign: 'top' }}>\n        <Add\n          className=\"click-to-add-icon\"\n          {...Theme(theme, 'addVarIcon')}\n          onClick={() => {\n            const request = {\n              name: depth > 0 ? name : null,\n              namespace: namespace.splice(0, namespace.length - 1),\n              existing_value: src,\n              variable_removed: false,\n              key_name: null,\n            };\n            if (toType(src) === 'object') {\n              dispatcher.dispatch({\n                name: 'ADD_VARIABLE_KEY_REQUEST',\n                rjvId: rjvId,\n                data: request,\n              });\n            } else {\n              dispatcher.dispatch({\n                name: 'VARIABLE_ADDED',\n                rjvId: rjvId,\n                data: {\n                  ...request,\n                  new_value: [...src, null],\n                },\n              });\n            }\n          }}\n        />\n      </span>\n    );\n  };\n\n  getRemoveObject = () => {\n    const { theme, hover, namespace, name, src, rjvId } = this.props;\n\n    //don't allow deleting of root node\n    if (namespace.length === 1) {\n      return;\n    }\n    return (\n      <span className=\"click-to-remove\">\n        <Remove\n          className=\"click-to-remove-icon\"\n          {...Theme(theme, 'removeVarIcon')}\n          onClick={() => {\n            dispatcher.dispatch({\n              name: 'VARIABLE_REMOVED',\n              rjvId: rjvId,\n              data: {\n                name: name,\n                namespace: namespace.splice(0, namespace.length - 1),\n                existing_value: src,\n                variable_removed: true,\n              },\n            });\n          }}\n        />\n      </span>\n    );\n  };\n\n  render = () => {\n    const { theme, onDelete, onAdd, enableClipboard, src, namespace } = this.props;\n    return (\n      <div\n        {...Theme(theme, 'object-meta-data')}\n        className=\"object-meta-data\"\n        onClick={e => {\n          e.stopPropagation();\n        }}\n      >\n        {/* size badge display */}\n        {this.getObjectSize()}\n        {/* copy to clipboard icon */}\n        {enableClipboard ? (\n          <CopyToClipboard clickCallback={enableClipboard} {...{ src, theme, namespace }} />\n        ) : null}\n        {/* copy add/remove icons */}\n        {onAdd !== false ? this.getAddAttribute() : null}\n        {onDelete !== false ? this.getRemoveObject() : null}\n      </div>\n    );\n  };\n}\n","/* eslint-disable */\nimport React from 'react';\nimport Theme from './../themes/getStyle';\n\nexport default function getObjectName(props) {\n  const { parent_type, namespace, theme, jsvRoot, name } = props;\n\n  const display_name = props.name ? props.name : '';\n\n  if (jsvRoot && (name === false || name === null)) {\n    return <span />;\n  } else if (parent_type == 'array') {\n    return (\n      <span {...Theme(theme, 'array-key')} key={namespace}>\n        <span className=\"array-key\">{display_name}</span>\n        <span {...Theme(theme, 'colon')}>:</span>\n      </span>\n    );\n  } else {\n    return (\n      <span {...Theme(theme, 'object-name')} key={namespace}>\n        <span className=\"object-key\">\n          <span>{display_name}</span>\n        </span>\n        <span {...Theme(theme, 'colon')}>:</span>\n      </span>\n    );\n  }\n}\n","import React from 'react';\nimport Theme from './../themes/getStyle';\n\nimport { CircleMinus, CirclePlus, SquareMinus, SquarePlus, ArrowRight, ArrowDown } from './icons';\n\nexport function ExpandedIcon(props) {\n  const { theme, iconStyle } = props;\n  switch (iconStyle) {\n    case 'triangle':\n      return <ArrowDown {...Theme(theme, 'expanded-icon')} className=\"expanded-icon\" />;\n    case 'square':\n      return <SquareMinus {...Theme(theme, 'expanded-icon')} className=\"expanded-icon\" />;\n    default:\n      return <CircleMinus {...Theme(theme, 'expanded-icon')} className=\"expanded-icon\" />;\n  }\n}\n\nexport function CollapsedIcon(props) {\n  const { theme, iconStyle } = props;\n  switch (iconStyle) {\n    case 'triangle':\n      return <ArrowRight {...Theme(theme, 'collapsed-icon')} className=\"collapsed-icon\" />;\n    case 'square':\n      return <SquarePlus {...Theme(theme, 'collapsed-icon')} className=\"collapsed-icon\" />;\n    default:\n      return <CirclePlus {...Theme(theme, 'collapsed-icon')} className=\"collapsed-icon\" />;\n  }\n}\n","/* eslint-disable */\nimport React from 'react';\nimport Theme from './../themes/getStyle';\n\nimport VariableMeta from './VariableMeta';\nimport ObjectName from './ObjectName';\nimport ObjectComponent from './DataTypes/Object';\n\n//icons\nimport { CollapsedIcon, ExpandedIcon } from './ToggleIcons';\n\n//single indent is 5px\nconst SINGLE_INDENT = 5;\n\nexport default class extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      expanded: [],\n    };\n  }\n\n  toggleCollapsed = i => {\n    const newExpanded = [];\n    for (const j in this.state.expanded) {\n      newExpanded.push(this.state.expanded[j]);\n    }\n    newExpanded[i] = !newExpanded[i];\n    this.setState({\n      expanded: newExpanded,\n    });\n  };\n\n  getExpandedIcon(i) {\n    const { theme, iconStyle } = this.props;\n\n    if (this.state.expanded[i]) {\n      return <ExpandedIcon {...{ theme, iconStyle }} />;\n    }\n\n    return <CollapsedIcon {...{ theme, iconStyle }} />;\n  }\n\n  render() {\n    const {\n      src,\n      groupArraysAfterLength,\n      depth,\n      name,\n      theme,\n      jsvRoot,\n      namespace,\n      parent_type,\n      ...rest\n    } = this.props;\n\n    let expanded_icon,\n      object_padding_left = 0;\n\n    const array_group_padding_left = this.props.indentWidth * SINGLE_INDENT;\n\n    if (!jsvRoot) {\n      object_padding_left = this.props.indentWidth * SINGLE_INDENT;\n    }\n\n    const size = groupArraysAfterLength;\n    const groups = Math.ceil(src.length / size);\n\n    return (\n      <div\n        className=\"object-key-val\"\n        {...Theme(theme, jsvRoot ? 'jsv-root' : 'objectKeyVal', {\n          paddingLeft: object_padding_left,\n        })}>\n        <ObjectName {...this.props} />\n\n        <span>\n          <VariableMeta size={src.length} {...this.props} />\n        </span>\n        {[...Array(groups)].map((_, i) => (\n          <div\n            key={i}\n            className=\"object-key-val array-group\"\n            {...Theme(theme, 'objectKeyVal', {\n              marginLeft: 6,\n              paddingLeft: array_group_padding_left,\n            })}>\n            <span {...Theme(theme, 'brace-row')}>\n              <div\n                className=\"icon-container\"\n                {...Theme(theme, 'icon-container')}\n                onClick={e => {\n                  this.toggleCollapsed(i);\n                }}>\n                {this.getExpandedIcon(i)}\n              </div>\n              {this.state.expanded[i] ? (\n                <ObjectComponent\n                  key={name + i}\n                  depth={0}\n                  name={false}\n                  collapsed={false}\n                  groupArraysAfterLength={size}\n                  index_offset={i * size}\n                  src={src.slice(i * size, i * size + size)}\n                  namespace={namespace}\n                  type=\"array\"\n                  parent_type=\"array_group\"\n                  theme={theme}\n                  {...rest}\n                />\n              ) : (\n                <span\n                  {...Theme(theme, 'brace')}\n                  onClick={e => {\n                    this.toggleCollapsed(i);\n                  }}\n                  className=\"array-group-brace\">\n                  [\n                  <div {...Theme(theme, 'array-group-meta-data')} className=\"array-group-meta-data\">\n                    <span className=\"object-size\" {...Theme(theme, 'object-size')}>\n                      {i * size}\n                      {' - '}\n                      {i * size + size > src.length ? src.length : i * size + size}\n                    </span>\n                  </div>\n                  ]\n                </span>\n              )}\n            </span>\n          </div>\n        ))}\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { polyfill } from 'react-lifecycles-compat';\nimport { toType } from './../../helpers/util';\n//data type components\nimport { JsonObject } from './DataTypes';\n\nimport VariableEditor from './../VariableEditor';\nimport VariableMeta from './../VariableMeta';\nimport ArrayGroup from './../ArrayGroup';\nimport ObjectName from './../ObjectName';\n//attribute store\n//icons\nimport { CollapsedIcon, ExpandedIcon } from './../ToggleIcons';\n//theme\nimport Theme from './../../themes/getStyle';\nimport AttributeStore from 'vendor/JsonTree/js/stores/ObjectAttributes';\n\n//increment 1 with each nested object & array\nconst DEPTH_INCREMENT = 1;\n//single indent is 5px\nconst SINGLE_INDENT = 5;\n\nclass RjvObject extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    const state = RjvObject.getState(props);\n    this.state = {\n      ...state,\n      prevProps: {},\n    };\n  }\n\n  static getState = props => {\n    const size = Object.keys(props.src).length;\n    const expanded =\n      size < 5 &&\n      (props.collapsed === false || (props.collapsed !== true && props.collapsed > props.depth)) &&\n      (!props.shouldCollapse ||\n        props.shouldCollapse({\n          name: props.name,\n          src: props.src,\n          type: toType(props.src),\n          namespace: props.namespace,\n        }) === false) &&\n      //initialize closed if object has no items\n      size !== 0;\n    return {\n      expanded: AttributeStore.get(props.rjvId, props.namespace, 'expanded', expanded),\n      object_type: props.type === 'array' ? 'array' : 'object',\n      parent_type: props.type === 'array' ? 'array' : 'object',\n      size,\n    };\n  };\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    const { prevProps } = prevState;\n    if (\n      nextProps.src !== prevProps.src ||\n      nextProps.collapsed !== prevProps.collapsed ||\n      nextProps.name !== prevProps.name ||\n      nextProps.namespace !== prevProps.namespace ||\n      nextProps.rjvId !== prevProps.rjvId\n    ) {\n      const newState = RjvObject.getState(nextProps);\n      return {\n        ...newState,\n        prevProps: nextProps,\n      };\n    }\n    return null;\n  }\n\n  toggleCollapsed = () => {\n    this.setState(\n      {\n        expanded: !this.state.expanded,\n      },\n      () => {\n        AttributeStore.set(this.props.rjvId, this.props.namespace, 'expanded', this.state.expanded);\n      }\n    );\n  };\n\n  getObjectContent = (depth, src, props) => {\n    const overrideStyle = props.isPrimitive ? { marginLeft: 0 } : {};\n    return (\n      <div className=\"pushed-content object-container\">\n        <div\n          className=\"object-content\"\n          {...Theme(this.props.theme, 'pushed-content', overrideStyle)}>\n          {this.renderObjectContents(src, props)}\n        </div>\n      </div>\n    );\n  };\n\n  getEllipsis = () => {\n    const { size } = this.state;\n\n    if (size === 0) {\n      return null;\n    } else {\n      return (\n        <div\n          {...Theme(this.props.theme, 'ellipsis')}\n          className=\"node-ellipsis\"\n          onClick={this.toggleCollapsed}>\n          ...\n        </div>\n      );\n    }\n  };\n\n  getObjectMetaData = () => {\n    const { size } = this.state;\n    return <VariableMeta size={size} {...this.props} />;\n  };\n\n  getBraceStart(object_type, expanded) {\n    const { attrType, theme, iconStyle, parent_type } = this.props;\n\n    if (parent_type === 'array_group') {\n      return (\n        <span>\n          <span {...Theme(theme, 'brace')}>{object_type === 'array' ? '[' : '{'}</span>\n          {expanded ? this.getObjectMetaData() : null}\n        </span>\n      );\n    }\n\n    if (attrType.type === 'primitive') {\n      return null;\n    }\n    const IconComponent = expanded ? ExpandedIcon : CollapsedIcon;\n\n    return (\n      <span>\n        <span onClick={this.toggleCollapsed} {...Theme(theme, 'brace-row')}>\n          <div className=\"icon-container\" {...Theme(theme, 'icon-container')}>\n            <IconComponent {...{ theme, iconStyle }} />\n          </div>\n          <ObjectName {...this.props} />\n          <span {...Theme(theme, 'brace')}>{object_type === 'array' ? '[' : '{'}</span>\n        </span>\n        {expanded ? this.getObjectMetaData() : null}\n      </span>\n    );\n  }\n\n  getBraceEnd = () => {\n    const { theme, attrType } = this.props;\n    const { object_type, expanded } = this.state;\n    if (attrType.type === 'primitive') {\n      return null;\n    }\n    return (\n      <span className=\"brace-row\">\n        <span\n          style={{\n            ...Theme(theme, 'brace').style,\n            paddingLeft: expanded ? '3px' : '0px',\n          }}>\n          {object_type === 'array' ? ']' : '}'}\n        </span>\n        {expanded ? null : this.getObjectMetaData()}\n      </span>\n    );\n  };\n\n  render() {\n    const {\n      depth,\n      src,\n      namespace,\n      name,\n      type,\n      parent_type,\n      theme,\n      jsvRoot,\n      iconStyle,\n      ...rest\n    } = this.props;\n\n    const { object_type, expanded } = this.state;\n\n    let styles = {};\n    if (!jsvRoot && parent_type !== 'array_group') {\n      styles.paddingLeft = this.props.indentWidth * SINGLE_INDENT;\n    } else if (parent_type === 'array_group') {\n      styles.borderLeft = 0;\n      styles.display = 'inline';\n    }\n\n    return (\n      <div\n        className=\"object-key-val\"\n        {...Theme(theme, jsvRoot ? 'jsv-root' : 'objectKeyVal', styles)}>\n        {this.getBraceStart(object_type, expanded)}\n        {expanded\n          ? this.getObjectContent(depth, src, {\n              theme,\n              iconStyle,\n              ...rest,\n            })\n          : this.getEllipsis()}\n        {this.getBraceEnd()}\n      </div>\n    );\n  }\n\n  renderObjectContents = (variables, props) => {\n    const {\n      depth,\n      parent_type,\n      index_offset,\n      groupArraysAfterLength,\n      namespace,\n      rejectMatching,\n    } = this.props;\n    const { object_type } = this.state;\n    let elements = [],\n      variable;\n    let keys = Object.keys(variables || {});\n    if (this.props.sortKeys) {\n      keys = keys.sort();\n    }\n    keys.forEach((name, i) => {\n      variable = new JsonVariable(name, variables[name]);\n      if (parent_type === 'array_group' && index_offset) {\n        variable.name = parseInt(variable.name) + index_offset;\n      }\n      if (!variables.hasOwnProperty(name)) {\n        return null;\n      } else if (rejectMatching && name.match(rejectMatching)) {\n        return null;\n      } else if (variable.type === 'object') {\n        elements.push(\n          <JsonObject\n            key={variable.name}\n            depth={depth + DEPTH_INCREMENT}\n            name={variable.name}\n            src={variable.value}\n            namespace={namespace.concat(variable.name)}\n            parent_type={object_type}\n            {...props}\n            editOnHotkey={false}\n          />\n        );\n      } else if (variable.type === 'array') {\n        let ObjectComponent = JsonObject;\n        if (groupArraysAfterLength && variable.value.length > groupArraysAfterLength) {\n          ObjectComponent = ArrayGroup;\n        }\n        elements.push(\n          <ObjectComponent\n            key={variable.name}\n            depth={depth + DEPTH_INCREMENT}\n            name={variable.name}\n            src={variable.value}\n            namespace={namespace.concat(variable.name)}\n            type=\"array\"\n            parent_type={object_type}\n            editOnHotkey={false}\n            {...props}\n          />\n        );\n      } else {\n        elements.push(\n          <VariableEditor\n            key={variable.name + '_' + namespace}\n            variable={variable}\n            singleIndent={SINGLE_INDENT}\n            namespace={namespace}\n            type={this.props.type}\n            {...props}\n          />\n        );\n      }\n    });\n    return elements;\n  };\n}\n\n//just store name, value and type with a variable\nclass JsonVariable {\n  constructor(name, value) {\n    this.name = name;\n    this.value = value;\n    this.type = toType(value);\n  }\n}\n\npolyfill(RjvObject);\n\n//export component\nexport default RjvObject;\n","import React from 'react';\nimport JsonObject from './DataTypes/Object';\nimport ArrayGroup from './ArrayGroup';\n\nexport default class extends React.PureComponent {\n  render = () => {\n    const { props } = this;\n    const namespace = [props.name];\n    let ObjectComponent = JsonObject;\n\n    if (props.groupArraysAfterLength && props.src.length > props.groupArraysAfterLength) {\n      ObjectComponent = ArrayGroup;\n    }\n\n    return (\n      <div className=\"pretty-json-container object-container\">\n        <div className=\"object-content\">\n          <ObjectComponent namespace={namespace} depth={0} jsvRoot={true} {...props} />\n        </div>\n      </div>\n    );\n  };\n}\n","import React from 'react';\nimport dispatcher from './../../helpers/dispatcher';\n\nimport { CheckCircle, Add as Cancel } from './../icons';\n\n//global theme\nimport Theme from './../../themes/getStyle';\n\n//this input appears when adding a new value to an object\nexport default class extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      input: props.input ? props.input : '',\n    };\n  }\n\n  render() {\n    const { theme, rjvId, isValid } = this.props;\n    const { input } = this.state;\n\n    const valid = isValid(input);\n\n    return (\n      <div\n        className=\"key-modal-request\"\n        {...Theme(theme, 'key-modal-request')}\n        onClick={this.closeModal}>\n        <div\n          {...Theme(theme, 'key-modal')}\n          onClick={e => {\n            e.stopPropagation();\n          }}>\n          <div {...Theme(theme, 'key-modal-label')}>Key Name:</div>\n          <div style={{ position: 'relative' }}>\n            <input\n              {...Theme(theme, 'key-modal-input')}\n              className=\"key-modal-input\"\n              ref={el => el && el.focus()}\n              spellCheck={false}\n              value={input}\n              placeholder=\"...\"\n              onChange={e => {\n                this.setState({\n                  input: e.target.value,\n                });\n              }}\n              onKeyPress={e => {\n                if (valid && e.key === 'Enter') {\n                  this.submit();\n                } else if (e.key === 'Escape') {\n                  this.closeModal();\n                }\n              }}\n            />\n            {valid ? (\n              <CheckCircle\n                {...Theme(theme, 'key-modal-submit')}\n                className=\"key-modal-submit\"\n                onClick={e => this.submit()}\n              />\n            ) : null}\n          </div>\n          <span {...Theme(theme, 'key-modal-cancel')}>\n            <Cancel\n              {...Theme(theme, 'key-modal-cancel-icon')}\n              className=\"key-modal-cancel\"\n              onClick={() => {\n                dispatcher.dispatch({\n                  rjvId: rjvId,\n                  name: 'RESET',\n                });\n              }}\n            />\n          </span>\n        </div>\n      </div>\n    );\n  }\n\n  closeModal = () => {\n    dispatcher.dispatch({\n      rjvId: this.props.rjvId,\n      name: 'RESET',\n    });\n  };\n\n  submit = () => {\n    this.props.submit(this.state.input);\n  };\n}\n","/* eslint-disable */\nimport React from 'react';\nimport dispatcher from './../../helpers/dispatcher';\nimport ObjectAttributes from './../../stores/ObjectAttributes';\nimport ObjectKeyModal from './ObjectKeyModal';\n\n//global theme\nimport Theme from './../../themes/getStyle';\n\n//this input appears when adding a new value to an object\nexport default class extends React.PureComponent {\n  render() {\n    const { active, theme, rjvId } = this.props;\n\n    return active ? (\n      <ObjectKeyModal rjvId={rjvId} theme={theme} isValid={this.isValid} submit={this.submit} />\n    ) : null;\n  }\n\n  isValid = input => {\n    const { rjvId } = this.props;\n    const request = ObjectAttributes.get(rjvId, 'action', 'new-key-request');\n    return input != '' && Object.keys(request.existing_value).indexOf(input) === -1;\n  };\n\n  submit = input => {\n    const { rjvId } = this.props;\n    let request = ObjectAttributes.get(rjvId, 'action', 'new-key-request');\n    request.new_value = { ...request.existing_value };\n    request.new_value[input] = this.props.defaultValue;\n    dispatcher.dispatch({\n      name: 'VARIABLE_ADDED',\n      rjvId: rjvId,\n      data: request,\n    });\n  };\n}\n","/* eslint-disable */\nimport React from 'react';\nimport dispatcher from './../helpers/dispatcher';\nimport ObjectAttributes from './../stores/ObjectAttributes';\n\nimport { Add as Clear } from './icons';\n\n//global theme\nimport Theme from './../themes/getStyle';\n\n//this input appears when adding a new value to an object\nexport default class extends React.PureComponent {\n  render() {\n    const { message, active, theme, rjvId } = this.props;\n\n    return active ? (\n      <div\n        className=\"validation-failure\"\n        {...Theme(theme, 'validation-failure')}\n        onClick={() => {\n          dispatcher.dispatch({\n            rjvId: rjvId,\n            name: 'RESET',\n          });\n        }}\n      >\n        <span {...Theme(theme, 'validation-failure-label')}>{message}</span>\n        <Clear {...Theme(theme, 'validation-failure-clear')} />\n      </div>\n    ) : null;\n  }\n}\n","/* eslint-disable */\nimport React from 'react';\nimport { polyfill } from 'react-lifecycles-compat';\nimport JsonViewer from './components/JsonViewer';\nimport AddKeyRequest from './components/ObjectKeyModal/AddKeyRequest';\nimport ValidationFailure from './components/ValidationFailure';\nimport { toType, isTheme } from './helpers/util';\nimport ObjectAttributes from './stores/ObjectAttributes';\n\n//global theme\nimport Theme from './themes/getStyle';\n\n//forward src through to JsonObject component\nclass ReactJsonView extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      //listen to request to add/edit a key to an object\n      addKeyRequest: false,\n      editKeyRequest: false,\n      validationFailure: false,\n      src: ReactJsonView.defaultProps.src,\n      name: ReactJsonView.defaultProps.name,\n      theme: ReactJsonView.defaultProps.theme,\n      validationMessage: ReactJsonView.defaultProps.validationMessage,\n      // the state object also needs to remember the prev prop values, because we need to compare\n      // old and new props in getDerivedStateFromProps().\n      prevSrc: ReactJsonView.defaultProps.src,\n      prevName: ReactJsonView.defaultProps.name,\n      prevTheme: ReactJsonView.defaultProps.theme,\n    };\n  }\n\n  //reference id for this instance\n  rjvId = Date.now().toString();\n\n  //all acceptable props and default values\n  static defaultProps = {\n    src: {},\n    name: 'root',\n    theme: 'rjv-default',\n    collapsed: false,\n    collapseStringsAfterLength: false,\n    shouldCollapse: false,\n    sortKeys: false,\n    groupArraysAfterLength: 100,\n    indentWidth: 4,\n    enableClipboard: true,\n    displayObjectSize: true,\n    displayDataTypes: true,\n    onEdit: false,\n    onDelete: false,\n    onAdd: false,\n    onSelect: false,\n    iconStyle: 'triangle',\n    style: {},\n    validationMessage: 'Validation Error',\n    defaultValue: null,\n    rejectMatching: null,\n  };\n\n  // will trigger whenever setState() is called, or parent passes in new props.\n  static getDerivedStateFromProps(nextProps, prevState) {\n    if (\n      nextProps.src !== prevState.prevSrc ||\n      nextProps.name !== prevState.prevName ||\n      nextProps.theme !== prevState.prevTheme\n    ) {\n      // if we pass in new props, we re-validate\n      const newPartialState = {\n        src: nextProps.src,\n        name: nextProps.name,\n        theme: nextProps.theme,\n        validationMessage: nextProps.validationMessage,\n        prevSrc: nextProps.src,\n        prevName: nextProps.name,\n        prevTheme: nextProps.theme,\n      };\n      return ReactJsonView.validateState(newPartialState);\n    }\n    return null;\n  }\n\n  componentDidMount() {\n    // initialize\n    ObjectAttributes.set(this.rjvId, 'global', 'src', this.state.src);\n    // bind to events\n    const listeners = this.getListeners();\n    for (const i in listeners) {\n      ObjectAttributes.on(i + '-' + this.rjvId, listeners[i]);\n    }\n    //reset key request to false once it's observed\n    this.setState({\n      addKeyRequest: false,\n      editKeyRequest: false,\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    //reset key request to false once it's observed\n    if (prevState.addKeyRequest !== false) {\n      this.setState({\n        addKeyRequest: false,\n      });\n    }\n    if (prevState.editKeyRequest !== false) {\n      this.setState({\n        editKeyRequest: false,\n      });\n    }\n    if (prevProps.src !== this.state.src) {\n      ObjectAttributes.set(this.rjvId, 'global', 'src', this.state.src);\n    }\n  }\n\n  componentWillUnmount() {\n    const listeners = this.getListeners();\n    for (const i in listeners) {\n      ObjectAttributes.removeListener(i + '-' + this.rjvId, listeners[i]);\n    }\n  }\n\n  getListeners = () => {\n    return {\n      reset: this.resetState,\n      'variable-update': this.updateSrc,\n      'add-key-request': this.addKeyRequest,\n    };\n  };\n\n  static validateState = state => {\n    const validatedState = {};\n    //make sure theme is valid\n    if (toType(state.theme) === 'object' && !isTheme(state.theme)) {\n      console.error(\n        'react-json-view error:',\n        'theme prop must be a theme name or valid base-16 theme object.',\n        'defaulting to \"rjv-default\" theme'\n      );\n      validatedState.theme = 'rjv-default';\n    }\n    const type = toType(state.src);\n    if (type !== 'object' && type !== 'array') {\n      console.error(`json tree: src should be json but is ${type}`, state.src);\n      validatedState.name = 'ERROR';\n      validatedState.src = {\n        message: `${type} is not an object`,\n        src: state.src,\n      };\n    }\n    return {\n      // get the original state\n      ...state,\n      // override the original state\n      ...validatedState,\n    };\n  };\n\n  render() {\n    const { validationFailure, validationMessage, addKeyRequest, theme, src, name } = this.state;\n\n    const { style, defaultValue } = this.props;\n\n    return (\n      <div className=\"react-json-view\" style={{ ...Theme(theme, 'app-container').style, ...style }}>\n        <ValidationFailure\n          message={validationMessage}\n          active={validationFailure}\n          theme={theme}\n          rjvId={this.rjvId}\n        />\n        <JsonViewer\n          {...this.props}\n          src={src}\n          name={name}\n          theme={theme}\n          type={toType(src)}\n          rjvId={this.rjvId}\n        />\n        <AddKeyRequest\n          active={addKeyRequest}\n          theme={theme}\n          rjvId={this.rjvId}\n          defaultValue={defaultValue}\n        />\n      </div>\n    );\n  }\n\n  updateSrc = () => {\n    const {\n      name,\n      namespace,\n      new_value,\n      existing_value,\n      variable_removed,\n      updated_src,\n      type,\n    } = ObjectAttributes.get(this.rjvId, 'action', 'variable-update');\n    const { onEdit, onDelete, onAdd } = this.props;\n\n    const { src } = this.state;\n\n    let result;\n\n    const on_edit_payload = {\n      existing_src: src,\n      new_value: new_value,\n      updated_src: updated_src,\n      name: name,\n      namespace: namespace,\n      existing_value: existing_value,\n    };\n\n    switch (type) {\n      case 'variable-added':\n        result = onAdd(on_edit_payload);\n        break;\n      case 'variable-edited':\n        result = onEdit(on_edit_payload);\n        break;\n      case 'variable-removed':\n        result = onDelete(on_edit_payload);\n        break;\n    }\n\n    if (result !== false) {\n      ObjectAttributes.set(this.rjvId, 'global', 'src', updated_src);\n      this.setState({\n        src: updated_src,\n      });\n    } else {\n      this.setState({\n        validationFailure: true,\n      });\n    }\n  };\n\n  addKeyRequest = () => {\n    this.setState({\n      addKeyRequest: true,\n    });\n  };\n\n  resetState = () => {\n    this.setState({\n      validationFailure: false,\n      addKeyRequest: false,\n    });\n  };\n}\n\npolyfill(ReactJsonView);\n\nexport default ReactJsonView;\n","// @flow\n\nimport React, { type Node } from 'react';\n\nimport { Popover, PopoverInteractionKind } from '@blueprintjs/core';\n\ntype P = {\n  anchor: Node,\n  content: Node,\n  contentDesc?: string,\n  interactionKind?: string,\n};\n\nexport default (p: P) => (\n  <Popover\n    hoverCloseDelay={56}\n    hoverOpenDelay={50}\n    interactionKind={p.interactionKind || PopoverInteractionKind.HOVER}\n    popoverClassName=\"bp3-popover-content-sizing\"\n    className=\"bp3-dark\"\n    transitionDuration={48}>\n    {p.anchor}\n    <div className=\"bp3-dark attr-help-content ignore-react-onclickoutside\">\n      {p.contentDesc && <div className=\"attr-pop-content-header\">{p.contentDesc}</div>}\n      <div>{p.content}</div>\n    </div>\n  </Popover>\n);\n","// @flow\nimport React, { Component } from 'react';\nimport { get, throttle } from 'lodash';\nimport { DraggableCore } from 'react-draggable';\nimport type { AnyNode, Changeable, Displayable } from 'models/NodeBase';\nimport JsonTree from 'vendor/JsonTree/js';\nimport InfoPopup from 'components/AttributePane/InfoPopup';\nimport { Hotkey, Hotkeys, HotkeysTarget, PopoverInteractionKind } from '@blueprintjs/core';\nimport NodeBase from 'models/NodeBase';\n\nconst Types = window.Types;\n\ntype P = { node: AnyNode };\ntype S = { fullDocs: boolean, width: number };\n\nclass AttributePane extends Component<P, S> {\n  state = { fullDocs: true, width: 380 };\n  listener: ?string;\n\n  // noinspection JSUnusedGlobalSymbols\n  renderHotkeys() {\n    return (\n      <Hotkeys>\n        <Hotkey\n          global={Boolean(this.props.node)}\n          group=\"Detail Pane\"\n          combo=\"meta + j\"\n          label=\"Toggle Docs\"\n          onKeyDown={this._toggleDocs}\n        />\n      </Hotkeys>\n    );\n  }\n\n  componentDidMount() {\n    this.props.node && this._setListener(this.props.node);\n  }\n\n  componentDidUpdate(oldProps: P) {\n    if (get(this, 'props.node.id') !== get(oldProps, 'node.id')) {\n      if (oldProps && oldProps.node) {\n        const listener = this.listener;\n        listener && oldProps.node.removeListener(listener);\n        this.listener = null;\n      }\n      this.props.node && this._setListener(this.props.node);\n    }\n  }\n\n  _setListener = (node: AnyNode) => {\n    this.listener = node.registerListener(this._updateListener);\n  };\n\n  // No one needs to see that many updates\n  _updateListener = throttle(() => this.forceUpdate(), 60);\n\n  componentWillUnmount() {\n    const {\n      props: { node },\n      listener,\n    } = this;\n    listener && node.removeListener(listener);\n  }\n\n  _helpInfo = (c: Changeable) => {\n    if (!c.type.hasHelpInfo() || this.state.fullDocs) {\n      return null;\n    }\n    return (\n      <InfoPopup\n        anchor={<i className=\"fa fa-eye attr-indicator attr-help\" />}\n        content={c.type.description}\n        contentDesc=\"DESCRIPTION\"\n        interactionKind={PopoverInteractionKind.CLICK}\n      />\n    );\n  };\n\n  _docInfo = (c: Changeable) => {\n    if (!this.state.fullDocs) {\n      return null;\n    }\n    return <div className=\"attr-doc\">{c.type.description}</div>;\n  };\n\n  _changeables = () => {\n    const changeables = this.props.node.changeables();\n    // $FlowIssue\n    return Object.keys(changeables).map((k, j: number) => {\n      const list = (changeables[k]: Changeable[]).map((c: Changeable, i) => (\n        <div key={`changeable-${i}-${k}`}>\n          <div className=\"attr-title\">\n            {c.title}\n            {this._helpInfo(c)}\n            <span style={styles.spacer} />\n            <InfoPopup\n              anchor={<span className=\"attr-type-indicator attr-help\">{c.type.name}</span>}\n              content={c.type.typeDescription}\n              contentDesc=\"TYPE\"\n            />\n          </div>\n          {this._docInfo(c)}\n          <div className={`attr-value-row${i === changeables[k].length - 1 ? ' attr-last' : ''}`}>\n            <MultiTypeEditor item={c} editOnHotkey={i === 0 && j === 0} />\n          </div>\n        </div>\n      ));\n      return (\n        <div key={k}>\n          <div className=\"changeable-section-title\">{k}:</div>\n          <div>{list}</div>\n        </div>\n      );\n    });\n  };\n\n  truncate = (string: string, len: number = 100) => {\n    if (string.length > len) return string.substring(0, len) + '...';\n    else return string;\n  };\n\n  _description = () => {\n    const { node } = this.props;\n    const { fullDocs } = this.state;\n    if (!node.constructor.description) {\n      return null;\n    }\n    const desc = node.constructor.description;\n    // $FlowIssue\n    const t = fullDocs ? desc : this.truncate(desc);\n    return <div className={`node-description`}>{t}</div>;\n  };\n\n  _signature = () => {\n    return this.props.node.signature(0, {\n      fontSize: 10,\n      padding: '0 16px 12px',\n      color: 'rgba(250, 250, 250, 0.8)',\n    });\n  };\n\n  _toggleDocs = () => this.setState({ fullDocs: !this.state.fullDocs });\n\n  _onResize = (e: MouseEvent) => this.setState({ width: window.innerWidth - e.clientX });\n\n  render() {\n    if (!this.props.node) {\n      return <div />;\n    }\n    const { fullDocs, width } = this.state;\n    return (\n      <div className=\"attribute-pane ignore-react-onclickoutside\" style={{ width }}>\n        <h3 className=\"pane-header\">\n          {this.props.node.title || NodeBase.nameFrom(this.props.node.constructor)}\n        </h3>\n        {this._signature()}\n        {this._description()}\n        <div className=\"attr-doc-toggle\" onClick={this._toggleDocs}>\n          {fullDocs ? 'Collapse' : 'Expand'} Docs\n        </div>\n        <hr />\n        <div className=\"attr-list\">{this._changeables()}</div>\n        <DraggableCore onDrag={this._onResize}>\n          <div id=\"attr-pane-resizer\" />\n        </DraggableCore>\n      </div>\n    );\n  }\n}\n\ntype MP = {\n  item: Displayable,\n  disabled?: boolean,\n  editOnHotkey?: boolean,\n};\n\nclass MultiTypeEditor extends Component<MP> {\n  static defaultProps = { disabled: false, editOnHotkey: false };\n\n  _isComplex = (): boolean => {\n    if (this.props.item.type.isA(Types.any)) {\n      // Best guess when we can't know\n      return typeof this.props.item.value === 'object';\n    }\n    return this.props.item.type.isComplex();\n  };\n\n  _onEdit = (e: { updated_src: Object }) => {\n    const onChange = get(this.props, 'item.onChange');\n    if (onChange) {\n      onChange(this._isComplex() ? e.updated_src : e.updated_src.value);\n    }\n  };\n\n  _getEdit = () => {\n    if (get(this.props, 'item.onChange')) {\n      return this._onEdit;\n    }\n    return undefined;\n  };\n\n  render() {\n    const { value, type } = this.props.item;\n    const complex = this._isComplex();\n    const val = complex ? value : { value };\n    return (\n      <JsonTree\n        src={val}\n        attrType={type}\n        isPrimitive={!complex}\n        name={null}\n        indentWidth={2}\n        collapsed={1}\n        onEdit={this._getEdit()}\n        enableClipboard={false}\n        displayObjectSize={false}\n        collapseStringsAfterLength={20}\n        displayDataTypes={false}\n        rejectMatching={/^_/}\n        editOnHotkey={this.props.editOnHotkey}\n      />\n    );\n  }\n}\n\nconst styles = { spacer: { flex: 1 } };\n\nexport default HotkeysTarget(AttributePane);\n","// @flow\nimport React from 'react';\nimport type { Node } from 'react';\nimport FuzzySearch from 'fuzzy-search';\nimport { Omnibar, ItemRenderer, type IOmnibarProps } from '@blueprintjs/select';\nimport { Menu, MenuItem } from '@blueprintjs/core';\nimport type { AnyNode } from 'models/NodeBase';\nimport { signatureFor } from 'components/util';\n\nconst allNodes = window.allNodes;\ntype T = Class<AnyNode>;\n\nconst titleMaxLen = 20;\nconst sigMaxLen = 12;\n\nconst renderItem: ItemRenderer<T> = (node, { handleClick, modifiers, query }) => {\n  return (\n    <MenuItem\n      className=\"bp3-dark\"\n      active={modifiers.active}\n      disabled={modifiers.disabled}\n      label={signatureFor(node, sigMaxLen)}\n      key={node.displayName}\n      onClick={handleClick}\n      text={node.displayName.substring(0, titleMaxLen)}\n    />\n  );\n};\n\nconst noResults = <MenuItem disabled={true} text=\"No matching nodes\" />;\nconst itemListRenderer = (o: {\n  activeItem: T | null,\n  filteredItems: T[],\n  items: T[],\n  query: string,\n  itemsParentRef: (ref: HTMLElement | null) => void,\n  renderItem: (item: T, index: number) => Node,\n}): Node => {\n  const items = o.filteredItems.map(o.renderItem).filter(item => item != null);\n  const content = items.length > 0 ? items : noResults;\n  return <Menu ulRef={o.itemsParentRef}>{content}</Menu>;\n};\n\nconst searcher = new FuzzySearch(allNodes, ['displayName', 'description']);\nconst itemsPredicate = q => (Boolean(q) ? searcher.search(q) : allNodes).slice(0, 12);\n\nexport default (p: IOmnibarProps<T>) => (\n  <Omnibar\n    {...p}\n    items={allNodes}\n    className=\"bp3-dark\"\n    itemListPredicate={itemsPredicate}\n    resetOnSelect={true}\n    itemListRenderer={itemListRenderer}\n    itemRenderer={renderItem}\n    noResults={noResults}\n  />\n);\n","// @flow\n\nimport React, { Component } from 'react';\nimport { get } from 'lodash';\ntype P = { onFile: File => void };\n\nclass FileUpload extends Component<P> {\n  fileInput: ?HTMLElement;\n\n  openFileInput = () => {\n    this.fileInput && this.fileInput.click();\n  };\n\n  _onFile = (event: SyntheticInputEvent<*>) => {\n    const file = get(event, ['target', 'files', 0]);\n    if (file) {\n      this.props.onFile(file);\n    }\n  };\n\n  render() {\n    return (\n      <input\n        onChange={this._onFile}\n        style={{ display: 'none' }}\n        ref={input => (this.fileInput = input)}\n        type=\"file\"\n      />\n    );\n  }\n}\n\nexport default FileUpload;\n","// @flow\n\nimport React from 'react';\nimport { get } from 'lodash';\nimport { Dialog, Classes, Intent, Button, Label } from '@blueprintjs/core';\n\ntype P = { isOpen: boolean, handleClose: () => void, saveFile: string => void, initial: ?string };\ntype S = { name: string };\n\nexport default class SaveDialog extends React.Component<P, S> {\n  constructor(props: P) {\n    super(props);\n    this.state = { name: props.initial || '' };\n  }\n\n  _onChange = (e: SyntheticInputEvent<*>) => {\n    this.setState({ name: e.target.value });\n  };\n\n  _onInputKeyUp = (e: SyntheticInputEvent<*>) => {\n    if (get(e, 'key') === 'Enter') {\n      this._onSave();\n    }\n  };\n\n  _onSave = () => {\n    this.props.saveFile(this.state.name);\n  };\n\n  render() {\n    const { handleClose, isOpen } = this.props;\n    const { name } = this.state;\n    return (\n      <Dialog\n        className=\"bp3-dark\"\n        icon=\"save\"\n        onClose={handleClose}\n        title=\"Export Graph\"\n        isOpen={isOpen}>\n        <div className={Classes.DIALOG_BODY}>\n          <p>Save a serialized version of this graph</p>\n          <Label>\n            Save As...\n            <input\n              onKeyUp={this._onInputKeyUp}\n              autoFocus\n              className={Classes.INPUT}\n              type=\"text\"\n              placeholder=\"project1\"\n              dir=\"auto\"\n              onChange={this._onChange}\n              value={name}\n            />\n          </Label>\n        </div>\n        <div className={Classes.DIALOG_FOOTER}>\n          <div className={Classes.DIALOG_FOOTER_ACTIONS}>\n            <Button onClick={handleClose}>Cancel</Button>\n            <Button intent={Intent.PRIMARY} onClick={this._onSave}>\n              Download\n            </Button>\n          </div>\n        </div>\n      </Dialog>\n    );\n  }\n}\n","// @flow\nimport React from 'react';\nimport type { Node } from 'react';\nimport { get } from 'lodash';\nimport FuzzySearch from 'fuzzy-search';\nimport { Omnibar, ItemRenderer, type IOmnibarProps } from '@blueprintjs/select';\nimport Graph from 'models/Graph';\nimport { Menu, MenuItem } from '@blueprintjs/core';\n\nimport type { AnyNode } from 'models/NodeBase';\n\ntype T = AnyNode;\n\nconst titleMaxLen = 20;\n\nconst renderItem: ItemRenderer<T> = (node, { handleClick, modifiers, query }) => {\n  return (\n    <MenuItem\n      className=\"bp3-dark\"\n      active={modifiers.active}\n      disabled={modifiers.disabled}\n      key={node.id}\n      onClick={handleClick}\n      text={String(node.name()).substring(0, titleMaxLen)}\n    />\n  );\n};\n\nconst noResults = <MenuItem disabled={true} text=\"No matching node in graph\" />;\n\nconst itemListRenderer = (o: {\n  activeItem: T | null,\n  filteredItems: T[],\n  items: T[],\n  query: string,\n  itemsParentRef: (ref: HTMLElement | null) => void,\n  renderItem: (item: T, index: number) => Node,\n}): Node => {\n  const items = o.filteredItems.map(o.renderItem).filter(item => item != null);\n  const content = items.length > 0 ? items : noResults;\n  return <Menu ulRef={o.itemsParentRef}>{content}</Menu>;\n};\n\nconst itemsPredicate = (q, searcher, all) => (Boolean(q) ? searcher.search(q) : all).slice(0, 12);\n\ntype P = {\n  graph: Graph,\n};\nexport default (p: IOmnibarProps<T> & P) => {\n  const nodes = get(p.graph, 'nodes', []).map(n => n.node);\n  const searcher = new FuzzySearch(nodes.map(n => ({ ...n, _name: n.name() })), [\n    '_name',\n    'constructor.displayName',\n  ]);\n  return (\n    <Omnibar\n      {...p}\n      items={nodes}\n      className=\"bp3-dark\"\n      itemListPredicate={q => itemsPredicate(q, searcher, nodes)}\n      resetOnSelect={true}\n      itemListRenderer={itemListRenderer}\n      itemRenderer={renderItem}\n      noResults={<MenuItem disabled={true} text=\"No matching nodes\" />}\n    />\n  );\n};\n","// @flow\nimport React from 'react';\nimport type { Node } from 'react';\nimport FuzzySearch from 'fuzzy-search';\nimport { Omnibar, ItemRenderer, type IOmnibarProps } from '@blueprintjs/select';\nimport { Menu, MenuItem } from '@blueprintjs/core';\nimport type { GraphSerialization } from 'models/Graph';\n\ntype T = GraphSerialization;\n\nexport const examples = [\n  require('models/examples/nude, eternally.json'),\n  require('models/examples/in the gardens of eden.json'),\n  require('models/examples/platonic plague.json'),\n  require('models/examples/the music while the music lasts.json'),\n  require('models/examples/stephen wolfram.json'),\n  require('models/examples/shaders.json'),\n  require('models/examples/wolfram gpu.json'),\n  require('models/examples/percept nets.json'),\n  require('models/examples/soundfont-midi.json'),\n  require('models/examples/soundfont-tone.json'),\n  require('models/examples/gpgpu.json'),\n  require('models/examples/midi-in.json'),\n];\n\nconst titleMaxLen = 40;\n\nconst renderItem: ItemRenderer<T> = (node, { handleClick, modifiers }) => {\n  return (\n    <MenuItem\n      className=\"bp3-dark\"\n      active={modifiers.active}\n      disabled={modifiers.disabled}\n      label={`${node.nodes.length} nodes`}\n      key={node.name || 'untitled'}\n      onClick={handleClick}\n      text={(node.name || 'untitled').substring(0, titleMaxLen)}\n    />\n  );\n};\n\nconst noResults = <MenuItem disabled={true} text=\"No matching examples\" />;\n\nconst itemListRenderer = (o: {\n  activeItem: T | null,\n  filteredItems: T[],\n  items: T[],\n  query: string,\n  itemsParentRef: (ref: HTMLElement | null) => void,\n  renderItem: (item: T, index: number) => Node,\n}): Node => {\n  const items = o.filteredItems.map(o.renderItem).filter(item => item != null);\n  const content = items.length > 0 ? items : noResults;\n  return <Menu ulRef={o.itemsParentRef}>{content}</Menu>;\n};\n\nconst searcher = new FuzzySearch(examples, ['name']);\nconst itemsPredicate = q => (Boolean(q) ? searcher.search(q) : examples).slice(0, 12);\n\nexport default (p: IOmnibarProps<T>) => (\n  <Omnibar\n    {...p}\n    items={examples}\n    className=\"bp3-dark\"\n    itemListPredicate={itemsPredicate}\n    resetOnSelect={true}\n    itemListRenderer={itemListRenderer}\n    itemRenderer={renderItem}\n    noResults={noResults}\n    inputProps={{ placeholder: 'Examples...' }}\n  />\n);\n","/* eslint-disable */\nimport ReactDOM from 'react-dom';\nimport { allNodes } from 'models/nodes';\n\nconst renderAttr = ([title, type]) => {\n  const def = type.defaultValue && JSON.stringify(type.defaultValue);\n  return `\\`${title}\\`: \\`${type.name}\\` _${type.type}_${def ? ` default: \\`${def}\\`` : ''}\\n\\n${\n    type.description\n  }`;\n};\n\nconst docs = () =>\n  allNodes.map(n => {\n    let desc = '';\n    if (n.description) {\n      const r = ReactDOM.render(n.description, document.createElement('div'));\n      desc = r.textContent;\n    }\n    return `\n## ${n.displayName}\n\n${desc}\n  \n\n##### inputs (${Object.keys(n.schema.input).length})\n\n${Object.entries(n.schema.input)\n  .map(renderAttr)\n  .join('\\n\\n')}\n  \n##### outputs (${Object.keys(n.schema.output).length})\n\n${Object.entries(n.schema.output)\n  .map(renderAttr)\n  .join('\\n\\n')}\n  \n`;\n  });\n\nexport function download(str, exportName = 'docs') {\n  const dataStr = 'data:text;charset=utf-8,' + encodeURIComponent(str);\n  const anchor = document.createElement('a');\n  anchor.setAttribute('href', dataStr);\n  anchor.setAttribute('download', exportName + '.md');\n  // $FlowIssue\n  document.body.appendChild(anchor);\n  anchor.click();\n  anchor.remove();\n}\n\nconst md = () => {\n  const nodes = docs();\n  return `\n# Node Docs\n\nHere's a list of all ${nodes.length} current nodes, their descriptions, and i/o.\n\n${nodes.join('\\n\\n')}    \n`;\n};\n// const output = md();\n// download(output);\n// console.log(output);\n","// @flow\n\nimport React from 'react';\nimport { createSelector } from 'redux-starter-kit';\nimport { AnchorButton, Tooltip } from '@blueprintjs/core';\nimport { connect } from 'react-redux';\nimport { selectInfoOpen } from 'redux/ducks/graph';\n\ntype P = {\n  loadExample: () => any,\n  insertNode: () => any,\n  toggleVis: () => any,\n  graphVisible: boolean,\n  toggleDebug: () => any,\n  exportJSON: () => any,\n  loadJSON: () => any,\n  title: string,\n  toggleInfo: () => any,\n  infoShowing: boolean,\n};\nconst Toolbar = ({\n  loadExample,\n  insertNode,\n  toggleVis,\n  graphVisible,\n  toggleDebug,\n  exportJSON,\n  loadJSON,\n  title,\n  toggleInfo,\n  infoShowing,\n}: P) => {\n  return (\n    <div className=\"graph-toolbar ignore-react-onclickoutside\">\n      <div style={{ ...styles.toolSection, ...styles.leftAlign }}>\n        <Tooltip content=\"load an example\">\n          <AnchorButton minimal icon=\"folder-shared-open\" large onClick={loadExample} />\n        </Tooltip>\n        <Tooltip content=\"insert a new node\">\n          <AnchorButton minimal icon=\"new-link\" large onClick={insertNode} />\n        </Tooltip>\n        <Tooltip content={`${graphVisible ? 'hide' : 'show'} graph`}>\n          <AnchorButton\n            minimal\n            icon={graphVisible ? 'eye-open' : 'eye-off'}\n            large\n            onClick={toggleVis}\n          />\n        </Tooltip>\n        <Tooltip content=\"toggle debug mode\">\n          <AnchorButton minimal icon=\"build\" large onClick={toggleDebug} />\n        </Tooltip>\n        <Tooltip content=\"export graph as JSON\">\n          <AnchorButton minimal icon=\"download\" large onClick={exportJSON} />\n        </Tooltip>\n        <Tooltip content=\"open JSON file\">\n          <AnchorButton minimal icon=\"upload\" large onClick={loadJSON} />\n        </Tooltip>\n        <Tooltip content=\"node list API docs\">\n          <AnchorButton\n            minimal\n            icon=\"panel-stats\"\n            large\n            href=\"https://github.com/kousun12/eternal/blob/master/docs.md\"\n            target=\"_blank\"\n          />\n        </Tooltip>\n      </div>\n      <h2 className=\"graph-title\">{title}</h2>\n      <div style={{ ...styles.toolSection, ...styles.rightAlign }}>\n        <Tooltip content=\"open github repo\">\n          <AnchorButton\n            minimal\n            icon=\"git-repo\"\n            large\n            href=\"https://github.com/kousun12/eternal\"\n            target=\"_blank\"\n          />\n        </Tooltip>\n        <Tooltip content=\"show keyboard shortcuts\">\n          <AnchorButton minimal icon=\"key-command\" large onClick={_showHotKeys} />\n        </Tooltip>\n        <Tooltip content={`${infoShowing ? 'hide' : 'show'} info pane`}>\n          <AnchorButton\n            minimal\n            icon={`chevron-${infoShowing ? 'right' : 'left'}`}\n            large\n            onClick={toggleInfo}\n          />\n        </Tooltip>\n      </div>\n    </div>\n  );\n};\n\nconst selector = createSelector(\n  [selectInfoOpen],\n  i => ({ infoShowing: Boolean(i) })\n);\n\nexport default connect(selector)(Toolbar);\n\nconst _showHotKeys = () => {\n  document.dispatchEvent(\n    new KeyboardEvent('keydown', { which: 47, keyCode: 47, shiftKey: true, bubbles: true })\n  );\n};\n\nconst styles = {\n  toolSection: { flex: 1, display: 'flex', alignItems: 'center' },\n  leftAlign: { justifyContent: 'flex-start' },\n  rightAlign: { justifyContent: 'flex-end' },\n};\n","// @flow\n\nimport React from 'react';\nimport { Button, Classes, Dialog } from '@blueprintjs/core';\n\ntype P = { title: string, onClose: () => void, load: () => void };\nconst btnTxt = '👾 ok computer';\nexport default ({ title, onClose, load }: P) => (\n  <Dialog\n    canOutsideClickClose={false}\n    isOpen={Boolean(title)}\n    className=\"bp3-dark\"\n    title=\"Load...\"\n    onClose={onClose}\n  >\n    <div className={Classes.DIALOG_FOOTER}>\n      <div className={Classes.DIALOG_BODY}>\n        <p>you are about to load the example</p>\n        <p>~{title}~</p>\n      </div>\n      <div className={Classes.DIALOG_FOOTER_ACTIONS}>\n        <Button onClick={load}>{btnTxt}</Button>\n      </div>\n    </div>\n  </Dialog>\n);\n","// @flow\nimport React from 'react';\nimport { zooms, setScale as _setScale } from 'redux/ducks/graph';\nimport { connect } from 'react-redux';\nimport { Slider } from '@blueprintjs/core';\n\ntype P = {| zoom: number, setScale: number => void |};\n\nconst Zoomer = ({ zoom, setScale }: P) => {\n  return (\n    <div className=\"zoomer\">\n      <Slider\n        className=\"bp3-dark\"\n        min={0}\n        max={zooms.length - 1}\n        stepSize={1}\n        labelStepSize={10}\n        onChange={setScale}\n        value={zoom}\n        labelRenderer={v => `${zooms[v] / 100}x`}\n        showTrackFill={false}\n      />\n    </div>\n  );\n};\n\nexport default connect(\n  s => ({ zoom: s.graph.view.zoom }),\n  d => ({ setScale: s => d(_setScale(s)) })\n)(Zoomer);\n","// @flow\n\nimport './boot';\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { createSelector } from 'redux-starter-kit';\nimport { get, throttle } from 'lodash';\nimport { Hotkey, Hotkeys, HotkeysTarget, setHotkeysDialogProps } from '@blueprintjs/core';\n\nimport 'font-awesome/css/font-awesome.css';\nimport 'font-awesome/scss/font-awesome.scss';\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport '@blueprintjs/select/lib/css/blueprint-select.css';\nimport '@blueprintjs/icons/lib/css/blueprint-icons.css';\n\nimport NodeGraph from 'components/NodeGraph';\nimport AttributePane from 'components/AttributePane';\nimport Searcher from 'components/SearchBar';\nimport type { GraphSerialization } from 'models/Graph';\nimport Graph from 'models/Graph';\nimport type { AnyNode } from 'models/NodeBase';\nimport { downloadObj } from 'helpers';\nimport FileUpload from 'components/FileUpload';\nimport SaveDialog from 'components/SaveDialog';\nimport NodeSearcher from 'components/NodeSearcher';\nimport ExampleSearch, { examples } from 'components/ExampleSearch';\nimport './docgen';\n\nimport 'eternal.scss';\nimport type { Pos } from 'types';\nimport Toolbar from 'components/Toolbar';\nimport LoadPrompt from 'components/dialogs/LoadPrompt';\nimport {\n  setInfoOpen as _setInfoOpen,\n  selectInfoOpen,\n  updatePos as _updatePos,\n  selectView,\n  setScale as _setScale,\n} from 'redux/ducks/graph';\nimport Zoomer from 'components/Zoomer';\nimport type { PosMemo, SelectedView } from 'redux/ducks/graph';\nimport { subVec } from 'utils/vector';\n\nconst welcomeGraph = require('models/examples/welcome.json');\n\ntype P = {\n  setInfoOpen: (?string) => void,\n  showNode: ?string,\n  updatePos: PosMemo => void,\n  view: SelectedView,\n  setScale: number => void,\n};\ntype S = {\n  graph: ?Graph,\n  searchOpen: boolean,\n  saveOpen: boolean,\n  searchingNodes: boolean,\n  searchingExamples: boolean,\n  visible: boolean,\n  promptLoad: ?string,\n};\n\nconst defaultNodePos = { x: 70, y: 120 };\n\nclass App extends Component<P, S> {\n  nodeIndex: number = 0;\n  mostRecentNode: ?AnyNode = null;\n  fileUpload: ?FileUpload;\n  _mousePos: Pos = defaultNodePos;\n  _insertPos: ?Pos = null;\n  state = {\n    searchOpen: false,\n    saveOpen: false,\n    graph: null,\n    searchingNodes: false,\n    visible: true,\n    searchingExamples: false,\n    promptLoad: null,\n  };\n\n  componentDidMount() {\n    let showWelcome = true;\n    const exId = get(window.location.search.match(/[?&]e=([\\w-\\d% +]+)&?/), 1);\n    if (exId) {\n      const name = decodeURIComponent(exId).replace(/\\+/g, ' ');\n      const exFromUrl = examples.find(e => e.name === name);\n      if (exFromUrl) {\n        showWelcome = false;\n        if (process.env.NODE_ENV === 'development') {\n          this._loadUrl(exFromUrl);\n        } else {\n          this.setState({ promptLoad: name });\n        }\n      }\n    }\n    showWelcome && this._setGraph(Graph.load(welcomeGraph));\n\n    const hide = get(window.location.search.match(/[?&]h=(\\d)&?/), 1);\n    typeof hide === 'string' && this.setState({ visible: hide === '0' });\n\n    const debug = get(window.location.search.match(/[?&]d=(\\d)&?/), 1);\n    typeof debug === 'string' && debug === '1' && this._toggleDebug();\n\n    document.addEventListener('mousemove', this._onMouseMove);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousemove', this._onMouseMove);\n  }\n\n  _onMouseMove = throttle((me: MouseEvent) => {\n    this._mousePos = { x: me.clientX, y: me.clientY };\n  }, 30);\n\n  _setGraph = (graph: Graph) => {\n    this.state.graph && this.state.graph.dispose();\n    window['$node'] = null;\n    this.setState({ graph: null }, () => {\n      this.mostRecentNode = get(graph.nodes, [0, 'node']);\n      const readme = graph.nodes.find(nis => nis.node.title === 'README');\n      this._setInfoOpen(readme ? readme.node.id : null);\n      if (typeof graph.meta.zoom === 'number') {\n        this.props.setScale(graph.meta.zoom);\n      }\n      this.setState({ graph }, () => (window['$graph'] = graph));\n    });\n  };\n\n  _setInfoOpen = (id: ?string) => this.props.showNode !== id && this.props.setInfoOpen(id);\n  _onSearch = () => !this.state.searchOpen && this.setState({ searchOpen: true });\n\n  _searchExamples = () =>\n    !this.state.searchingExamples && this.setState({ searchingExamples: true });\n\n  _exportJSON = (name: string) => {\n    const { graph } = this.state;\n    const {\n      view: { zoom },\n    } = this.props;\n    graph && downloadObj(graph.serialize(name, { zoom }), name);\n    this._closeSave();\n  };\n\n  _loadJSON = () => this.fileUpload && this.fileUpload.openFileInput();\n\n  _onFileUpload = (file: File) => Graph.fromFile(file, this._loadGraph);\n\n  _loadGraph = (json: GraphSerialization) => {\n    const exId = get(window.location.search.match(/[?&]e=([\\w-\\d% +]+)&?/), 1);\n    if (exId) {\n      this._reload();\n    } else {\n      this._setGraph(Graph.load(json));\n    }\n  };\n\n  _loadExample = (json: GraphSerialization) => {\n    window.location.search = `?e=${encodeURIComponent((json.name || '').replace(/ /g, '+'))}`;\n  };\n\n  _toggleDebug = () => {\n    window['$debug'] = !window['$debug'];\n    this.setState({ visible: false }, () => this.setState({ visible: true }));\n  };\n\n  _addNode = (cls: Class<AnyNode>) => {\n    const { graph } = this.state;\n    this.setState({ searchOpen: false });\n    if (graph) {\n      const node = new cls();\n      const pos = this._insertPos || subVec(this._mousePos, { x: 30, y: 30 });\n      graph.addNode(node, pos);\n      // only show node info if pane is already open\n      if (this.props.showNode) {\n        this._onNodeSelect(node);\n      }\n      this.props.updatePos({ [node.id]: pos });\n    }\n    this._insertPos = null;\n  };\n\n  _onNodeSelect = (node: ?AnyNode, idx?: number) => {\n    this._setInfoOpen(get(node, 'id', null));\n    const _node = node;\n    if (_node) {\n      this.mostRecentNode = _node;\n      if (typeof idx === 'number') {\n        this.nodeIndex = idx;\n      }\n      window['$node'] = node;\n    }\n    this.state.searchingNodes && this._closeSearch();\n  };\n\n  _closeSearch = () =>\n    this.setState({ searchOpen: false, searchingNodes: false, searchingExamples: false });\n  _closeSave = () => this.setState({ saveOpen: false });\n  _showSave = () => this.setState({ saveOpen: true });\n  _showNodeSearch = () => this.setState({ searchingNodes: true });\n  _toggleGraph = () => this.setState({ visible: !this.state.visible });\n\n  _loadUrl = (example?: GraphSerialization) => {\n    const { promptLoad } = this.state;\n    const exJson = Graph.serialization(example);\n    if (promptLoad || exJson) {\n      const json = exJson || examples.find(e => e.name === promptLoad);\n      json && this._setGraph(Graph.load(json));\n    }\n    this.setState({ promptLoad: null });\n  };\n\n  _nextNode = () => {\n    if (!this.props.showNode) return;\n    const nodes = get(this.state.graph, 'nodes', []);\n    if (nodes.length < 2) return;\n    this.nodeIndex = (this.nodeIndex + 1) % nodes.length;\n    this._onNodeSelect(nodes[this.nodeIndex].node);\n  };\n\n  _prevNode = () => {\n    if (!this.props.showNode) return;\n    const nodes = get(this.state.graph, 'nodes', []);\n    if (nodes.length < 2) return;\n    this.nodeIndex = (((this.nodeIndex - 1) % nodes.length) + nodes.length) % nodes.length;\n    this._onNodeSelect(nodes[this.nodeIndex].node);\n  };\n\n  _toggleInfo = () =>\n    this.props.setInfoOpen(this.props.showNode ? null : get(this.mostRecentNode, 'id'));\n\n  _reload = () => window.location.replace('/');\n\n  _closePrompt = () => {\n    this.setState({ promptLoad: null });\n    this._reload();\n  };\n\n  render() {\n    const {\n      graph,\n      searchOpen,\n      saveOpen,\n      searchingNodes,\n      visible,\n      searchingExamples,\n      promptLoad,\n    } = this.state;\n    const { showNode } = this.props;\n    const title = get(graph, 'name', '');\n    const inPane = showNode && graph ? get(graph.nodeWithId(showNode), 'node', null) : null;\n    return (\n      <>\n        <Toolbar\n          loadExample={this._searchExamples}\n          insertNode={this._manualInsert}\n          toggleVis={this._toggleGraph}\n          graphVisible={visible}\n          toggleDebug={this._toggleDebug}\n          exportJSON={this._showSave}\n          loadJSON={this._loadJSON}\n          title={title}\n          toggleInfo={this._toggleInfo}\n        />\n        {graph && (\n          <NodeGraph visible={visible} graph={graph} onNodeSelectionChange={this._onNodeSelect} />\n        )}\n        <AttributePane node={visible ? inPane : null} />\n        {visible && <Zoomer />}\n        {saveOpen && (\n          <SaveDialog\n            initial={title}\n            isOpen={saveOpen}\n            handleClose={this._closeSave}\n            saveFile={this._exportJSON}\n          />\n        )}\n        <Searcher isOpen={searchOpen} onItemSelect={this._addNode} onClose={this._closeSearch} />\n        {graph && (\n          <NodeSearcher\n            isOpen={searchingNodes}\n            onItemSelect={this._onNodeSelect}\n            onClose={this._closeSearch}\n            graph={graph}\n          />\n        )}\n        <ExampleSearch\n          isOpen={searchingExamples}\n          onItemSelect={this._loadExample}\n          onClose={this._closeSearch}\n        />\n        {promptLoad && (\n          <LoadPrompt onClose={this._closePrompt} title={promptLoad} load={this._loadUrl} />\n        )}\n        <FileUpload onFile={this._onFileUpload} ref={r => (this.fileUpload = r)} />\n      </>\n    );\n  }\n\n  _manualInsert = () => {\n    this._onSearch();\n    this._insertPos = defaultNodePos;\n  };\n\n  // noinspection JSUnusedGlobalSymbols\n  renderHotkeys() {\n    // NB for some reason moving this to a component doesn't work\n    return this.state.promptLoad ? (\n      <Hotkeys>\n        <Hotkey global combo=\"enter\" label=\"Load Example\" onKeyDown={this._loadUrl} />\n      </Hotkeys>\n    ) : (\n      <Hotkeys>\n        <Hotkey\n          global\n          combo=\"alt + e\"\n          label=\"Load an Example...\"\n          onKeyDown={this._searchExamples}\n        />\n        <Hotkey global combo=\"meta + k\" label=\"Add Node\" onKeyDown={this._onSearch} />\n        <Hotkey global combo=\"esc\" label=\"Info Pane (show / hide)\" onKeyDown={this._toggleInfo} />\n        <Hotkey\n          global\n          combo=\"shift + meta + v\"\n          label=\"Graph (show / hide)\"\n          onKeyDown={this._toggleGraph}\n        />\n        <Hotkey\n          global\n          combo=\"shift + meta + f\"\n          label=\"Search existing nodes\"\n          onKeyDown={this._showNodeSearch}\n        />\n        <Hotkey global combo=\"shift + meta + s\" label=\"Export as JSON\" onKeyDown={this._showSave} />\n        <Hotkey global combo=\"shift + meta + o\" label=\"Load from JSON\" onKeyDown={this._loadJSON} />\n        <Hotkey global combo=\"shift + meta + x\" label=\"Clear All\" onKeyDown={this._reload} />\n        <Hotkey global combo=\"alt + d\" label=\"Debug Mode\" onKeyDown={this._toggleDebug} />\n        <Hotkey global combo=\"j\" label=\"Next Node\" onKeyDown={this._nextNode} />\n        <Hotkey global combo=\"k\" label=\"Prev Node\" onKeyDown={this._prevNode} />\n      </Hotkeys>\n    );\n  }\n}\n\nsetHotkeysDialogProps({ className: 'bp3-dark', globalHotkeysGroup: 'Menu' });\nconst AppWithHK = HotkeysTarget(App);\nconst select = createSelector(\n  [selectInfoOpen, selectView],\n  (showNode, view) => ({ showNode, view })\n);\nexport default connect(\n  select,\n  d => ({\n    setInfoOpen: n => d(_setInfoOpen(n)),\n    updatePos: (pos: PosMemo) => d(_updatePos(pos)),\n    setScale: s => d(_setScale(s)),\n  })\n)(AppWithHK);\n","// @flow\n\nimport { combineReducers, createSlice, type PayloadAction as PA } from 'redux-starter-kit';\nimport { fromPairs } from 'lodash';\nimport type { State } from 'redux/types';\nimport { range } from 'utils/array';\nimport type { Pos } from 'types';\n\ntype ViewState = {| zoom: number, pan: Pos |};\nexport type PosMemo = { [string]: Pos };\nexport type GraphState = {|\n  selected: string[],\n  infoOpen: ?string,\n  view: ViewState,\n  nodePos: PosMemo,\n|};\n\nconst selectedSlice = createSlice({\n  slice: 'selected',\n  initialState: [],\n  reducers: { selSet: (selected: string[], a: PA<string[]>) => a.payload },\n});\n\nconst infoOpenSlice = createSlice({\n  slice: 'infoOpen',\n  initialState: null,\n  reducers: { setInfoOpen: (infoOpen: ?string, a: PA<?string>) => a.payload },\n});\n\nexport const zooms = range([20, 205], 5, 0);\nconst defView = { pan: { x: 0, y: 0 }, zoom: zooms.indexOf(100) };\n\n// NB using immer to update state, which looks like mutation but is actually not\nconst viewSlice = createSlice({\n  slice: 'view',\n  initialState: defView,\n  reducers: {\n    setScale: (v: ViewState, a: PA<number>) => {\n      v.zoom = a.payload;\n    },\n    zoomIn: (v: ViewState, a: PA<?Pos>) => {\n      v.zoom = Math.min(zooms.length - 1, v.zoom + 1);\n      // todo\n      // if (a.payload) {\n      // v.pan = subVec(v.pan, a.payload);\n      // }\n    },\n    zoomOut: (v: ViewState, a: PA<?Pos>) => {\n      v.zoom = Math.max(0, v.zoom - 1);\n      // todo\n      // if (a.payload) {\n      // v.pan = subVec(v.pan, a.payload);\n      // }\n    },\n    zoomReset: (v: ViewState) => {\n      v.zoom = defView.zoom;\n      v.pan = defView.pan;\n    },\n    setPan: (v: ViewState, a: PA<Pos>) => {\n      v.pan = a.payload;\n    },\n  },\n});\n\nconst nodePosSlice = createSlice({\n  slice: 'nodePos',\n  initialState: {},\n  reducers: { updatePos: (memo: PosMemo, a: PA<PosMemo>) => ({ ...memo, ...a.payload }) },\n});\n\nexport const selectedS = (s: State) => ({\n  selected: fromPairs(s.graph.selected.map(id => [id, true])),\n  selectCount: s.graph.selected.length,\n});\n\nexport type SelectedView = {| pan: Pos, scale: number, scaleInverse: number, zoom: number |};\nexport const selectView = (s: State): SelectedView => {\n  const { zoom } = s.graph.view;\n  const scale = zooms[zoom] / 100;\n  return { pan: s.graph.view.pan, scale, scaleInverse: 1 / scale, zoom };\n};\n\nexport const selectInfoOpen = (s: State) => s.graph.infoOpen;\nexport const selectPositions = (s: State) => s.graph.nodePos;\n\nexport const { selSet } = selectedSlice.actions;\nexport const { setInfoOpen } = infoOpenSlice.actions;\nexport const { zoomIn, zoomOut, zoomReset, setPan, setScale } = viewSlice.actions;\nexport const { updatePos } = nodePosSlice.actions;\n\nexport default combineReducers({\n  selected: selectedSlice.reducer,\n  infoOpen: infoOpenSlice.reducer,\n  view: viewSlice.reducer,\n  nodePos: nodePosSlice.reducer,\n});\n","// @flow\n\nexport const range = (range: [number, number], increments: number, fixed: number = 2): number[] => {\n  const r = [];\n  let cur = range[0];\n  while (cur <= range[1]) {\n    r.push(cur);\n    cur += increments;\n  }\n  return r.map(n => (fixed === 0 ? parseInt(n.toFixed(fixed), 10) : parseFloat(n.toFixed(fixed))));\n};\n","// @flow\nimport { combineReducers } from 'redux-starter-kit';\nimport graph from 'redux/ducks/graph';\n\nconst rootReducer = combineReducers({ graph });\n\nexport default rootReducer;\n","// @flow\nimport { configureStore } from 'redux-starter-kit';\n\nimport rootReducer from './rootReducer';\n\nconst store = configureStore({\n  reducer: rootReducer,\n});\n\nexport default store;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './App';\nimport { Provider } from 'react-redux';\nimport store from './redux/rootStore';\n\nimport * as serviceWorker from './serviceWorker';\nserviceWorker.unregister();\n\nconst render = () => {\n  const Eternal = require('./App').default;\n  ReactDOM.render(\n    <Provider store={store}>\n      <Eternal className=\"bp3-dark\" />\n    </Provider>,\n    document.getElementById('eternal-root')\n  );\n};\n\nrender();\n"],"sourceRoot":""}